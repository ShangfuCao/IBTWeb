{"ast":null,"code":"import _classCallCheck from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Raycaster } from 'three';\nimport { IfcMouse } from './mouse';\nimport { IfcComponent } from '../../base-types';\nexport var IfcRaycaster = /*#__PURE__*/function (_IfcComponent) {\n  _inherits(IfcRaycaster, _IfcComponent);\n\n  var _super = _createSuper(IfcRaycaster);\n\n  function IfcRaycaster(context) {\n    var _this;\n\n    _classCallCheck(this, IfcRaycaster);\n\n    _this = _super.call(this, context);\n    _this.context = context;\n    _this.raycaster = new Raycaster();\n    _this.mouse = new IfcMouse(context);\n    return _this;\n  }\n\n  _createClass(IfcRaycaster, [{\n    key: \"castRay\",\n    value: function castRay(items) {\n      var camera = this.context.getCamera();\n      this.raycaster.setFromCamera(this.mouse.position, camera);\n      return this.raycaster.intersectObjects(items);\n    }\n  }, {\n    key: \"castRayIfc\",\n    value: function castRayIfc() {\n      var items = this.castRay(this.context.items.pickableIfcModels);\n      var filtered = this.filterClippingPlanes(items);\n      return filtered.length > 0 ? filtered[0] : null;\n    }\n  }, {\n    key: \"filterClippingPlanes\",\n    value: function filterClippingPlanes(objs) {\n      var planes = this.context.getClippingPlanes();\n      if (objs.length <= 0 || !planes || (planes === null || planes === void 0 ? void 0 : planes.length) <= 0) return objs; // const planes = this.clipper?.planes.map((p) => p.plane);\n\n      return objs.filter(function (elem) {\n        return planes.every(function (elem2) {\n          return elem2.distanceToPoint(elem.point) > 0;\n        });\n      });\n    }\n  }]);\n\n  return IfcRaycaster;\n}(IfcComponent);","map":{"version":3,"sources":["../../../src/components/context/raycaster.ts"],"names":[],"mappings":";;;;AAAA,SAAiC,SAAjC,QAAkD,OAAlD;AACA,SAAS,QAAT,QAAyB,SAAzB;AACA,SAAS,YAAT,QAAsC,kBAAtC;AAEA,WAAa,YAAb;AAAA;;AAAA;;AAKE,wBAAY,OAAZ,EAA4B;AAAA;;AAAA;;AAC1B,8BAAM,OAAN;AACA,UAAK,OAAL,GAAe,OAAf;AACA,UAAK,SAAL,GAAiB,IAAI,SAAJ,EAAjB;AACA,UAAK,KAAL,GAAa,IAAI,QAAJ,CAAa,OAAb,CAAb;AAJ0B;AAK3B;;AAVH;AAAA;AAAA,WAYE,iBAAQ,KAAR,EAAyB;AACvB,UAAM,MAAM,GAAG,KAAK,OAAL,CAAa,SAAb,EAAf;AACA,WAAK,SAAL,CAAe,aAAf,CAA6B,KAAK,KAAL,CAAW,QAAxC,EAAkD,MAAlD;AACA,aAAO,KAAK,SAAL,CAAe,gBAAf,CAAgC,KAAhC,CAAP;AACD;AAhBH;AAAA;AAAA,WAkBE,sBAAU;AACR,UAAM,KAAK,GAAG,KAAK,OAAL,CAAa,KAAK,OAAL,CAAa,KAAb,CAAmB,iBAAhC,CAAd;AACA,UAAM,QAAQ,GAAG,KAAK,oBAAL,CAA0B,KAA1B,CAAjB;AACA,aAAO,QAAQ,CAAC,MAAT,GAAkB,CAAlB,GAAsB,QAAQ,CAAC,CAAD,CAA9B,GAAoC,IAA3C;AACD;AAtBH;AAAA;AAAA,WAwBU,8BAAqB,IAArB,EAAyC;AAC/C,UAAM,MAAM,GAAG,KAAK,OAAL,CAAa,iBAAb,EAAf;AACA,UAAI,IAAI,CAAC,MAAL,IAAe,CAAf,IAAoB,CAAC,MAArB,IAA+B,CAAA,MAAM,KAAA,IAAN,IAAA,MAAM,KAAA,KAAA,CAAN,GAAM,KAAA,CAAN,GAAA,MAAM,CAAE,MAAR,KAAkB,CAArD,EAAwD,OAAO,IAAP,CAFT,CAG/C;;AACA,aAAO,IAAI,CAAC,MAAL,CAAY,UAAC,IAAD;AAAA,eAAU,MAAM,CAAC,KAAP,CAAa,UAAC,KAAD;AAAA,iBAAW,KAAK,CAAC,eAAN,CAAsB,IAAI,CAAC,KAA3B,IAAoC,CAA/C;AAAA,SAAb,CAAV;AAAA,OAAZ,CAAP;AACD;AA7BH;;AAAA;AAAA,EAAkC,YAAlC","sourceRoot":"","sourcesContent":["import { Raycaster } from 'three';\r\nimport { IfcMouse } from './mouse';\r\nimport { IfcComponent } from '../../base-types';\r\nexport class IfcRaycaster extends IfcComponent {\r\n    constructor(context) {\r\n        super(context);\r\n        this.context = context;\r\n        this.raycaster = new Raycaster();\r\n        this.mouse = new IfcMouse(context);\r\n    }\r\n    castRay(items) {\r\n        const camera = this.context.getCamera();\r\n        this.raycaster.setFromCamera(this.mouse.position, camera);\r\n        return this.raycaster.intersectObjects(items);\r\n    }\r\n    castRayIfc() {\r\n        const items = this.castRay(this.context.items.pickableIfcModels);\r\n        const filtered = this.filterClippingPlanes(items);\r\n        return filtered.length > 0 ? filtered[0] : null;\r\n    }\r\n    filterClippingPlanes(objs) {\r\n        const planes = this.context.getClippingPlanes();\r\n        if (objs.length <= 0 || !planes || (planes === null || planes === void 0 ? void 0 : planes.length) <= 0)\r\n            return objs;\r\n        // const planes = this.clipper?.planes.map((p) => p.plane);\r\n        return objs.filter((elem) => planes.every((elem2) => elem2.distanceToPoint(elem.point) > 0));\r\n    }\r\n}\r\n//# sourceMappingURL=raycaster.js.map"]},"metadata":{},"sourceType":"module"}