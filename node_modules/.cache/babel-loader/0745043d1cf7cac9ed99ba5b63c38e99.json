{"ast":null,"code":"import { Matrix4, Object3D, Vector3 } from 'three';\n\nclass CSS2DObject extends Object3D {\n  constructor() {\n    let element = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document.createElement('div');\n    super();\n    this.element = element;\n    this.element.style.position = 'absolute';\n    this.element.style.userSelect = 'none';\n    this.element.setAttribute('draggable', false);\n    this.addEventListener('removed', function () {\n      this.traverse(function (object) {\n        if (object.element instanceof Element && object.element.parentNode !== null) {\n          object.element.parentNode.removeChild(object.element);\n        }\n      });\n    });\n  }\n\n  copy(source, recursive) {\n    super.copy(source, recursive);\n    this.element = source.element.cloneNode(true);\n    return this;\n  }\n\n}\n\nCSS2DObject.prototype.isCSS2DObject = true; //\n\nconst _vector = new Vector3();\n\nconst _viewMatrix = new Matrix4();\n\nconst _viewProjectionMatrix = new Matrix4();\n\nconst _a = new Vector3();\n\nconst _b = new Vector3();\n\nclass CSS2DRenderer {\n  constructor() {\n    let parameters = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    const _this = this;\n\n    let _width, _height;\n\n    let _widthHalf, _heightHalf;\n\n    const cache = {\n      objects: new WeakMap()\n    };\n    const domElement = parameters.element !== undefined ? parameters.element : document.createElement('div');\n    domElement.style.overflow = 'hidden';\n    this.domElement = domElement;\n\n    this.getSize = function () {\n      return {\n        width: _width,\n        height: _height\n      };\n    };\n\n    this.render = function (scene, camera) {\n      if (scene.autoUpdate === true) scene.updateMatrixWorld();\n      if (camera.parent === null) camera.updateMatrixWorld();\n\n      _viewMatrix.copy(camera.matrixWorldInverse);\n\n      _viewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, _viewMatrix);\n\n      renderObject(scene, scene, camera);\n      zOrder(scene);\n    };\n\n    this.setSize = function (width, height) {\n      _width = width;\n      _height = height;\n      _widthHalf = _width / 2;\n      _heightHalf = _height / 2;\n      domElement.style.width = width + 'px';\n      domElement.style.height = height + 'px';\n    };\n\n    function renderObject(object, scene, camera) {\n      if (object.isCSS2DObject) {\n        object.onBeforeRender(_this, scene, camera);\n\n        _vector.setFromMatrixPosition(object.matrixWorld);\n\n        _vector.applyMatrix4(_viewProjectionMatrix);\n\n        const element = object.element;\n\n        if (/apple/i.test(navigator.vendor)) {\n          // https://github.com/mrdoob/three.js/issues/21415\n          element.style.transform = 'translate(-50%,-50%) translate(' + Math.round(_vector.x * _widthHalf + _widthHalf) + 'px,' + Math.round(-_vector.y * _heightHalf + _heightHalf) + 'px)';\n        } else {\n          element.style.transform = 'translate(-50%,-50%) translate(' + (_vector.x * _widthHalf + _widthHalf) + 'px,' + (-_vector.y * _heightHalf + _heightHalf) + 'px)';\n        }\n\n        element.style.display = object.visible && _vector.z >= -1 && _vector.z <= 1 ? '' : 'none';\n        const objectData = {\n          distanceToCameraSquared: getDistanceToSquared(camera, object)\n        };\n        cache.objects.set(object, objectData);\n\n        if (element.parentNode !== domElement) {\n          domElement.appendChild(element);\n        }\n\n        object.onAfterRender(_this, scene, camera);\n      }\n\n      for (let i = 0, l = object.children.length; i < l; i++) {\n        renderObject(object.children[i], scene, camera);\n      }\n    }\n\n    function getDistanceToSquared(object1, object2) {\n      _a.setFromMatrixPosition(object1.matrixWorld);\n\n      _b.setFromMatrixPosition(object2.matrixWorld);\n\n      return _a.distanceToSquared(_b);\n    }\n\n    function filterAndFlatten(scene) {\n      const result = [];\n      scene.traverse(function (object) {\n        if (object.isCSS2DObject) result.push(object);\n      });\n      return result;\n    }\n\n    function zOrder(scene) {\n      const sorted = filterAndFlatten(scene).sort(function (a, b) {\n        const distanceA = cache.objects.get(a).distanceToCameraSquared;\n        const distanceB = cache.objects.get(b).distanceToCameraSquared;\n        return distanceA - distanceB;\n      });\n      const zMax = sorted.length;\n\n      for (let i = 0, l = sorted.length; i < l; i++) {\n        sorted[i].element.style.zIndex = zMax - i;\n      }\n    }\n  }\n\n}\n\nexport { CSS2DObject, CSS2DRenderer };","map":{"version":3,"sources":["/Users/shangfualexcao/Desktop/IBT/node_modules/three/examples/jsm/renderers/CSS2DRenderer.js"],"names":["Matrix4","Object3D","Vector3","CSS2DObject","constructor","element","document","createElement","style","position","userSelect","setAttribute","addEventListener","traverse","object","Element","parentNode","removeChild","copy","source","recursive","cloneNode","prototype","isCSS2DObject","_vector","_viewMatrix","_viewProjectionMatrix","_a","_b","CSS2DRenderer","parameters","_this","_width","_height","_widthHalf","_heightHalf","cache","objects","WeakMap","domElement","undefined","overflow","getSize","width","height","render","scene","camera","autoUpdate","updateMatrixWorld","parent","matrixWorldInverse","multiplyMatrices","projectionMatrix","renderObject","zOrder","setSize","onBeforeRender","setFromMatrixPosition","matrixWorld","applyMatrix4","test","navigator","vendor","transform","Math","round","x","y","display","visible","z","objectData","distanceToCameraSquared","getDistanceToSquared","set","appendChild","onAfterRender","i","l","children","length","object1","object2","distanceToSquared","filterAndFlatten","result","push","sorted","sort","a","b","distanceA","get","distanceB","zMax","zIndex"],"mappings":"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","sourcesContent":["import {\n\tMatrix4,\n\tObject3D,\n\tVector3\n} from 'three';\n\nclass CSS2DObject extends Object3D {\n\n\tconstructor( element = document.createElement( 'div' ) ) {\n\n\t\tsuper();\n\n\t\tthis.element = element;\n\n\t\tthis.element.style.position = 'absolute';\n\t\tthis.element.style.userSelect = 'none';\n\n\t\tthis.element.setAttribute( 'draggable', false );\n\n\t\tthis.addEventListener( 'removed', function () {\n\n\t\t\tthis.traverse( function ( object ) {\n\n\t\t\t\tif ( object.element instanceof Element && object.element.parentNode !== null ) {\n\n\t\t\t\t\tobject.element.parentNode.removeChild( object.element );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.element = source.element.cloneNode( true );\n\n\t\treturn this;\n\n\t}\n\n}\n\nCSS2DObject.prototype.isCSS2DObject = true;\n\n//\n\nconst _vector = new Vector3();\nconst _viewMatrix = new Matrix4();\nconst _viewProjectionMatrix = new Matrix4();\nconst _a = new Vector3();\nconst _b = new Vector3();\n\nclass CSS2DRenderer {\n\n\tconstructor( parameters = {} ) {\n\n\t\tconst _this = this;\n\n\t\tlet _width, _height;\n\t\tlet _widthHalf, _heightHalf;\n\n\t\tconst cache = {\n\t\t\tobjects: new WeakMap()\n\t\t};\n\n\t\tconst domElement = parameters.element !== undefined ? parameters.element : document.createElement( 'div' );\n\n\t\tdomElement.style.overflow = 'hidden';\n\n\t\tthis.domElement = domElement;\n\n\t\tthis.getSize = function () {\n\n\t\t\treturn {\n\t\t\t\twidth: _width,\n\t\t\t\theight: _height\n\t\t\t};\n\n\t\t};\n\n\t\tthis.render = function ( scene, camera ) {\n\n\t\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\n\t\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\t\t_viewMatrix.copy( camera.matrixWorldInverse );\n\t\t\t_viewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, _viewMatrix );\n\n\t\t\trenderObject( scene, scene, camera );\n\t\t\tzOrder( scene );\n\n\t\t};\n\n\t\tthis.setSize = function ( width, height ) {\n\n\t\t\t_width = width;\n\t\t\t_height = height;\n\n\t\t\t_widthHalf = _width / 2;\n\t\t\t_heightHalf = _height / 2;\n\n\t\t\tdomElement.style.width = width + 'px';\n\t\t\tdomElement.style.height = height + 'px';\n\n\t\t};\n\n\t\tfunction renderObject( object, scene, camera ) {\n\n\t\t\tif ( object.isCSS2DObject ) {\n\n\t\t\t\tobject.onBeforeRender( _this, scene, camera );\n\n\t\t\t\t_vector.setFromMatrixPosition( object.matrixWorld );\n\t\t\t\t_vector.applyMatrix4( _viewProjectionMatrix );\n\n\t\t\t\tconst element = object.element;\n\n\t\t\t\tif ( /apple/i.test( navigator.vendor ) ) {\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/21415\n\t\t\t\t\telement.style.transform = 'translate(-50%,-50%) translate(' + Math.round( _vector.x * _widthHalf + _widthHalf ) + 'px,' + Math.round( - _vector.y * _heightHalf + _heightHalf ) + 'px)';\n\n\t\t\t\t} else {\n\n\t\t\t\t\telement.style.transform = 'translate(-50%,-50%) translate(' + ( _vector.x * _widthHalf + _widthHalf ) + 'px,' + ( - _vector.y * _heightHalf + _heightHalf ) + 'px)';\n\n\t\t\t\t}\n\n\t\t\t\telement.style.display = ( object.visible && _vector.z >= - 1 && _vector.z <= 1 ) ? '' : 'none';\n\n\t\t\t\tconst objectData = {\n\t\t\t\t\tdistanceToCameraSquared: getDistanceToSquared( camera, object )\n\t\t\t\t};\n\n\t\t\t\tcache.objects.set( object, objectData );\n\n\t\t\t\tif ( element.parentNode !== domElement ) {\n\n\t\t\t\t\tdomElement.appendChild( element );\n\n\t\t\t\t}\n\n\t\t\t\tobject.onAfterRender( _this, scene, camera );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\t\trenderObject( object.children[ i ], scene, camera );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getDistanceToSquared( object1, object2 ) {\n\n\t\t\t_a.setFromMatrixPosition( object1.matrixWorld );\n\t\t\t_b.setFromMatrixPosition( object2.matrixWorld );\n\n\t\t\treturn _a.distanceToSquared( _b );\n\n\t\t}\n\n\t\tfunction filterAndFlatten( scene ) {\n\n\t\t\tconst result = [];\n\n\t\t\tscene.traverse( function ( object ) {\n\n\t\t\t\tif ( object.isCSS2DObject ) result.push( object );\n\n\t\t\t} );\n\n\t\t\treturn result;\n\n\t\t}\n\n\t\tfunction zOrder( scene ) {\n\n\t\t\tconst sorted = filterAndFlatten( scene ).sort( function ( a, b ) {\n\n\t\t\t\tconst distanceA = cache.objects.get( a ).distanceToCameraSquared;\n\t\t\t\tconst distanceB = cache.objects.get( b ).distanceToCameraSquared;\n\n\t\t\t\treturn distanceA - distanceB;\n\n\t\t\t} );\n\n\t\t\tconst zMax = sorted.length;\n\n\t\t\tfor ( let i = 0, l = sorted.length; i < l; i ++ ) {\n\n\t\t\t\tsorted[ i ].element.style.zIndex = zMax - i;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nexport { CSS2DObject, CSS2DRenderer };\n"]},"metadata":{},"sourceType":"module"}