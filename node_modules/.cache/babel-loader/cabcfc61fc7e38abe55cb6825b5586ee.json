{"ast":null,"code":"import _regeneratorRuntime from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { IfcComponent } from '../../base-types';\nexport var IfcSelection = /*#__PURE__*/function (_IfcComponent) {\n  _inherits(IfcSelection, _IfcComponent);\n\n  var _super = _createSuper(IfcSelection);\n\n  function IfcSelection(context, loader, material) {\n    var _this;\n\n    _classCallCheck(this, IfcSelection);\n\n    _this = _super.call(this, context);\n    _this.context = context;\n    _this.mesh = null;\n\n    _this.pick = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(item) {\n        var focusSelection,\n            duration,\n            mesh,\n            id,\n            _args = arguments;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                focusSelection = _args.length > 1 && _args[1] !== undefined ? _args[1] : false;\n                duration = _args.length > 2 ? _args[2] : undefined;\n\n                if (!(_this.selected === item.faceIndex || item.faceIndex == null)) {\n                  _context.next = 4;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", null);\n\n              case 4:\n                _this.selected = item.faceIndex;\n                mesh = item.object;\n                _context.next = 8;\n                return _this.loader.ifcManager.getExpressId(mesh.geometry, item.faceIndex);\n\n              case 8:\n                id = _context.sent;\n\n                if (!(id === undefined)) {\n                  _context.next = 11;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", null);\n\n              case 11:\n                _this.removeSelectionOfOtherModel(mesh);\n\n                _this.modelID = mesh.modelID;\n\n                _this.newSelection([id]);\n\n                if (focusSelection) _this.focusSelection(duration);\n                return _context.abrupt(\"return\", {\n                  modelID: _this.modelID,\n                  id: id\n                });\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.pickByID = function (modelID, ids) {\n      var focusSelection = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var duration = arguments.length > 3 ? arguments[3] : undefined;\n      _this.modelID = modelID;\n\n      _this.newSelection(ids);\n\n      if (focusSelection) _this.focusSelection(duration);\n    };\n\n    _this.newSelection = function (ids) {\n      var mesh = _this.loader.ifcManager.createSubset({\n        scene: _this.scene,\n        modelID: _this.modelID,\n        ids: ids,\n        removePrevious: true,\n        material: _this.material\n      });\n\n      if (mesh) {\n        _this.mesh = mesh;\n      }\n    };\n\n    _this.scene = context.getScene();\n    _this.loader = loader;\n    _this.material = material;\n    _this.selected = -1;\n    _this.modelID = -1;\n    return _this;\n  }\n\n  _createClass(IfcSelection, [{\n    key: \"unpick\",\n    value: function unpick() {\n      this.mesh = null;\n      this.loader.ifcManager.removeSubset(this.modelID, this.scene, this.material);\n    }\n  }, {\n    key: \"removeSelectionOfOtherModel\",\n    value: function removeSelectionOfOtherModel(mesh) {\n      if (this.modelID !== undefined && this.modelID !== (mesh === null || mesh === void 0 ? void 0 : mesh.modelID)) {\n        this.loader.ifcManager.removeSubset(this.modelID, this.scene, this.material);\n      }\n    }\n  }, {\n    key: \"focusSelection\",\n    value: function focusSelection(duration) {\n      if (this.mesh) {\n        this.context.ifcCamera.targetItem(this.mesh, duration);\n      }\n    }\n  }]);\n\n  return IfcSelection;\n}(IfcComponent);","map":{"version":3,"sources":["../../../src/components/ifc/selection.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { IfcComponent } from '../../base-types';\r\nexport class IfcSelection extends IfcComponent {\r\n    constructor(context, loader, material) {\r\n        super(context);\r\n        this.context = context;\r\n        this.mesh = null;\r\n        this.pick = async (item, focusSelection = false, duration) => {\r\n            if (this.selected === item.faceIndex || item.faceIndex == null)\r\n                return null;\r\n            this.selected = item.faceIndex;\r\n            const mesh = item.object;\r\n            const id = await this.loader.ifcManager.getExpressId(mesh.geometry, item.faceIndex);\r\n            if (id === undefined)\r\n                return null;\r\n            this.removeSelectionOfOtherModel(mesh);\r\n            this.modelID = mesh.modelID;\r\n            this.newSelection([id]);\r\n            if (focusSelection)\r\n                this.focusSelection(duration);\r\n            return { modelID: this.modelID, id };\r\n        };\r\n        this.pickByID = (modelID, ids, focusSelection = false, duration) => {\r\n            this.modelID = modelID;\r\n            this.newSelection(ids);\r\n            if (focusSelection)\r\n                this.focusSelection(duration);\r\n        };\r\n        this.newSelection = (ids) => {\r\n            const mesh = this.loader.ifcManager.createSubset({\r\n                scene: this.scene,\r\n                modelID: this.modelID,\r\n                ids,\r\n                removePrevious: true,\r\n                material: this.material\r\n            });\r\n            if (mesh) {\r\n                this.mesh = mesh;\r\n            }\r\n        };\r\n        this.scene = context.getScene();\r\n        this.loader = loader;\r\n        this.material = material;\r\n        this.selected = -1;\r\n        this.modelID = -1;\r\n    }\r\n    unpick() {\r\n        this.mesh = null;\r\n        this.loader.ifcManager.removeSubset(this.modelID, this.scene, this.material);\r\n    }\r\n    removeSelectionOfOtherModel(mesh) {\r\n        if (this.modelID !== undefined && this.modelID !== (mesh === null || mesh === void 0 ? void 0 : mesh.modelID)) {\r\n            this.loader.ifcManager.removeSubset(this.modelID, this.scene, this.material);\r\n        }\r\n    }\r\n    focusSelection(duration) {\r\n        if (this.mesh) {\r\n            this.context.ifcCamera.targetItem(this.mesh, duration);\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=selection.js.map"]},"metadata":{},"sourceType":"module"}