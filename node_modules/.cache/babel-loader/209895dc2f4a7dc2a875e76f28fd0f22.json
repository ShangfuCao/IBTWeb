{"ast":null,"code":"import _classCallCheck from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Color, Vector2, WebGLRenderer } from 'three';\nimport { CSS2DRenderer } from 'three/examples/jsm/renderers/CSS2DRenderer';\nimport { IfcComponent } from '../../../base-types';\nimport { IfcPostproduction } from './postproduction';\nexport var IfcRenderer = /*#__PURE__*/function (_IfcComponent) {\n  _inherits(IfcRenderer, _IfcComponent);\n\n  var _super = _createSuper(IfcRenderer);\n\n  function IfcRenderer(context) {\n    var _this;\n\n    _classCallCheck(this, IfcRenderer);\n\n    _this = _super.call(this, context);\n    _this.basicRenderer = new WebGLRenderer({\n      antialias: true\n    });\n    _this.renderer2D = new CSS2DRenderer();\n    _this.renderer = _this.basicRenderer;\n    _this.postProductionActive = false;\n    _this.context = context;\n    _this.container = context.options.container;\n\n    _this.setupRenderers();\n\n    _this.postProductionRenderer = new IfcPostproduction(_this.context, _this.basicRenderer.domElement);\n\n    _this.adjustRendererSize();\n\n    return _this;\n  }\n\n  _createClass(IfcRenderer, [{\n    key: \"usePostproduction\",\n    get: function get() {\n      return this.postProductionActive;\n    },\n    set: function set(active) {\n      if (this.postProductionActive === active) return;\n      this.postProductionActive = active;\n      this.renderer = active ? this.postProductionRenderer : this.basicRenderer;\n      if (!active) this.restoreRendererBackgroundColor();\n    }\n  }, {\n    key: \"update\",\n    value: function update(_delta) {\n      var scene = this.context.getScene();\n      var camera = this.context.getCamera();\n      this.renderer.render(scene, camera);\n      this.renderer2D.render(scene, camera);\n    }\n  }, {\n    key: \"getSize\",\n    value: function getSize() {\n      return new Vector2(this.basicRenderer.domElement.clientWidth, this.basicRenderer.domElement.clientHeight);\n    }\n  }, {\n    key: \"adjustRendererSize\",\n    value: function adjustRendererSize() {\n      this.basicRenderer.setSize(this.container.clientWidth, this.container.clientHeight);\n      this.renderer2D.setSize(this.container.clientWidth, this.container.clientHeight);\n      this.postProductionRenderer.setSize(this.container.clientWidth, this.container.clientHeight);\n    }\n  }, {\n    key: \"newScreenshot\",\n    value: function newScreenshot() {\n      var usePostproduction = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var scene = this.context.getScene();\n      var camera = this.context.getCamera();\n      this.renderer.render(scene, camera);\n      var domElement = usePostproduction ? this.basicRenderer.domElement : this.postProductionRenderer.renderer.domElement;\n      return domElement.toDataURL();\n    }\n  }, {\n    key: \"setupRenderers\",\n    value: function setupRenderers() {\n      this.basicRenderer.localClippingEnabled = true;\n      this.container.appendChild(this.basicRenderer.domElement);\n      this.renderer2D.domElement.style.position = 'absolute';\n      this.renderer2D.domElement.style.top = '0px';\n      this.renderer2D.domElement.style.pointerEvents = 'none';\n      this.container.appendChild(this.renderer2D.domElement);\n    }\n  }, {\n    key: \"restoreRendererBackgroundColor\",\n    value: function restoreRendererBackgroundColor() {\n      this.basicRenderer.setClearColor(new Color(0, 0, 0), 0);\n    }\n  }]);\n\n  return IfcRenderer;\n}(IfcComponent);","map":{"version":3,"sources":["../../../../src/components/context/renderer/renderer.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { Color, Vector2, WebGLRenderer } from 'three';\r\nimport { CSS2DRenderer } from 'three/examples/jsm/renderers/CSS2DRenderer';\r\nimport { IfcComponent } from '../../../base-types';\r\nimport { IfcPostproduction } from './postproduction';\r\nexport class IfcRenderer extends IfcComponent {\r\n    constructor(context) {\r\n        super(context);\r\n        this.basicRenderer = new WebGLRenderer({ antialias: true });\r\n        this.renderer2D = new CSS2DRenderer();\r\n        this.renderer = this.basicRenderer;\r\n        this.postProductionActive = false;\r\n        this.context = context;\r\n        this.container = context.options.container;\r\n        this.setupRenderers();\r\n        this.postProductionRenderer = new IfcPostproduction(this.context, this.basicRenderer.domElement);\r\n        this.adjustRendererSize();\r\n    }\r\n    get usePostproduction() {\r\n        return this.postProductionActive;\r\n    }\r\n    set usePostproduction(active) {\r\n        if (this.postProductionActive === active)\r\n            return;\r\n        this.postProductionActive = active;\r\n        this.renderer = active ? this.postProductionRenderer : this.basicRenderer;\r\n        if (!active)\r\n            this.restoreRendererBackgroundColor();\r\n    }\r\n    update(_delta) {\r\n        const scene = this.context.getScene();\r\n        const camera = this.context.getCamera();\r\n        this.renderer.render(scene, camera);\r\n        this.renderer2D.render(scene, camera);\r\n    }\r\n    getSize() {\r\n        return new Vector2(this.basicRenderer.domElement.clientWidth, this.basicRenderer.domElement.clientHeight);\r\n    }\r\n    adjustRendererSize() {\r\n        this.basicRenderer.setSize(this.container.clientWidth, this.container.clientHeight);\r\n        this.renderer2D.setSize(this.container.clientWidth, this.container.clientHeight);\r\n        this.postProductionRenderer.setSize(this.container.clientWidth, this.container.clientHeight);\r\n    }\r\n    newScreenshot(usePostproduction = false) {\r\n        const scene = this.context.getScene();\r\n        const camera = this.context.getCamera();\r\n        this.renderer.render(scene, camera);\r\n        const domElement = usePostproduction\r\n            ? this.basicRenderer.domElement\r\n            : this.postProductionRenderer.renderer.domElement;\r\n        return domElement.toDataURL();\r\n    }\r\n    setupRenderers() {\r\n        this.basicRenderer.localClippingEnabled = true;\r\n        this.container.appendChild(this.basicRenderer.domElement);\r\n        this.renderer2D.domElement.style.position = 'absolute';\r\n        this.renderer2D.domElement.style.top = '0px';\r\n        this.renderer2D.domElement.style.pointerEvents = 'none';\r\n        this.container.appendChild(this.renderer2D.domElement);\r\n    }\r\n    restoreRendererBackgroundColor() {\r\n        this.basicRenderer.setClearColor(new Color(0, 0, 0), 0);\r\n    }\r\n}\r\n//# sourceMappingURL=renderer.js.map"]},"metadata":{},"sourceType":"module"}