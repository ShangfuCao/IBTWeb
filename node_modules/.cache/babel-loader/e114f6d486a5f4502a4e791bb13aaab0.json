{"ast":null,"code":"import * as WebIFC from 'web-ifc';\nimport { IFCRELAGGREGATES, IFCRELCONTAINEDINSPATIALSTRUCTURE, IFCRELDEFINESBYPROPERTIES, IFCRELASSOCIATESMATERIAL, IFCRELDEFINESBYTYPE, IFCSPACE, IFCOPENINGELEMENT, IFCPROJECT } from 'web-ifc';\nimport { BufferAttribute, Mesh, Matrix4, BufferGeometry, Color, MeshLambertMaterial, DoubleSide, Loader, FileLoader } from 'three';\nimport { mergeBufferGeometries } from 'three/examples/jsm/utils/BufferGeometryUtils';\nconst IdAttrName = 'expressID';\n\nconst merge = function (geoms) {\n  let createGroups = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  return mergeBufferGeometries(geoms, createGroups);\n};\n\nconst newFloatAttr = (data, size) => {\n  return new BufferAttribute(new Float32Array(data), size);\n};\n\nconst newIntAttr = (data, size) => {\n  return new BufferAttribute(new Uint32Array(data), size);\n};\n\nconst DEFAULT = 'default';\nconst PropsNames = {\n  aggregates: {\n    name: IFCRELAGGREGATES,\n    relating: 'RelatingObject',\n    related: 'RelatedObjects',\n    key: 'children'\n  },\n  spatial: {\n    name: IFCRELCONTAINEDINSPATIALSTRUCTURE,\n    relating: 'RelatingStructure',\n    related: 'RelatedElements',\n    key: 'children'\n  },\n  psets: {\n    name: IFCRELDEFINESBYPROPERTIES,\n    relating: 'RelatingPropertyDefinition',\n    related: 'RelatedObjects',\n    key: 'hasPsets'\n  },\n  materials: {\n    name: IFCRELASSOCIATESMATERIAL,\n    relating: 'RelatingMaterial',\n    related: 'RelatedObjects',\n    key: 'hasMaterial'\n  },\n  type: {\n    name: IFCRELDEFINESBYTYPE,\n    relating: 'RelatingType',\n    related: 'RelatedObjects',\n    key: 'hasType'\n  }\n};\nlet modelIdCounter = 0;\nconst nullIfcManagerErrorMessage = 'IfcManager is null!';\n\nclass IFCModel extends Mesh {\n  constructor() {\n    super(...arguments);\n    this.modelID = modelIdCounter++;\n    this.ifcManager = null;\n    this.mesh = this;\n  }\n\n  setIFCManager(manager) {\n    this.ifcManager = manager;\n  }\n\n  setWasmPath(path) {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    this.ifcManager.setWasmPath(path);\n  }\n\n  close(scene) {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    this.ifcManager.close(this.modelID, scene);\n  }\n\n  getExpressId(geometry, faceIndex) {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    return this.ifcManager.getExpressId(geometry, faceIndex);\n  }\n\n  getAllItemsOfType(type, verbose) {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    return this.ifcManager.getAllItemsOfType(this.modelID, type, verbose);\n  }\n\n  getItemProperties(id) {\n    let recursive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    return this.ifcManager.getItemProperties(this.modelID, id, recursive);\n  }\n\n  getPropertySets(id) {\n    let recursive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    return this.ifcManager.getPropertySets(this.modelID, id, recursive);\n  }\n\n  getTypeProperties(id) {\n    let recursive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    return this.ifcManager.getTypeProperties(this.modelID, id, recursive);\n  }\n\n  getIfcType(id) {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    return this.ifcManager.getIfcType(this.modelID, id);\n  }\n\n  getSpatialStructure() {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    return this.ifcManager.getSpatialStructure(this.modelID);\n  }\n\n  getSubset(material) {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    return this.ifcManager.getSubset(this.modelID, material);\n  }\n\n  removeSubset(parent, material) {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    this.ifcManager.removeSubset(this.modelID, parent, material);\n  }\n\n  createSubset(config) {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    const modelConfig = { ...config,\n      modelID: this.modelID\n    };\n    return this.ifcManager.createSubset(modelConfig);\n  }\n\n  hideItems(ids) {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    this.ifcManager.hideItems(this.modelID, ids);\n  }\n\n  hideAllItems() {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    this.ifcManager.hideAllItems(this.modelID);\n  }\n\n  showItems(ids) {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    this.ifcManager.showItems(this.modelID, ids);\n  }\n\n  showAllItems() {\n    if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\n    this.ifcManager.showAllItems(this.modelID);\n  }\n\n}\n\nclass IFCParser {\n  constructor(state, BVH) {\n    this.state = state;\n    this.BVH = BVH;\n    this.loadedModels = 0;\n    this.optionalCategories = {\n      [IFCSPACE]: true,\n      [IFCOPENINGELEMENT]: false\n    };\n    this.currentWebIfcID = -1;\n    this.currentModelID = -1;\n  }\n\n  async setupOptionalCategories(config) {\n    this.optionalCategories = config;\n  }\n\n  async parse(buffer, coordinationMatrix) {\n    if (this.state.api.wasmModule === undefined) await this.state.api.Init();\n    await this.newIfcModel(buffer);\n    this.loadedModels++;\n\n    if (coordinationMatrix) {\n      await this.state.api.SetGeometryTransformation(this.currentWebIfcID, coordinationMatrix);\n    }\n\n    return this.loadAllGeometry();\n  }\n\n  getAndClearErrors(_modelId) {}\n\n  notifyProgress(loaded, total) {\n    if (this.state.onProgress) this.state.onProgress({\n      loaded,\n      total\n    });\n  }\n\n  async newIfcModel(buffer) {\n    const data = new Uint8Array(buffer);\n    this.currentWebIfcID = await this.state.api.OpenModel(data, this.state.webIfcSettings);\n    this.currentModelID = this.state.useJSON ? this.loadedModels : this.currentWebIfcID;\n    this.state.models[this.currentModelID] = {\n      modelID: this.currentModelID,\n      mesh: {},\n      items: {},\n      types: {},\n      jsonData: {}\n    };\n  }\n\n  async loadAllGeometry() {\n    await this.saveAllPlacedGeometriesByMaterial();\n    return this.generateAllGeometriesByMaterial();\n  }\n\n  generateAllGeometriesByMaterial() {\n    const {\n      geometry,\n      materials\n    } = this.getGeometryAndMaterials();\n    if (this.BVH) this.BVH.applyThreeMeshBVH(geometry);\n    const mesh = new IFCModel(geometry, materials);\n    mesh.modelID = this.currentModelID;\n    this.state.models[this.currentModelID].mesh = mesh;\n    return mesh;\n  }\n\n  getGeometryAndMaterials() {\n    const items = this.state.models[this.currentModelID].items;\n    const mergedByMaterial = [];\n    const materials = [];\n\n    for (let materialID in items) {\n      if (items.hasOwnProperty(materialID)) {\n        materials.push(items[materialID].material);\n        const geometries = Object.values(items[materialID].geometries);\n        mergedByMaterial.push(merge(geometries));\n      }\n    }\n\n    const geometry = merge(mergedByMaterial, true);\n    return {\n      geometry,\n      materials\n    };\n  }\n\n  async saveAllPlacedGeometriesByMaterial() {\n    await this.addOptionalCategories();\n    const flatMeshes = await this.state.api.LoadAllGeometry(this.currentWebIfcID);\n    const size = flatMeshes.size();\n    let counter = 0;\n\n    for (let i = 0; i < size; i++) {\n      if (i > counter) {\n        this.notifyProgress(i, size);\n        counter += Math.trunc(size / 10);\n      }\n\n      const flatMesh = flatMeshes.get(i);\n      const placedGeom = flatMesh.geometries;\n\n      for (let j = 0; j < placedGeom.size(); j++) {\n        await this.savePlacedGeometry(placedGeom.get(j), flatMesh.expressID);\n      }\n    }\n  }\n\n  async addOptionalCategories() {\n    const optionalTypes = [];\n\n    for (let key in this.optionalCategories) {\n      if (this.optionalCategories.hasOwnProperty(key)) {\n        const category = parseInt(key);\n        if (this.optionalCategories[category]) optionalTypes.push(category);\n      }\n    }\n\n    await this.state.api.StreamAllMeshesWithTypes(this.currentWebIfcID, optionalTypes, async mesh => {\n      const geometries = mesh.geometries;\n      const size = geometries.size();\n\n      for (let j = 0; j < size; j++) {\n        await this.savePlacedGeometry(geometries.get(j), mesh.expressID);\n      }\n    });\n  }\n\n  async savePlacedGeometry(placedGeometry, id) {\n    const geometry = await this.getGeometry(placedGeometry);\n    this.saveGeometryByMaterial(geometry, placedGeometry, id);\n  }\n\n  async getGeometry(placedGeometry) {\n    const geometry = await this.getBufferGeometry(placedGeometry);\n    geometry.computeVertexNormals();\n    const matrix = IFCParser.getMeshMatrix(placedGeometry.flatTransformation);\n    geometry.applyMatrix4(matrix);\n    return geometry;\n  }\n\n  async getBufferGeometry(placed) {\n    const geometry = await this.state.api.GetGeometry(this.currentWebIfcID, placed.geometryExpressID);\n    const vertexData = await this.getVertices(geometry);\n    const indices = await this.getIndices(geometry);\n    const {\n      vertices,\n      normals\n    } = IFCParser.extractVertexData(vertexData);\n    return IFCParser.ifcGeomToBufferGeom(vertices, normals, indices);\n  }\n\n  async getVertices(geometry) {\n    const vData = geometry.GetVertexData();\n    const vDataSize = geometry.GetVertexDataSize();\n    return this.state.api.GetVertexArray(vData, vDataSize);\n  }\n\n  async getIndices(geometry) {\n    const iData = geometry.GetIndexData();\n    const iDataSize = geometry.GetIndexDataSize();\n    return this.state.api.GetIndexArray(iData, iDataSize);\n  }\n\n  static getMeshMatrix(matrix) {\n    const mat = new Matrix4();\n    mat.fromArray(matrix);\n    return mat;\n  }\n\n  static ifcGeomToBufferGeom(vertices, normals, indexData) {\n    const geometry = new BufferGeometry();\n    geometry.setAttribute('position', newFloatAttr(vertices, 3));\n    geometry.setAttribute('normal', newFloatAttr(normals, 3));\n    geometry.setIndex(new BufferAttribute(indexData, 1));\n    return geometry;\n  }\n\n  static extractVertexData(vertexData) {\n    const vertices = [];\n    const normals = [];\n    let isNormalData = false;\n\n    for (let i = 0; i < vertexData.length; i++) {\n      isNormalData ? normals.push(vertexData[i]) : vertices.push(vertexData[i]);\n      if ((i + 1) % 3 == 0) isNormalData = !isNormalData;\n    }\n\n    return {\n      vertices,\n      normals\n    };\n  }\n\n  saveGeometryByMaterial(geom, placedGeom, id) {\n    const color = placedGeom.color;\n    const colorID = `${color.x}${color.y}${color.z}${color.w}`;\n    IFCParser.storeGeometryAttribute(id, geom);\n    this.createMaterial(colorID, color);\n    const item = this.state.models[this.currentModelID].items[colorID];\n    const currentGeom = item.geometries[id];\n    if (!currentGeom) return item.geometries[id] = geom;\n    item.geometries[id] = merge([currentGeom, geom]);\n  }\n\n  static storeGeometryAttribute(id, geometry) {\n    const size = geometry.attributes.position.count;\n    const idAttribute = new Array(size).fill(id);\n    geometry.setAttribute(IdAttrName, newIntAttr(idAttribute, 1));\n  }\n\n  createMaterial(colorID, color) {\n    const items = this.state.models[this.currentModelID].items;\n    if (items[colorID]) return;\n    const col = new Color(color.x, color.y, color.z);\n    const newMaterial = new MeshLambertMaterial({\n      color: col,\n      side: DoubleSide\n    });\n    newMaterial.transparent = color.w !== 1;\n    if (newMaterial.transparent) newMaterial.opacity = color.w;\n    items[colorID] = {\n      material: newMaterial,\n      geometries: {}\n    };\n  }\n\n}\n\nclass SubsetManager {\n  constructor(state, BVH) {\n    this.selected = {};\n    this.state = state;\n    this.BVH = BVH;\n  }\n\n  dispose() {}\n\n  getSubset(modelID, material, customId) {\n    const currentMat = this.matIDNoConfig(modelID, material, customId);\n    return this.selected[currentMat].mesh || null;\n  }\n\n  removeSubset(modelID, parent, material, customId) {\n    const currentMat = this.matIDNoConfig(modelID, material, customId);\n    if (!this.selected[currentMat]) return;\n    if (parent) parent.remove(this.selected[currentMat].mesh);\n    delete this.selected[currentMat];\n  }\n\n  createSubset(config) {\n    this.checkConfigValid(config);\n    if (this.isPreviousSelection(config)) return;\n    if (this.isEasySelection(config)) return this.addToPreviousSelection(config);\n    this.updatePreviousSelection(config.scene, config);\n    return this.createSelectionInScene(config);\n  }\n\n  createSelectionInScene(config) {\n    const filtered = this.filter(config);\n    const {\n      geomsByMaterial,\n      materials\n    } = this.getGeomAndMat(filtered);\n    if (geomsByMaterial.length <= 0) return null;\n    const isDefMaterial = this.isDefaultMat(config);\n    const geometry = this.getMergedGeometry(geomsByMaterial, isDefMaterial);\n    const mats = isDefMaterial ? materials : config.material;\n    this.BVH.applyThreeMeshBVH(geometry);\n    const mesh = new Mesh(geometry, mats);\n    this.selected[this.matID(config)].mesh = mesh;\n    mesh.modelID = config.modelID;\n    config.scene.add(mesh);\n    return mesh;\n  }\n\n  getMergedGeometry(geomsByMaterial, hasDefaultMaterial) {\n    return geomsByMaterial.length > 0 ? merge(geomsByMaterial, hasDefaultMaterial) : new BufferGeometry();\n  }\n\n  checkConfigValid(config) {\n    this.checkValidConfigParam(config.scene);\n    this.checkValidConfigParam(config.modelID);\n    this.checkValidConfigParam(config.ids);\n    this.checkValidConfigParam(config.removePrevious);\n\n    if (config.ids.length <= 0) {\n      throw new Error('Error: config parameter ids cannot be empty');\n    }\n  }\n\n  checkValidConfigParam(item) {\n    if (item === undefined || item === null) throw new Error(`Error with subset config parameter: ${item}`);\n  }\n\n  getGeomAndMat(filtered) {\n    const geomsByMaterial = [];\n    const materials = [];\n\n    for (let matID in filtered) {\n      let geoms = Object.values(filtered[matID].geometries);\n      geoms = geoms.filter(geom => Object.values(geom.attributes).length > 0);\n      if (!geoms.length) continue;\n      materials.push(filtered[matID].material);\n      if (geoms.length > 1) geomsByMaterial.push(merge(geoms));else geomsByMaterial.push(...geoms);\n    }\n\n    return {\n      geomsByMaterial,\n      materials\n    };\n  }\n\n  updatePreviousSelection(parent, config) {\n    const previous = this.selected[this.matID(config)];\n    if (!previous) return this.newSelectionGroup(config);\n    parent.remove(previous.mesh);\n    config.removePrevious ? previous.ids = new Set(config.ids) : config.ids.forEach(id => previous.ids.add(id));\n  }\n\n  newSelectionGroup(config) {\n    this.selected[this.matID(config)] = {\n      ids: new Set(config.ids),\n      mesh: {}\n    };\n  }\n\n  isPreviousSelection(config) {\n    if (!this.selected[this.matID(config)]) return false;\n    if (this.containsIds(config)) return true;\n    const previousIds = this.selected[this.matID(config)].ids;\n    return JSON.stringify(config.ids) === JSON.stringify(previousIds);\n  }\n\n  containsIds(config) {\n    const newIds = config.ids;\n    const previous = Array.from(this.selected[this.matID(config)].ids);\n    return newIds.every((i => v => i = previous.indexOf(v, i) + 1)(0));\n  }\n\n  addToPreviousSelection(config) {\n    const previous = this.selected[this.matID(config)];\n    const filtered = this.filter(config, new Set(config.ids));\n    const geometries = Object.values(filtered).map(i => Object.values(i.geometries)).flat();\n    const previousGeom = previous.mesh.geometry;\n    previous.mesh.geometry = merge([previousGeom, ...geometries]);\n    config.ids.forEach(id => previous.ids.add(id));\n  }\n\n  filter(config, itemsID) {\n    const ids = itemsID || this.selected[this.matID(config)].ids;\n    const items = this.state.models[config.modelID].items;\n    const filtered = {};\n\n    for (let matID in items) {\n      filtered[matID] = {\n        material: items[matID].material,\n        geometries: this.filterGeometries(ids, items[matID].geometries)\n      };\n    }\n\n    return filtered;\n  }\n\n  filterGeometries(selectedIDs, geometries) {\n    const ids = Array.from(selectedIDs);\n    return Object.keys(geometries).filter(key => ids.includes(parseInt(key, 10))).reduce((obj, key) => {\n      return { ...obj,\n        [key]: geometries[key]\n      };\n    }, {});\n  }\n\n  isEasySelection(config) {\n    const matID = this.matID(config);\n    if (!config.removePrevious && !this.isDefaultMat(config) && this.selected[matID]) return true;\n  }\n\n  isDefaultMat(config) {\n    const id = this.matIDNoConfig(config.modelID, undefined, config.customId);\n    const id2 = this.matID(config);\n    return id === id2;\n  }\n\n  matID(config) {\n    let name;\n    if (!config.material) name = DEFAULT;else name = config.material.uuid;\n    name += ' - ' + (config.customId || \"\");\n    return name.concat(' - ').concat(config.modelID.toString());\n  }\n\n  matIDNoConfig(modelID, material) {\n    let customId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n    let name = DEFAULT;\n    if (material) name = material.uuid;\n    name += ' - ' + customId;\n    return name.concat(' - ').concat(modelID.toString());\n  }\n\n}\n\nclass BasePropertyManager {\n  constructor(state) {\n    this.state = state;\n  }\n\n  async getPropertySets(modelID, elementID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return await this.getProperty(modelID, elementID, recursive, PropsNames.psets);\n  }\n\n  async getTypeProperties(modelID, elementID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return await this.getProperty(modelID, elementID, recursive, PropsNames.type);\n  }\n\n  async getMaterialsProperties(modelID, elementID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return await this.getProperty(modelID, elementID, recursive, PropsNames.materials);\n  }\n\n  async getSpatialNode(modelID, node, treeChunks, includeProperties) {\n    await this.getChildren(modelID, node, treeChunks, PropsNames.aggregates, includeProperties);\n    await this.getChildren(modelID, node, treeChunks, PropsNames.spatial, includeProperties);\n  }\n\n  async getChildren(modelID, node, treeChunks, propNames, includeProperties) {\n    const children = treeChunks[node.expressID];\n    if (children == undefined) return;\n    const prop = propNames.key;\n    const nodes = [];\n\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      let node = this.newNode(modelID, child);\n\n      if (includeProperties) {\n        const properties = await this.getItemProperties(modelID, node.expressID);\n        node = { ...properties,\n          ...node\n        };\n      }\n\n      await this.getSpatialNode(modelID, node, treeChunks, includeProperties);\n      nodes.push(node);\n    }\n\n    node[prop] = nodes;\n  }\n\n  newNode(modelID, id) {\n    const typeName = this.getNodeType(modelID, id);\n    return {\n      expressID: id,\n      type: typeName,\n      children: []\n    };\n  }\n\n  async getSpatialTreeChunks(modelID) {\n    const treeChunks = {};\n    await this.getChunks(modelID, treeChunks, PropsNames.aggregates);\n    await this.getChunks(modelID, treeChunks, PropsNames.spatial);\n    return treeChunks;\n  }\n\n  saveChunk(chunks, propNames, rel) {\n    const relating = rel[propNames.relating].value;\n    const related = rel[propNames.related].map(r => r.value);\n\n    if (chunks[relating] == undefined) {\n      chunks[relating] = related;\n    } else {\n      chunks[relating] = chunks[relating].concat(related);\n    }\n  }\n\n  getRelated(rel, propNames, IDs) {\n    const element = rel[propNames.relating];\n    if (!Array.isArray(element)) IDs.push(element.value);else element.forEach(ele => IDs.push(ele.value));\n  }\n\n  static isRelated(id, rel, propNames) {\n    const relatedItems = rel[propNames.related];\n\n    if (Array.isArray(relatedItems)) {\n      const values = relatedItems.map(item => item.value);\n      return values.includes(id);\n    }\n\n    return relatedItems.value === id;\n  }\n\n  static newIfcProject(id) {\n    return {\n      expressID: id,\n      type: 'IFCPROJECT',\n      children: []\n    };\n  }\n\n  async getProperty(modelID, elementID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    let propName = arguments.length > 3 ? arguments[3] : undefined;\n  }\n\n  async getChunks(modelID, chunks, propNames) {}\n\n  async getItemProperties(modelID, expressID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  }\n\n  getNodeType(modelID, id) {}\n\n}\n\nconst IfcElements = {\n  103090709: 'IFCPROJECT',\n  4097777520: 'IFCSITE',\n  4031249490: 'IFCBUILDING',\n  3124254112: 'IFCBUILDINGSTOREY',\n  3856911033: 'IFCSPACE',\n  1674181508: 'IFCANNOTATION',\n  25142252: 'IFCCONTROLLER',\n  32344328: 'IFCBOILER',\n  76236018: 'IFCLAMP',\n  90941305: 'IFCPUMP',\n  177149247: 'IFCAIRTERMINALBOX',\n  182646315: 'IFCFLOWINSTRUMENT',\n  263784265: 'IFCFURNISHINGELEMENT',\n  264262732: 'IFCELECTRICGENERATOR',\n  277319702: 'IFCAUDIOVISUALAPPLIANCE',\n  310824031: 'IFCPIPEFITTING',\n  331165859: 'IFCSTAIR',\n  342316401: 'IFCDUCTFITTING',\n  377706215: 'IFCMECHANICALFASTENER',\n  395920057: 'IFCDOOR',\n  402227799: 'IFCELECTRICMOTOR',\n  413509423: 'IFCSYSTEMFURNITUREELEMENT',\n  484807127: 'IFCEVAPORATOR',\n  486154966: 'IFCWINDOWSTANDARDCASE',\n  629592764: 'IFCLIGHTFIXTURE',\n  630975310: 'IFCUNITARYCONTROLELEMENT',\n  635142910: 'IFCCABLECARRIERFITTING',\n  639361253: 'IFCCOIL',\n  647756555: 'IFCFASTENER',\n  707683696: 'IFCFLOWSTORAGEDEVICE',\n  738039164: 'IFCPROTECTIVEDEVICE',\n  753842376: 'IFCBEAM',\n  812556717: 'IFCTANK',\n  819412036: 'IFCFILTER',\n  843113511: 'IFCCOLUMN',\n  862014818: 'IFCELECTRICDISTRIBUTIONBOARD',\n  900683007: 'IFCFOOTING',\n  905975707: 'IFCCOLUMNSTANDARDCASE',\n  926996030: 'IFCVOIDINGFEATURE',\n  979691226: 'IFCREINFORCINGBAR',\n  987401354: 'IFCFLOWSEGMENT',\n  1003880860: 'IFCELECTRICTIMECONTROL',\n  1051757585: 'IFCCABLEFITTING',\n  1052013943: 'IFCDISTRIBUTIONCHAMBERELEMENT',\n  1062813311: 'IFCDISTRIBUTIONCONTROLELEMENT',\n  1073191201: 'IFCMEMBER',\n  1095909175: 'IFCBUILDINGELEMENTPROXY',\n  1156407060: 'IFCPLATESTANDARDCASE',\n  1162798199: 'IFCSWITCHINGDEVICE',\n  1329646415: 'IFCSHADINGDEVICE',\n  1335981549: 'IFCDISCRETEACCESSORY',\n  1360408905: 'IFCDUCTSILENCER',\n  1404847402: 'IFCSTACKTERMINAL',\n  1426591983: 'IFCFIRESUPPRESSIONTERMINAL',\n  1437502449: 'IFCMEDICALDEVICE',\n  1509553395: 'IFCFURNITURE',\n  1529196076: 'IFCSLAB',\n  1620046519: 'IFCTRANSPORTELEMENT',\n  1634111441: 'IFCAIRTERMINAL',\n  1658829314: 'IFCENERGYCONVERSIONDEVICE',\n  1677625105: 'IFCCIVILELEMENT',\n  1687234759: 'IFCPILE',\n  1904799276: 'IFCELECTRICAPPLIANCE',\n  1911478936: 'IFCMEMBERSTANDARDCASE',\n  1945004755: 'IFCDISTRIBUTIONELEMENT',\n  1973544240: 'IFCCOVERING',\n  1999602285: 'IFCSPACEHEATER',\n  2016517767: 'IFCROOF',\n  2056796094: 'IFCAIRTOAIRHEATRECOVERY',\n  2058353004: 'IFCFLOWCONTROLLER',\n  2068733104: 'IFCHUMIDIFIER',\n  2176052936: 'IFCJUNCTIONBOX',\n  2188021234: 'IFCFLOWMETER',\n  2223149337: 'IFCFLOWTERMINAL',\n  2262370178: 'IFCRAILING',\n  2272882330: 'IFCCONDENSER',\n  2295281155: 'IFCPROTECTIVEDEVICETRIPPINGUNIT',\n  2320036040: 'IFCREINFORCINGMESH',\n  2347447852: 'IFCTENDONANCHOR',\n  2391383451: 'IFCVIBRATIONISOLATOR',\n  2391406946: 'IFCWALL',\n  2474470126: 'IFCMOTORCONNECTION',\n  2769231204: 'IFCVIRTUALELEMENT',\n  2814081492: 'IFCENGINE',\n  2906023776: 'IFCBEAMSTANDARDCASE',\n  2938176219: 'IFCBURNER',\n  2979338954: 'IFCBUILDINGELEMENTPART',\n  3024970846: 'IFCRAMP',\n  3026737570: 'IFCTUBEBUNDLE',\n  3027962421: 'IFCSLABSTANDARDCASE',\n  3040386961: 'IFCDISTRIBUTIONFLOWELEMENT',\n  3053780830: 'IFCSANITARYTERMINAL',\n  3079942009: 'IFCOPENINGSTANDARDCASE',\n  3087945054: 'IFCALARM',\n  3101698114: 'IFCSURFACEFEATURE',\n  3127900445: 'IFCSLABELEMENTEDCASE',\n  3132237377: 'IFCFLOWMOVINGDEVICE',\n  3171933400: 'IFCPLATE',\n  3221913625: 'IFCCOMMUNICATIONSAPPLIANCE',\n  3242481149: 'IFCDOORSTANDARDCASE',\n  3283111854: 'IFCRAMPFLIGHT',\n  3296154744: 'IFCCHIMNEY',\n  3304561284: 'IFCWINDOW',\n  3310460725: 'IFCELECTRICFLOWSTORAGEDEVICE',\n  3319311131: 'IFCHEATEXCHANGER',\n  3415622556: 'IFCFAN',\n  3420628829: 'IFCSOLARDEVICE',\n  3493046030: 'IFCGEOGRAPHICELEMENT',\n  3495092785: 'IFCCURTAINWALL',\n  3508470533: 'IFCFLOWTREATMENTDEVICE',\n  3512223829: 'IFCWALLSTANDARDCASE',\n  3518393246: 'IFCDUCTSEGMENT',\n  3571504051: 'IFCCOMPRESSOR',\n  3588315303: 'IFCOPENINGELEMENT',\n  3612865200: 'IFCPIPESEGMENT',\n  3640358203: 'IFCCOOLINGTOWER',\n  3651124850: 'IFCPROJECTIONELEMENT',\n  3694346114: 'IFCOUTLET',\n  3747195512: 'IFCEVAPORATIVECOOLER',\n  3758799889: 'IFCCABLECARRIERSEGMENT',\n  3824725483: 'IFCTENDON',\n  3825984169: 'IFCTRANSFORMER',\n  3902619387: 'IFCCHILLER',\n  4074379575: 'IFCDAMPER',\n  4086658281: 'IFCSENSOR',\n  4123344466: 'IFCELEMENTASSEMBLY',\n  4136498852: 'IFCCOOLEDBEAM',\n  4156078855: 'IFCWALLELEMENTEDCASE',\n  4175244083: 'IFCINTERCEPTOR',\n  4207607924: 'IFCVALVE',\n  4217484030: 'IFCCABLESEGMENT',\n  4237592921: 'IFCWASTETERMINAL',\n  4252922144: 'IFCSTAIRFLIGHT',\n  4278956645: 'IFCFLOWFITTING',\n  4288193352: 'IFCACTUATOR',\n  4292641817: 'IFCUNITARYEQUIPMENT',\n  3009204131: 'IFCGRID'\n};\n\nclass WebIfcPropertyManager extends BasePropertyManager {\n  async getItemProperties(modelID, id) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return this.state.api.GetLine(modelID, id, recursive);\n  }\n\n  async getSpatialStructure(modelID, includeProperties) {\n    const chunks = await this.getSpatialTreeChunks(modelID);\n    const allLines = await this.state.api.GetLineIDsWithType(modelID, IFCPROJECT);\n    const projectID = allLines.get(0);\n    const project = WebIfcPropertyManager.newIfcProject(projectID);\n    await this.getSpatialNode(modelID, project, chunks, includeProperties);\n    return project;\n  }\n\n  async getAllItemsOfType(modelID, type, verbose) {\n    let items = [];\n    const lines = await this.state.api.GetLineIDsWithType(modelID, type);\n\n    for (let i = 0; i < lines.size(); i++) items.push(lines.get(i));\n\n    if (!verbose) return items;\n    const result = [];\n\n    for (let i = 0; i < items.length; i++) {\n      result.push(await this.state.api.GetLine(modelID, items[i]));\n    }\n\n    return result;\n  }\n\n  async getProperty(modelID, elementID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    let propName = arguments.length > 3 ? arguments[3] : undefined;\n    const propSetIds = await this.getAllRelatedItemsOfType(modelID, elementID, propName);\n    const result = [];\n\n    for (let i = 0; i < propSetIds.length; i++) {\n      result.push(await this.state.api.GetLine(modelID, propSetIds[i], recursive));\n    }\n\n    return result;\n  }\n\n  getNodeType(modelID, id) {\n    const typeID = this.state.models[modelID].types[id];\n    return IfcElements[typeID];\n  }\n\n  async getChunks(modelID, chunks, propNames) {\n    const relation = await this.state.api.GetLineIDsWithType(modelID, propNames.name);\n\n    for (let i = 0; i < relation.size(); i++) {\n      const rel = await this.state.api.GetLine(modelID, relation.get(i), false);\n      this.saveChunk(chunks, propNames, rel);\n    }\n  }\n\n  async getAllRelatedItemsOfType(modelID, id, propNames) {\n    const lines = await this.state.api.GetLineIDsWithType(modelID, propNames.name);\n    const IDs = [];\n\n    for (let i = 0; i < lines.size(); i++) {\n      const rel = await this.state.api.GetLine(modelID, lines.get(i));\n      const isRelated = BasePropertyManager.isRelated(id, rel, propNames);\n      if (isRelated) this.getRelated(rel, propNames, IDs);\n    }\n\n    return IDs;\n  }\n\n}\n\nconst IfcTypesMap = {\n  3821786052: \"IFCACTIONREQUEST\",\n  2296667514: \"IFCACTOR\",\n  3630933823: \"IFCACTORROLE\",\n  4288193352: \"IFCACTUATOR\",\n  2874132201: \"IFCACTUATORTYPE\",\n  618182010: \"IFCADDRESS\",\n  1635779807: \"IFCADVANCEDBREP\",\n  2603310189: \"IFCADVANCEDBREPWITHVOIDS\",\n  3406155212: \"IFCADVANCEDFACE\",\n  1634111441: \"IFCAIRTERMINAL\",\n  177149247: \"IFCAIRTERMINALBOX\",\n  1411407467: \"IFCAIRTERMINALBOXTYPE\",\n  3352864051: \"IFCAIRTERMINALTYPE\",\n  2056796094: \"IFCAIRTOAIRHEATRECOVERY\",\n  1871374353: \"IFCAIRTOAIRHEATRECOVERYTYPE\",\n  3087945054: \"IFCALARM\",\n  3001207471: \"IFCALARMTYPE\",\n  325726236: \"IFCALIGNMENT\",\n  749761778: \"IFCALIGNMENT2DHORIZONTAL\",\n  3199563722: \"IFCALIGNMENT2DHORIZONTALSEGMENT\",\n  2483840362: \"IFCALIGNMENT2DSEGMENT\",\n  3379348081: \"IFCALIGNMENT2DVERSEGCIRCULARARC\",\n  3239324667: \"IFCALIGNMENT2DVERSEGLINE\",\n  4263986512: \"IFCALIGNMENT2DVERSEGPARABOLICARC\",\n  53199957: \"IFCALIGNMENT2DVERTICAL\",\n  2029264950: \"IFCALIGNMENT2DVERTICALSEGMENT\",\n  3512275521: \"IFCALIGNMENTCURVE\",\n  1674181508: \"IFCANNOTATION\",\n  669184980: \"IFCANNOTATIONFILLAREA\",\n  639542469: \"IFCAPPLICATION\",\n  411424972: \"IFCAPPLIEDVALUE\",\n  130549933: \"IFCAPPROVAL\",\n  3869604511: \"IFCAPPROVALRELATIONSHIP\",\n  3798115385: \"IFCARBITRARYCLOSEDPROFILEDEF\",\n  1310608509: \"IFCARBITRARYOPENPROFILEDEF\",\n  2705031697: \"IFCARBITRARYPROFILEDEFWITHVOIDS\",\n  3460190687: \"IFCASSET\",\n  3207858831: \"IFCASYMMETRICISHAPEPROFILEDEF\",\n  277319702: \"IFCAUDIOVISUALAPPLIANCE\",\n  1532957894: \"IFCAUDIOVISUALAPPLIANCETYPE\",\n  4261334040: \"IFCAXIS1PLACEMENT\",\n  3125803723: \"IFCAXIS2PLACEMENT2D\",\n  2740243338: \"IFCAXIS2PLACEMENT3D\",\n  1967976161: \"IFCBSPLINECURVE\",\n  2461110595: \"IFCBSPLINECURVEWITHKNOTS\",\n  2887950389: \"IFCBSPLINESURFACE\",\n  167062518: \"IFCBSPLINESURFACEWITHKNOTS\",\n  753842376: \"IFCBEAM\",\n  2906023776: \"IFCBEAMSTANDARDCASE\",\n  819618141: \"IFCBEAMTYPE\",\n  4196446775: \"IFCBEARING\",\n  3649138523: \"IFCBEARINGTYPE\",\n  616511568: \"IFCBLOBTEXTURE\",\n  1334484129: \"IFCBLOCK\",\n  32344328: \"IFCBOILER\",\n  231477066: \"IFCBOILERTYPE\",\n  3649129432: \"IFCBOOLEANCLIPPINGRESULT\",\n  2736907675: \"IFCBOOLEANRESULT\",\n  4037036970: \"IFCBOUNDARYCONDITION\",\n  1136057603: \"IFCBOUNDARYCURVE\",\n  1560379544: \"IFCBOUNDARYEDGECONDITION\",\n  3367102660: \"IFCBOUNDARYFACECONDITION\",\n  1387855156: \"IFCBOUNDARYNODECONDITION\",\n  2069777674: \"IFCBOUNDARYNODECONDITIONWARPING\",\n  1260505505: \"IFCBOUNDEDCURVE\",\n  4182860854: \"IFCBOUNDEDSURFACE\",\n  2581212453: \"IFCBOUNDINGBOX\",\n  2713105998: \"IFCBOXEDHALFSPACE\",\n  644574406: \"IFCBRIDGE\",\n  963979645: \"IFCBRIDGEPART\",\n  4031249490: \"IFCBUILDING\",\n  3299480353: \"IFCBUILDINGELEMENT\",\n  2979338954: \"IFCBUILDINGELEMENTPART\",\n  39481116: \"IFCBUILDINGELEMENTPARTTYPE\",\n  1095909175: \"IFCBUILDINGELEMENTPROXY\",\n  1909888760: \"IFCBUILDINGELEMENTPROXYTYPE\",\n  1950629157: \"IFCBUILDINGELEMENTTYPE\",\n  3124254112: \"IFCBUILDINGSTOREY\",\n  1177604601: \"IFCBUILDINGSYSTEM\",\n  2938176219: \"IFCBURNER\",\n  2188180465: \"IFCBURNERTYPE\",\n  2898889636: \"IFCCSHAPEPROFILEDEF\",\n  635142910: \"IFCCABLECARRIERFITTING\",\n  395041908: \"IFCCABLECARRIERFITTINGTYPE\",\n  3758799889: \"IFCCABLECARRIERSEGMENT\",\n  3293546465: \"IFCCABLECARRIERSEGMENTTYPE\",\n  1051757585: \"IFCCABLEFITTING\",\n  2674252688: \"IFCCABLEFITTINGTYPE\",\n  4217484030: \"IFCCABLESEGMENT\",\n  1285652485: \"IFCCABLESEGMENTTYPE\",\n  3999819293: \"IFCCAISSONFOUNDATION\",\n  3203706013: \"IFCCAISSONFOUNDATIONTYPE\",\n  1123145078: \"IFCCARTESIANPOINT\",\n  574549367: \"IFCCARTESIANPOINTLIST\",\n  1675464909: \"IFCCARTESIANPOINTLIST2D\",\n  2059837836: \"IFCCARTESIANPOINTLIST3D\",\n  59481748: \"IFCCARTESIANTRANSFORMATIONOPERATOR\",\n  3749851601: \"IFCCARTESIANTRANSFORMATIONOPERATOR2D\",\n  3486308946: \"IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM\",\n  3331915920: \"IFCCARTESIANTRANSFORMATIONOPERATOR3D\",\n  1416205885: \"IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM\",\n  3150382593: \"IFCCENTERLINEPROFILEDEF\",\n  3902619387: \"IFCCHILLER\",\n  2951183804: \"IFCCHILLERTYPE\",\n  3296154744: \"IFCCHIMNEY\",\n  2197970202: \"IFCCHIMNEYTYPE\",\n  2611217952: \"IFCCIRCLE\",\n  2937912522: \"IFCCIRCLEHOLLOWPROFILEDEF\",\n  1383045692: \"IFCCIRCLEPROFILEDEF\",\n  1062206242: \"IFCCIRCULARARCSEGMENT2D\",\n  1677625105: \"IFCCIVILELEMENT\",\n  3893394355: \"IFCCIVILELEMENTTYPE\",\n  747523909: \"IFCCLASSIFICATION\",\n  647927063: \"IFCCLASSIFICATIONREFERENCE\",\n  2205249479: \"IFCCLOSEDSHELL\",\n  639361253: \"IFCCOIL\",\n  2301859152: \"IFCCOILTYPE\",\n  776857604: \"IFCCOLOURRGB\",\n  3285139300: \"IFCCOLOURRGBLIST\",\n  3264961684: \"IFCCOLOURSPECIFICATION\",\n  843113511: \"IFCCOLUMN\",\n  905975707: \"IFCCOLUMNSTANDARDCASE\",\n  300633059: \"IFCCOLUMNTYPE\",\n  3221913625: \"IFCCOMMUNICATIONSAPPLIANCE\",\n  400855858: \"IFCCOMMUNICATIONSAPPLIANCETYPE\",\n  2542286263: \"IFCCOMPLEXPROPERTY\",\n  3875453745: \"IFCCOMPLEXPROPERTYTEMPLATE\",\n  3732776249: \"IFCCOMPOSITECURVE\",\n  15328376: \"IFCCOMPOSITECURVEONSURFACE\",\n  2485617015: \"IFCCOMPOSITECURVESEGMENT\",\n  1485152156: \"IFCCOMPOSITEPROFILEDEF\",\n  3571504051: \"IFCCOMPRESSOR\",\n  3850581409: \"IFCCOMPRESSORTYPE\",\n  2272882330: \"IFCCONDENSER\",\n  2816379211: \"IFCCONDENSERTYPE\",\n  2510884976: \"IFCCONIC\",\n  370225590: \"IFCCONNECTEDFACESET\",\n  1981873012: \"IFCCONNECTIONCURVEGEOMETRY\",\n  2859738748: \"IFCCONNECTIONGEOMETRY\",\n  45288368: \"IFCCONNECTIONPOINTECCENTRICITY\",\n  2614616156: \"IFCCONNECTIONPOINTGEOMETRY\",\n  2732653382: \"IFCCONNECTIONSURFACEGEOMETRY\",\n  775493141: \"IFCCONNECTIONVOLUMEGEOMETRY\",\n  1959218052: \"IFCCONSTRAINT\",\n  3898045240: \"IFCCONSTRUCTIONEQUIPMENTRESOURCE\",\n  2185764099: \"IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE\",\n  1060000209: \"IFCCONSTRUCTIONMATERIALRESOURCE\",\n  4105962743: \"IFCCONSTRUCTIONMATERIALRESOURCETYPE\",\n  488727124: \"IFCCONSTRUCTIONPRODUCTRESOURCE\",\n  1525564444: \"IFCCONSTRUCTIONPRODUCTRESOURCETYPE\",\n  2559216714: \"IFCCONSTRUCTIONRESOURCE\",\n  2574617495: \"IFCCONSTRUCTIONRESOURCETYPE\",\n  3419103109: \"IFCCONTEXT\",\n  3050246964: \"IFCCONTEXTDEPENDENTUNIT\",\n  3293443760: \"IFCCONTROL\",\n  25142252: \"IFCCONTROLLER\",\n  578613899: \"IFCCONTROLLERTYPE\",\n  2889183280: \"IFCCONVERSIONBASEDUNIT\",\n  2713554722: \"IFCCONVERSIONBASEDUNITWITHOFFSET\",\n  4136498852: \"IFCCOOLEDBEAM\",\n  335055490: \"IFCCOOLEDBEAMTYPE\",\n  3640358203: \"IFCCOOLINGTOWER\",\n  2954562838: \"IFCCOOLINGTOWERTYPE\",\n  1785450214: \"IFCCOORDINATEOPERATION\",\n  1466758467: \"IFCCOORDINATEREFERENCESYSTEM\",\n  3895139033: \"IFCCOSTITEM\",\n  1419761937: \"IFCCOSTSCHEDULE\",\n  602808272: \"IFCCOSTVALUE\",\n  1973544240: \"IFCCOVERING\",\n  1916426348: \"IFCCOVERINGTYPE\",\n  3295246426: \"IFCCREWRESOURCE\",\n  1815067380: \"IFCCREWRESOURCETYPE\",\n  2506170314: \"IFCCSGPRIMITIVE3D\",\n  2147822146: \"IFCCSGSOLID\",\n  539742890: \"IFCCURRENCYRELATIONSHIP\",\n  3495092785: \"IFCCURTAINWALL\",\n  1457835157: \"IFCCURTAINWALLTYPE\",\n  2601014836: \"IFCCURVE\",\n  2827736869: \"IFCCURVEBOUNDEDPLANE\",\n  2629017746: \"IFCCURVEBOUNDEDSURFACE\",\n  1186437898: \"IFCCURVESEGMENT2D\",\n  3800577675: \"IFCCURVESTYLE\",\n  1105321065: \"IFCCURVESTYLEFONT\",\n  2367409068: \"IFCCURVESTYLEFONTANDSCALING\",\n  3510044353: \"IFCCURVESTYLEFONTPATTERN\",\n  1213902940: \"IFCCYLINDRICALSURFACE\",\n  4074379575: \"IFCDAMPER\",\n  3961806047: \"IFCDAMPERTYPE\",\n  3426335179: \"IFCDEEPFOUNDATION\",\n  1306400036: \"IFCDEEPFOUNDATIONTYPE\",\n  3632507154: \"IFCDERIVEDPROFILEDEF\",\n  1765591967: \"IFCDERIVEDUNIT\",\n  1045800335: \"IFCDERIVEDUNITELEMENT\",\n  2949456006: \"IFCDIMENSIONALEXPONENTS\",\n  32440307: \"IFCDIRECTION\",\n  1335981549: \"IFCDISCRETEACCESSORY\",\n  2635815018: \"IFCDISCRETEACCESSORYTYPE\",\n  1945343521: \"IFCDISTANCEEXPRESSION\",\n  1052013943: \"IFCDISTRIBUTIONCHAMBERELEMENT\",\n  1599208980: \"IFCDISTRIBUTIONCHAMBERELEMENTTYPE\",\n  562808652: \"IFCDISTRIBUTIONCIRCUIT\",\n  1062813311: \"IFCDISTRIBUTIONCONTROLELEMENT\",\n  2063403501: \"IFCDISTRIBUTIONCONTROLELEMENTTYPE\",\n  1945004755: \"IFCDISTRIBUTIONELEMENT\",\n  3256556792: \"IFCDISTRIBUTIONELEMENTTYPE\",\n  3040386961: \"IFCDISTRIBUTIONFLOWELEMENT\",\n  3849074793: \"IFCDISTRIBUTIONFLOWELEMENTTYPE\",\n  3041715199: \"IFCDISTRIBUTIONPORT\",\n  3205830791: \"IFCDISTRIBUTIONSYSTEM\",\n  1154170062: \"IFCDOCUMENTINFORMATION\",\n  770865208: \"IFCDOCUMENTINFORMATIONRELATIONSHIP\",\n  3732053477: \"IFCDOCUMENTREFERENCE\",\n  395920057: \"IFCDOOR\",\n  2963535650: \"IFCDOORLININGPROPERTIES\",\n  1714330368: \"IFCDOORPANELPROPERTIES\",\n  3242481149: \"IFCDOORSTANDARDCASE\",\n  526551008: \"IFCDOORSTYLE\",\n  2323601079: \"IFCDOORTYPE\",\n  445594917: \"IFCDRAUGHTINGPREDEFINEDCOLOUR\",\n  4006246654: \"IFCDRAUGHTINGPREDEFINEDCURVEFONT\",\n  342316401: \"IFCDUCTFITTING\",\n  869906466: \"IFCDUCTFITTINGTYPE\",\n  3518393246: \"IFCDUCTSEGMENT\",\n  3760055223: \"IFCDUCTSEGMENTTYPE\",\n  1360408905: \"IFCDUCTSILENCER\",\n  2030761528: \"IFCDUCTSILENCERTYPE\",\n  3900360178: \"IFCEDGE\",\n  476780140: \"IFCEDGECURVE\",\n  1472233963: \"IFCEDGELOOP\",\n  1904799276: \"IFCELECTRICAPPLIANCE\",\n  663422040: \"IFCELECTRICAPPLIANCETYPE\",\n  862014818: \"IFCELECTRICDISTRIBUTIONBOARD\",\n  2417008758: \"IFCELECTRICDISTRIBUTIONBOARDTYPE\",\n  3310460725: \"IFCELECTRICFLOWSTORAGEDEVICE\",\n  3277789161: \"IFCELECTRICFLOWSTORAGEDEVICETYPE\",\n  264262732: \"IFCELECTRICGENERATOR\",\n  1534661035: \"IFCELECTRICGENERATORTYPE\",\n  402227799: \"IFCELECTRICMOTOR\",\n  1217240411: \"IFCELECTRICMOTORTYPE\",\n  1003880860: \"IFCELECTRICTIMECONTROL\",\n  712377611: \"IFCELECTRICTIMECONTROLTYPE\",\n  1758889154: \"IFCELEMENT\",\n  4123344466: \"IFCELEMENTASSEMBLY\",\n  2397081782: \"IFCELEMENTASSEMBLYTYPE\",\n  1623761950: \"IFCELEMENTCOMPONENT\",\n  2590856083: \"IFCELEMENTCOMPONENTTYPE\",\n  1883228015: \"IFCELEMENTQUANTITY\",\n  339256511: \"IFCELEMENTTYPE\",\n  2777663545: \"IFCELEMENTARYSURFACE\",\n  1704287377: \"IFCELLIPSE\",\n  2835456948: \"IFCELLIPSEPROFILEDEF\",\n  1658829314: \"IFCENERGYCONVERSIONDEVICE\",\n  2107101300: \"IFCENERGYCONVERSIONDEVICETYPE\",\n  2814081492: \"IFCENGINE\",\n  132023988: \"IFCENGINETYPE\",\n  3747195512: \"IFCEVAPORATIVECOOLER\",\n  3174744832: \"IFCEVAPORATIVECOOLERTYPE\",\n  484807127: \"IFCEVAPORATOR\",\n  3390157468: \"IFCEVAPORATORTYPE\",\n  4148101412: \"IFCEVENT\",\n  211053100: \"IFCEVENTTIME\",\n  4024345920: \"IFCEVENTTYPE\",\n  297599258: \"IFCEXTENDEDPROPERTIES\",\n  4294318154: \"IFCEXTERNALINFORMATION\",\n  3200245327: \"IFCEXTERNALREFERENCE\",\n  1437805879: \"IFCEXTERNALREFERENCERELATIONSHIP\",\n  1209101575: \"IFCEXTERNALSPATIALELEMENT\",\n  2853485674: \"IFCEXTERNALSPATIALSTRUCTUREELEMENT\",\n  2242383968: \"IFCEXTERNALLYDEFINEDHATCHSTYLE\",\n  1040185647: \"IFCEXTERNALLYDEFINEDSURFACESTYLE\",\n  3548104201: \"IFCEXTERNALLYDEFINEDTEXTFONT\",\n  477187591: \"IFCEXTRUDEDAREASOLID\",\n  2804161546: \"IFCEXTRUDEDAREASOLIDTAPERED\",\n  2556980723: \"IFCFACE\",\n  2047409740: \"IFCFACEBASEDSURFACEMODEL\",\n  1809719519: \"IFCFACEBOUND\",\n  803316827: \"IFCFACEOUTERBOUND\",\n  3008276851: \"IFCFACESURFACE\",\n  807026263: \"IFCFACETEDBREP\",\n  3737207727: \"IFCFACETEDBREPWITHVOIDS\",\n  24185140: \"IFCFACILITY\",\n  1310830890: \"IFCFACILITYPART\",\n  4219587988: \"IFCFAILURECONNECTIONCONDITION\",\n  3415622556: \"IFCFAN\",\n  346874300: \"IFCFANTYPE\",\n  647756555: \"IFCFASTENER\",\n  2489546625: \"IFCFASTENERTYPE\",\n  2827207264: \"IFCFEATUREELEMENT\",\n  2143335405: \"IFCFEATUREELEMENTADDITION\",\n  1287392070: \"IFCFEATUREELEMENTSUBTRACTION\",\n  738692330: \"IFCFILLAREASTYLE\",\n  374418227: \"IFCFILLAREASTYLEHATCHING\",\n  315944413: \"IFCFILLAREASTYLETILES\",\n  819412036: \"IFCFILTER\",\n  1810631287: \"IFCFILTERTYPE\",\n  1426591983: \"IFCFIRESUPPRESSIONTERMINAL\",\n  4222183408: \"IFCFIRESUPPRESSIONTERMINALTYPE\",\n  2652556860: \"IFCFIXEDREFERENCESWEPTAREASOLID\",\n  2058353004: \"IFCFLOWCONTROLLER\",\n  3907093117: \"IFCFLOWCONTROLLERTYPE\",\n  4278956645: \"IFCFLOWFITTING\",\n  3198132628: \"IFCFLOWFITTINGTYPE\",\n  182646315: \"IFCFLOWINSTRUMENT\",\n  4037862832: \"IFCFLOWINSTRUMENTTYPE\",\n  2188021234: \"IFCFLOWMETER\",\n  3815607619: \"IFCFLOWMETERTYPE\",\n  3132237377: \"IFCFLOWMOVINGDEVICE\",\n  1482959167: \"IFCFLOWMOVINGDEVICETYPE\",\n  987401354: \"IFCFLOWSEGMENT\",\n  1834744321: \"IFCFLOWSEGMENTTYPE\",\n  707683696: \"IFCFLOWSTORAGEDEVICE\",\n  1339347760: \"IFCFLOWSTORAGEDEVICETYPE\",\n  2223149337: \"IFCFLOWTERMINAL\",\n  2297155007: \"IFCFLOWTERMINALTYPE\",\n  3508470533: \"IFCFLOWTREATMENTDEVICE\",\n  3009222698: \"IFCFLOWTREATMENTDEVICETYPE\",\n  900683007: \"IFCFOOTING\",\n  1893162501: \"IFCFOOTINGTYPE\",\n  263784265: \"IFCFURNISHINGELEMENT\",\n  4238390223: \"IFCFURNISHINGELEMENTTYPE\",\n  1509553395: \"IFCFURNITURE\",\n  1268542332: \"IFCFURNITURETYPE\",\n  3493046030: \"IFCGEOGRAPHICELEMENT\",\n  4095422895: \"IFCGEOGRAPHICELEMENTTYPE\",\n  987898635: \"IFCGEOMETRICCURVESET\",\n  3448662350: \"IFCGEOMETRICREPRESENTATIONCONTEXT\",\n  2453401579: \"IFCGEOMETRICREPRESENTATIONITEM\",\n  4142052618: \"IFCGEOMETRICREPRESENTATIONSUBCONTEXT\",\n  3590301190: \"IFCGEOMETRICSET\",\n  3009204131: \"IFCGRID\",\n  852622518: \"IFCGRIDAXIS\",\n  178086475: \"IFCGRIDPLACEMENT\",\n  2706460486: \"IFCGROUP\",\n  812098782: \"IFCHALFSPACESOLID\",\n  3319311131: \"IFCHEATEXCHANGER\",\n  1251058090: \"IFCHEATEXCHANGERTYPE\",\n  2068733104: \"IFCHUMIDIFIER\",\n  1806887404: \"IFCHUMIDIFIERTYPE\",\n  1484403080: \"IFCISHAPEPROFILEDEF\",\n  3905492369: \"IFCIMAGETEXTURE\",\n  3570813810: \"IFCINDEXEDCOLOURMAP\",\n  2571569899: \"IFCINDEXEDPOLYCURVE\",\n  178912537: \"IFCINDEXEDPOLYGONALFACE\",\n  2294589976: \"IFCINDEXEDPOLYGONALFACEWITHVOIDS\",\n  1437953363: \"IFCINDEXEDTEXTUREMAP\",\n  2133299955: \"IFCINDEXEDTRIANGLETEXTUREMAP\",\n  4175244083: \"IFCINTERCEPTOR\",\n  3946677679: \"IFCINTERCEPTORTYPE\",\n  3113134337: \"IFCINTERSECTIONCURVE\",\n  2391368822: \"IFCINVENTORY\",\n  3741457305: \"IFCIRREGULARTIMESERIES\",\n  3020489413: \"IFCIRREGULARTIMESERIESVALUE\",\n  2176052936: \"IFCJUNCTIONBOX\",\n  4288270099: \"IFCJUNCTIONBOXTYPE\",\n  572779678: \"IFCLSHAPEPROFILEDEF\",\n  3827777499: \"IFCLABORRESOURCE\",\n  428585644: \"IFCLABORRESOURCETYPE\",\n  1585845231: \"IFCLAGTIME\",\n  76236018: \"IFCLAMP\",\n  1051575348: \"IFCLAMPTYPE\",\n  2655187982: \"IFCLIBRARYINFORMATION\",\n  3452421091: \"IFCLIBRARYREFERENCE\",\n  4162380809: \"IFCLIGHTDISTRIBUTIONDATA\",\n  629592764: \"IFCLIGHTFIXTURE\",\n  1161773419: \"IFCLIGHTFIXTURETYPE\",\n  1566485204: \"IFCLIGHTINTENSITYDISTRIBUTION\",\n  1402838566: \"IFCLIGHTSOURCE\",\n  125510826: \"IFCLIGHTSOURCEAMBIENT\",\n  2604431987: \"IFCLIGHTSOURCEDIRECTIONAL\",\n  4266656042: \"IFCLIGHTSOURCEGONIOMETRIC\",\n  1520743889: \"IFCLIGHTSOURCEPOSITIONAL\",\n  3422422726: \"IFCLIGHTSOURCESPOT\",\n  1281925730: \"IFCLINE\",\n  3092502836: \"IFCLINESEGMENT2D\",\n  388784114: \"IFCLINEARPLACEMENT\",\n  1154579445: \"IFCLINEARPOSITIONINGELEMENT\",\n  2624227202: \"IFCLOCALPLACEMENT\",\n  1008929658: \"IFCLOOP\",\n  1425443689: \"IFCMANIFOLDSOLIDBREP\",\n  3057273783: \"IFCMAPCONVERSION\",\n  2347385850: \"IFCMAPPEDITEM\",\n  1838606355: \"IFCMATERIAL\",\n  1847130766: \"IFCMATERIALCLASSIFICATIONRELATIONSHIP\",\n  3708119000: \"IFCMATERIALCONSTITUENT\",\n  2852063980: \"IFCMATERIALCONSTITUENTSET\",\n  760658860: \"IFCMATERIALDEFINITION\",\n  2022407955: \"IFCMATERIALDEFINITIONREPRESENTATION\",\n  248100487: \"IFCMATERIALLAYER\",\n  3303938423: \"IFCMATERIALLAYERSET\",\n  1303795690: \"IFCMATERIALLAYERSETUSAGE\",\n  1847252529: \"IFCMATERIALLAYERWITHOFFSETS\",\n  2199411900: \"IFCMATERIALLIST\",\n  2235152071: \"IFCMATERIALPROFILE\",\n  164193824: \"IFCMATERIALPROFILESET\",\n  3079605661: \"IFCMATERIALPROFILESETUSAGE\",\n  3404854881: \"IFCMATERIALPROFILESETUSAGETAPERING\",\n  552965576: \"IFCMATERIALPROFILEWITHOFFSETS\",\n  3265635763: \"IFCMATERIALPROPERTIES\",\n  853536259: \"IFCMATERIALRELATIONSHIP\",\n  1507914824: \"IFCMATERIALUSAGEDEFINITION\",\n  2597039031: \"IFCMEASUREWITHUNIT\",\n  377706215: \"IFCMECHANICALFASTENER\",\n  2108223431: \"IFCMECHANICALFASTENERTYPE\",\n  1437502449: \"IFCMEDICALDEVICE\",\n  1114901282: \"IFCMEDICALDEVICETYPE\",\n  1073191201: \"IFCMEMBER\",\n  1911478936: \"IFCMEMBERSTANDARDCASE\",\n  3181161470: \"IFCMEMBERTYPE\",\n  3368373690: \"IFCMETRIC\",\n  2998442950: \"IFCMIRROREDPROFILEDEF\",\n  2706619895: \"IFCMONETARYUNIT\",\n  2474470126: \"IFCMOTORCONNECTION\",\n  977012517: \"IFCMOTORCONNECTIONTYPE\",\n  1918398963: \"IFCNAMEDUNIT\",\n  3888040117: \"IFCOBJECT\",\n  219451334: \"IFCOBJECTDEFINITION\",\n  3701648758: \"IFCOBJECTPLACEMENT\",\n  2251480897: \"IFCOBJECTIVE\",\n  4143007308: \"IFCOCCUPANT\",\n  590820931: \"IFCOFFSETCURVE\",\n  3388369263: \"IFCOFFSETCURVE2D\",\n  3505215534: \"IFCOFFSETCURVE3D\",\n  2485787929: \"IFCOFFSETCURVEBYDISTANCES\",\n  2665983363: \"IFCOPENSHELL\",\n  3588315303: \"IFCOPENINGELEMENT\",\n  3079942009: \"IFCOPENINGSTANDARDCASE\",\n  4251960020: \"IFCORGANIZATION\",\n  1411181986: \"IFCORGANIZATIONRELATIONSHIP\",\n  643959842: \"IFCORIENTATIONEXPRESSION\",\n  1029017970: \"IFCORIENTEDEDGE\",\n  144952367: \"IFCOUTERBOUNDARYCURVE\",\n  3694346114: \"IFCOUTLET\",\n  2837617999: \"IFCOUTLETTYPE\",\n  1207048766: \"IFCOWNERHISTORY\",\n  2529465313: \"IFCPARAMETERIZEDPROFILEDEF\",\n  2519244187: \"IFCPATH\",\n  1682466193: \"IFCPCURVE\",\n  2382730787: \"IFCPERFORMANCEHISTORY\",\n  3566463478: \"IFCPERMEABLECOVERINGPROPERTIES\",\n  3327091369: \"IFCPERMIT\",\n  2077209135: \"IFCPERSON\",\n  101040310: \"IFCPERSONANDORGANIZATION\",\n  3021840470: \"IFCPHYSICALCOMPLEXQUANTITY\",\n  2483315170: \"IFCPHYSICALQUANTITY\",\n  2226359599: \"IFCPHYSICALSIMPLEQUANTITY\",\n  1687234759: \"IFCPILE\",\n  1158309216: \"IFCPILETYPE\",\n  310824031: \"IFCPIPEFITTING\",\n  804291784: \"IFCPIPEFITTINGTYPE\",\n  3612865200: \"IFCPIPESEGMENT\",\n  4231323485: \"IFCPIPESEGMENTTYPE\",\n  597895409: \"IFCPIXELTEXTURE\",\n  2004835150: \"IFCPLACEMENT\",\n  603570806: \"IFCPLANARBOX\",\n  1663979128: \"IFCPLANAREXTENT\",\n  220341763: \"IFCPLANE\",\n  3171933400: \"IFCPLATE\",\n  1156407060: \"IFCPLATESTANDARDCASE\",\n  4017108033: \"IFCPLATETYPE\",\n  2067069095: \"IFCPOINT\",\n  4022376103: \"IFCPOINTONCURVE\",\n  1423911732: \"IFCPOINTONSURFACE\",\n  2924175390: \"IFCPOLYLOOP\",\n  2775532180: \"IFCPOLYGONALBOUNDEDHALFSPACE\",\n  2839578677: \"IFCPOLYGONALFACESET\",\n  3724593414: \"IFCPOLYLINE\",\n  3740093272: \"IFCPORT\",\n  1946335990: \"IFCPOSITIONINGELEMENT\",\n  3355820592: \"IFCPOSTALADDRESS\",\n  759155922: \"IFCPREDEFINEDCOLOUR\",\n  2559016684: \"IFCPREDEFINEDCURVEFONT\",\n  3727388367: \"IFCPREDEFINEDITEM\",\n  3778827333: \"IFCPREDEFINEDPROPERTIES\",\n  3967405729: \"IFCPREDEFINEDPROPERTYSET\",\n  1775413392: \"IFCPREDEFINEDTEXTFONT\",\n  677532197: \"IFCPRESENTATIONITEM\",\n  2022622350: \"IFCPRESENTATIONLAYERASSIGNMENT\",\n  1304840413: \"IFCPRESENTATIONLAYERWITHSTYLE\",\n  3119450353: \"IFCPRESENTATIONSTYLE\",\n  2417041796: \"IFCPRESENTATIONSTYLEASSIGNMENT\",\n  2744685151: \"IFCPROCEDURE\",\n  569719735: \"IFCPROCEDURETYPE\",\n  2945172077: \"IFCPROCESS\",\n  4208778838: \"IFCPRODUCT\",\n  673634403: \"IFCPRODUCTDEFINITIONSHAPE\",\n  2095639259: \"IFCPRODUCTREPRESENTATION\",\n  3958567839: \"IFCPROFILEDEF\",\n  2802850158: \"IFCPROFILEPROPERTIES\",\n  103090709: \"IFCPROJECT\",\n  653396225: \"IFCPROJECTLIBRARY\",\n  2904328755: \"IFCPROJECTORDER\",\n  3843373140: \"IFCPROJECTEDCRS\",\n  3651124850: \"IFCPROJECTIONELEMENT\",\n  2598011224: \"IFCPROPERTY\",\n  986844984: \"IFCPROPERTYABSTRACTION\",\n  871118103: \"IFCPROPERTYBOUNDEDVALUE\",\n  1680319473: \"IFCPROPERTYDEFINITION\",\n  148025276: \"IFCPROPERTYDEPENDENCYRELATIONSHIP\",\n  4166981789: \"IFCPROPERTYENUMERATEDVALUE\",\n  3710013099: \"IFCPROPERTYENUMERATION\",\n  2752243245: \"IFCPROPERTYLISTVALUE\",\n  941946838: \"IFCPROPERTYREFERENCEVALUE\",\n  1451395588: \"IFCPROPERTYSET\",\n  3357820518: \"IFCPROPERTYSETDEFINITION\",\n  492091185: \"IFCPROPERTYSETTEMPLATE\",\n  3650150729: \"IFCPROPERTYSINGLEVALUE\",\n  110355661: \"IFCPROPERTYTABLEVALUE\",\n  3521284610: \"IFCPROPERTYTEMPLATE\",\n  1482703590: \"IFCPROPERTYTEMPLATEDEFINITION\",\n  738039164: \"IFCPROTECTIVEDEVICE\",\n  2295281155: \"IFCPROTECTIVEDEVICETRIPPINGUNIT\",\n  655969474: \"IFCPROTECTIVEDEVICETRIPPINGUNITTYPE\",\n  1842657554: \"IFCPROTECTIVEDEVICETYPE\",\n  3219374653: \"IFCPROXY\",\n  90941305: \"IFCPUMP\",\n  2250791053: \"IFCPUMPTYPE\",\n  2044713172: \"IFCQUANTITYAREA\",\n  2093928680: \"IFCQUANTITYCOUNT\",\n  931644368: \"IFCQUANTITYLENGTH\",\n  2090586900: \"IFCQUANTITYSET\",\n  3252649465: \"IFCQUANTITYTIME\",\n  2405470396: \"IFCQUANTITYVOLUME\",\n  825690147: \"IFCQUANTITYWEIGHT\",\n  2262370178: \"IFCRAILING\",\n  2893384427: \"IFCRAILINGTYPE\",\n  3024970846: \"IFCRAMP\",\n  3283111854: \"IFCRAMPFLIGHT\",\n  2324767716: \"IFCRAMPFLIGHTTYPE\",\n  1469900589: \"IFCRAMPTYPE\",\n  1232101972: \"IFCRATIONALBSPLINECURVEWITHKNOTS\",\n  683857671: \"IFCRATIONALBSPLINESURFACEWITHKNOTS\",\n  2770003689: \"IFCRECTANGLEHOLLOWPROFILEDEF\",\n  3615266464: \"IFCRECTANGLEPROFILEDEF\",\n  2798486643: \"IFCRECTANGULARPYRAMID\",\n  3454111270: \"IFCRECTANGULARTRIMMEDSURFACE\",\n  3915482550: \"IFCRECURRENCEPATTERN\",\n  2433181523: \"IFCREFERENCE\",\n  4021432810: \"IFCREFERENT\",\n  3413951693: \"IFCREGULARTIMESERIES\",\n  1580146022: \"IFCREINFORCEMENTBARPROPERTIES\",\n  3765753017: \"IFCREINFORCEMENTDEFINITIONPROPERTIES\",\n  979691226: \"IFCREINFORCINGBAR\",\n  2572171363: \"IFCREINFORCINGBARTYPE\",\n  3027567501: \"IFCREINFORCINGELEMENT\",\n  964333572: \"IFCREINFORCINGELEMENTTYPE\",\n  2320036040: \"IFCREINFORCINGMESH\",\n  2310774935: \"IFCREINFORCINGMESHTYPE\",\n  160246688: \"IFCRELAGGREGATES\",\n  3939117080: \"IFCRELASSIGNS\",\n  1683148259: \"IFCRELASSIGNSTOACTOR\",\n  2495723537: \"IFCRELASSIGNSTOCONTROL\",\n  1307041759: \"IFCRELASSIGNSTOGROUP\",\n  1027710054: \"IFCRELASSIGNSTOGROUPBYFACTOR\",\n  4278684876: \"IFCRELASSIGNSTOPROCESS\",\n  2857406711: \"IFCRELASSIGNSTOPRODUCT\",\n  205026976: \"IFCRELASSIGNSTORESOURCE\",\n  1865459582: \"IFCRELASSOCIATES\",\n  4095574036: \"IFCRELASSOCIATESAPPROVAL\",\n  919958153: \"IFCRELASSOCIATESCLASSIFICATION\",\n  2728634034: \"IFCRELASSOCIATESCONSTRAINT\",\n  982818633: \"IFCRELASSOCIATESDOCUMENT\",\n  3840914261: \"IFCRELASSOCIATESLIBRARY\",\n  2655215786: \"IFCRELASSOCIATESMATERIAL\",\n  826625072: \"IFCRELCONNECTS\",\n  1204542856: \"IFCRELCONNECTSELEMENTS\",\n  3945020480: \"IFCRELCONNECTSPATHELEMENTS\",\n  4201705270: \"IFCRELCONNECTSPORTTOELEMENT\",\n  3190031847: \"IFCRELCONNECTSPORTS\",\n  2127690289: \"IFCRELCONNECTSSTRUCTURALACTIVITY\",\n  1638771189: \"IFCRELCONNECTSSTRUCTURALMEMBER\",\n  504942748: \"IFCRELCONNECTSWITHECCENTRICITY\",\n  3678494232: \"IFCRELCONNECTSWITHREALIZINGELEMENTS\",\n  3242617779: \"IFCRELCONTAINEDINSPATIALSTRUCTURE\",\n  886880790: \"IFCRELCOVERSBLDGELEMENTS\",\n  2802773753: \"IFCRELCOVERSSPACES\",\n  2565941209: \"IFCRELDECLARES\",\n  2551354335: \"IFCRELDECOMPOSES\",\n  693640335: \"IFCRELDEFINES\",\n  1462361463: \"IFCRELDEFINESBYOBJECT\",\n  4186316022: \"IFCRELDEFINESBYPROPERTIES\",\n  307848117: \"IFCRELDEFINESBYTEMPLATE\",\n  781010003: \"IFCRELDEFINESBYTYPE\",\n  3940055652: \"IFCRELFILLSELEMENT\",\n  279856033: \"IFCRELFLOWCONTROLELEMENTS\",\n  427948657: \"IFCRELINTERFERESELEMENTS\",\n  3268803585: \"IFCRELNESTS\",\n  1441486842: \"IFCRELPOSITIONS\",\n  750771296: \"IFCRELPROJECTSELEMENT\",\n  1245217292: \"IFCRELREFERENCEDINSPATIALSTRUCTURE\",\n  4122056220: \"IFCRELSEQUENCE\",\n  366585022: \"IFCRELSERVICESBUILDINGS\",\n  3451746338: \"IFCRELSPACEBOUNDARY\",\n  3523091289: \"IFCRELSPACEBOUNDARY1STLEVEL\",\n  1521410863: \"IFCRELSPACEBOUNDARY2NDLEVEL\",\n  1401173127: \"IFCRELVOIDSELEMENT\",\n  478536968: \"IFCRELATIONSHIP\",\n  816062949: \"IFCREPARAMETRISEDCOMPOSITECURVESEGMENT\",\n  1076942058: \"IFCREPRESENTATION\",\n  3377609919: \"IFCREPRESENTATIONCONTEXT\",\n  3008791417: \"IFCREPRESENTATIONITEM\",\n  1660063152: \"IFCREPRESENTATIONMAP\",\n  2914609552: \"IFCRESOURCE\",\n  2943643501: \"IFCRESOURCEAPPROVALRELATIONSHIP\",\n  1608871552: \"IFCRESOURCECONSTRAINTRELATIONSHIP\",\n  2439245199: \"IFCRESOURCELEVELRELATIONSHIP\",\n  1042787934: \"IFCRESOURCETIME\",\n  1856042241: \"IFCREVOLVEDAREASOLID\",\n  3243963512: \"IFCREVOLVEDAREASOLIDTAPERED\",\n  4158566097: \"IFCRIGHTCIRCULARCONE\",\n  3626867408: \"IFCRIGHTCIRCULARCYLINDER\",\n  2016517767: \"IFCROOF\",\n  2781568857: \"IFCROOFTYPE\",\n  2341007311: \"IFCROOT\",\n  2778083089: \"IFCROUNDEDRECTANGLEPROFILEDEF\",\n  448429030: \"IFCSIUNIT\",\n  3053780830: \"IFCSANITARYTERMINAL\",\n  1768891740: \"IFCSANITARYTERMINALTYPE\",\n  1054537805: \"IFCSCHEDULINGTIME\",\n  2157484638: \"IFCSEAMCURVE\",\n  2042790032: \"IFCSECTIONPROPERTIES\",\n  4165799628: \"IFCSECTIONREINFORCEMENTPROPERTIES\",\n  1862484736: \"IFCSECTIONEDSOLID\",\n  1290935644: \"IFCSECTIONEDSOLIDHORIZONTAL\",\n  1509187699: \"IFCSECTIONEDSPINE\",\n  4086658281: \"IFCSENSOR\",\n  1783015770: \"IFCSENSORTYPE\",\n  1329646415: \"IFCSHADINGDEVICE\",\n  4074543187: \"IFCSHADINGDEVICETYPE\",\n  867548509: \"IFCSHAPEASPECT\",\n  3982875396: \"IFCSHAPEMODEL\",\n  4240577450: \"IFCSHAPEREPRESENTATION\",\n  4124623270: \"IFCSHELLBASEDSURFACEMODEL\",\n  3692461612: \"IFCSIMPLEPROPERTY\",\n  3663146110: \"IFCSIMPLEPROPERTYTEMPLATE\",\n  4097777520: \"IFCSITE\",\n  1529196076: \"IFCSLAB\",\n  3127900445: \"IFCSLABELEMENTEDCASE\",\n  3027962421: \"IFCSLABSTANDARDCASE\",\n  2533589738: \"IFCSLABTYPE\",\n  2609359061: \"IFCSLIPPAGECONNECTIONCONDITION\",\n  3420628829: \"IFCSOLARDEVICE\",\n  1072016465: \"IFCSOLARDEVICETYPE\",\n  723233188: \"IFCSOLIDMODEL\",\n  3856911033: \"IFCSPACE\",\n  1999602285: \"IFCSPACEHEATER\",\n  1305183839: \"IFCSPACEHEATERTYPE\",\n  3812236995: \"IFCSPACETYPE\",\n  1412071761: \"IFCSPATIALELEMENT\",\n  710998568: \"IFCSPATIALELEMENTTYPE\",\n  2706606064: \"IFCSPATIALSTRUCTUREELEMENT\",\n  3893378262: \"IFCSPATIALSTRUCTUREELEMENTTYPE\",\n  463610769: \"IFCSPATIALZONE\",\n  2481509218: \"IFCSPATIALZONETYPE\",\n  451544542: \"IFCSPHERE\",\n  4015995234: \"IFCSPHERICALSURFACE\",\n  1404847402: \"IFCSTACKTERMINAL\",\n  3112655638: \"IFCSTACKTERMINALTYPE\",\n  331165859: \"IFCSTAIR\",\n  4252922144: \"IFCSTAIRFLIGHT\",\n  1039846685: \"IFCSTAIRFLIGHTTYPE\",\n  338393293: \"IFCSTAIRTYPE\",\n  682877961: \"IFCSTRUCTURALACTION\",\n  3544373492: \"IFCSTRUCTURALACTIVITY\",\n  2515109513: \"IFCSTRUCTURALANALYSISMODEL\",\n  1179482911: \"IFCSTRUCTURALCONNECTION\",\n  2273995522: \"IFCSTRUCTURALCONNECTIONCONDITION\",\n  1004757350: \"IFCSTRUCTURALCURVEACTION\",\n  4243806635: \"IFCSTRUCTURALCURVECONNECTION\",\n  214636428: \"IFCSTRUCTURALCURVEMEMBER\",\n  2445595289: \"IFCSTRUCTURALCURVEMEMBERVARYING\",\n  2757150158: \"IFCSTRUCTURALCURVEREACTION\",\n  3136571912: \"IFCSTRUCTURALITEM\",\n  1807405624: \"IFCSTRUCTURALLINEARACTION\",\n  2162789131: \"IFCSTRUCTURALLOAD\",\n  385403989: \"IFCSTRUCTURALLOADCASE\",\n  3478079324: \"IFCSTRUCTURALLOADCONFIGURATION\",\n  1252848954: \"IFCSTRUCTURALLOADGROUP\",\n  1595516126: \"IFCSTRUCTURALLOADLINEARFORCE\",\n  609421318: \"IFCSTRUCTURALLOADORRESULT\",\n  2668620305: \"IFCSTRUCTURALLOADPLANARFORCE\",\n  2473145415: \"IFCSTRUCTURALLOADSINGLEDISPLACEMENT\",\n  1973038258: \"IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION\",\n  1597423693: \"IFCSTRUCTURALLOADSINGLEFORCE\",\n  1190533807: \"IFCSTRUCTURALLOADSINGLEFORCEWARPING\",\n  2525727697: \"IFCSTRUCTURALLOADSTATIC\",\n  3408363356: \"IFCSTRUCTURALLOADTEMPERATURE\",\n  530289379: \"IFCSTRUCTURALMEMBER\",\n  1621171031: \"IFCSTRUCTURALPLANARACTION\",\n  2082059205: \"IFCSTRUCTURALPOINTACTION\",\n  734778138: \"IFCSTRUCTURALPOINTCONNECTION\",\n  1235345126: \"IFCSTRUCTURALPOINTREACTION\",\n  3689010777: \"IFCSTRUCTURALREACTION\",\n  2986769608: \"IFCSTRUCTURALRESULTGROUP\",\n  3657597509: \"IFCSTRUCTURALSURFACEACTION\",\n  1975003073: \"IFCSTRUCTURALSURFACECONNECTION\",\n  3979015343: \"IFCSTRUCTURALSURFACEMEMBER\",\n  2218152070: \"IFCSTRUCTURALSURFACEMEMBERVARYING\",\n  603775116: \"IFCSTRUCTURALSURFACEREACTION\",\n  2830218821: \"IFCSTYLEMODEL\",\n  3958052878: \"IFCSTYLEDITEM\",\n  3049322572: \"IFCSTYLEDREPRESENTATION\",\n  148013059: \"IFCSUBCONTRACTRESOURCE\",\n  4095615324: \"IFCSUBCONTRACTRESOURCETYPE\",\n  2233826070: \"IFCSUBEDGE\",\n  2513912981: \"IFCSURFACE\",\n  699246055: \"IFCSURFACECURVE\",\n  2028607225: \"IFCSURFACECURVESWEPTAREASOLID\",\n  3101698114: \"IFCSURFACEFEATURE\",\n  2809605785: \"IFCSURFACEOFLINEAREXTRUSION\",\n  4124788165: \"IFCSURFACEOFREVOLUTION\",\n  2934153892: \"IFCSURFACEREINFORCEMENTAREA\",\n  1300840506: \"IFCSURFACESTYLE\",\n  3303107099: \"IFCSURFACESTYLELIGHTING\",\n  1607154358: \"IFCSURFACESTYLEREFRACTION\",\n  1878645084: \"IFCSURFACESTYLERENDERING\",\n  846575682: \"IFCSURFACESTYLESHADING\",\n  1351298697: \"IFCSURFACESTYLEWITHTEXTURES\",\n  626085974: \"IFCSURFACETEXTURE\",\n  2247615214: \"IFCSWEPTAREASOLID\",\n  1260650574: \"IFCSWEPTDISKSOLID\",\n  1096409881: \"IFCSWEPTDISKSOLIDPOLYGONAL\",\n  230924584: \"IFCSWEPTSURFACE\",\n  1162798199: \"IFCSWITCHINGDEVICE\",\n  2315554128: \"IFCSWITCHINGDEVICETYPE\",\n  2254336722: \"IFCSYSTEM\",\n  413509423: \"IFCSYSTEMFURNITUREELEMENT\",\n  1580310250: \"IFCSYSTEMFURNITUREELEMENTTYPE\",\n  3071757647: \"IFCTSHAPEPROFILEDEF\",\n  985171141: \"IFCTABLE\",\n  2043862942: \"IFCTABLECOLUMN\",\n  531007025: \"IFCTABLEROW\",\n  812556717: \"IFCTANK\",\n  5716631: \"IFCTANKTYPE\",\n  3473067441: \"IFCTASK\",\n  1549132990: \"IFCTASKTIME\",\n  2771591690: \"IFCTASKTIMERECURRING\",\n  3206491090: \"IFCTASKTYPE\",\n  912023232: \"IFCTELECOMADDRESS\",\n  3824725483: \"IFCTENDON\",\n  2347447852: \"IFCTENDONANCHOR\",\n  3081323446: \"IFCTENDONANCHORTYPE\",\n  3663046924: \"IFCTENDONCONDUIT\",\n  2281632017: \"IFCTENDONCONDUITTYPE\",\n  2415094496: \"IFCTENDONTYPE\",\n  2387106220: \"IFCTESSELLATEDFACESET\",\n  901063453: \"IFCTESSELLATEDITEM\",\n  4282788508: \"IFCTEXTLITERAL\",\n  3124975700: \"IFCTEXTLITERALWITHEXTENT\",\n  1447204868: \"IFCTEXTSTYLE\",\n  1983826977: \"IFCTEXTSTYLEFONTMODEL\",\n  2636378356: \"IFCTEXTSTYLEFORDEFINEDFONT\",\n  1640371178: \"IFCTEXTSTYLETEXTMODEL\",\n  280115917: \"IFCTEXTURECOORDINATE\",\n  1742049831: \"IFCTEXTURECOORDINATEGENERATOR\",\n  2552916305: \"IFCTEXTUREMAP\",\n  1210645708: \"IFCTEXTUREVERTEX\",\n  3611470254: \"IFCTEXTUREVERTEXLIST\",\n  1199560280: \"IFCTIMEPERIOD\",\n  3101149627: \"IFCTIMESERIES\",\n  581633288: \"IFCTIMESERIESVALUE\",\n  1377556343: \"IFCTOPOLOGICALREPRESENTATIONITEM\",\n  1735638870: \"IFCTOPOLOGYREPRESENTATION\",\n  1935646853: \"IFCTOROIDALSURFACE\",\n  3825984169: \"IFCTRANSFORMER\",\n  1692211062: \"IFCTRANSFORMERTYPE\",\n  2595432518: \"IFCTRANSITIONCURVESEGMENT2D\",\n  1620046519: \"IFCTRANSPORTELEMENT\",\n  2097647324: \"IFCTRANSPORTELEMENTTYPE\",\n  2715220739: \"IFCTRAPEZIUMPROFILEDEF\",\n  2916149573: \"IFCTRIANGULATEDFACESET\",\n  1229763772: \"IFCTRIANGULATEDIRREGULARNETWORK\",\n  3593883385: \"IFCTRIMMEDCURVE\",\n  3026737570: \"IFCTUBEBUNDLE\",\n  1600972822: \"IFCTUBEBUNDLETYPE\",\n  1628702193: \"IFCTYPEOBJECT\",\n  3736923433: \"IFCTYPEPROCESS\",\n  2347495698: \"IFCTYPEPRODUCT\",\n  3698973494: \"IFCTYPERESOURCE\",\n  427810014: \"IFCUSHAPEPROFILEDEF\",\n  180925521: \"IFCUNITASSIGNMENT\",\n  630975310: \"IFCUNITARYCONTROLELEMENT\",\n  3179687236: \"IFCUNITARYCONTROLELEMENTTYPE\",\n  4292641817: \"IFCUNITARYEQUIPMENT\",\n  1911125066: \"IFCUNITARYEQUIPMENTTYPE\",\n  4207607924: \"IFCVALVE\",\n  728799441: \"IFCVALVETYPE\",\n  1417489154: \"IFCVECTOR\",\n  2799835756: \"IFCVERTEX\",\n  2759199220: \"IFCVERTEXLOOP\",\n  1907098498: \"IFCVERTEXPOINT\",\n  1530820697: \"IFCVIBRATIONDAMPER\",\n  3956297820: \"IFCVIBRATIONDAMPERTYPE\",\n  2391383451: \"IFCVIBRATIONISOLATOR\",\n  3313531582: \"IFCVIBRATIONISOLATORTYPE\",\n  2769231204: \"IFCVIRTUALELEMENT\",\n  891718957: \"IFCVIRTUALGRIDINTERSECTION\",\n  926996030: \"IFCVOIDINGFEATURE\",\n  2391406946: \"IFCWALL\",\n  4156078855: \"IFCWALLELEMENTEDCASE\",\n  3512223829: \"IFCWALLSTANDARDCASE\",\n  1898987631: \"IFCWALLTYPE\",\n  4237592921: \"IFCWASTETERMINAL\",\n  1133259667: \"IFCWASTETERMINALTYPE\",\n  3304561284: \"IFCWINDOW\",\n  336235671: \"IFCWINDOWLININGPROPERTIES\",\n  512836454: \"IFCWINDOWPANELPROPERTIES\",\n  486154966: \"IFCWINDOWSTANDARDCASE\",\n  1299126871: \"IFCWINDOWSTYLE\",\n  4009809668: \"IFCWINDOWTYPE\",\n  4088093105: \"IFCWORKCALENDAR\",\n  1028945134: \"IFCWORKCONTROL\",\n  4218914973: \"IFCWORKPLAN\",\n  3342526732: \"IFCWORKSCHEDULE\",\n  1236880293: \"IFCWORKTIME\",\n  2543172580: \"IFCZSHAPEPROFILEDEF\",\n  1033361043: \"IFCZONE\"\n};\n\nclass JSONPropertyManager extends BasePropertyManager {\n  async getItemProperties(modelID, id) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return { ...this.state.models[modelID].jsonData[id]\n    };\n  }\n\n  async getSpatialStructure(modelID, includeProperties) {\n    const chunks = await this.getSpatialTreeChunks(modelID);\n    const projectsIDs = await this.getAllItemsOfType(modelID, IFCPROJECT, false);\n    const projectID = projectsIDs[0];\n    const project = JSONPropertyManager.newIfcProject(projectID);\n    await this.getSpatialNode(modelID, project, chunks, includeProperties);\n    return { ...project\n    };\n  }\n\n  async getAllItemsOfType(modelID, type, verbose) {\n    const data = this.state.models[modelID].jsonData;\n    const typeName = IfcTypesMap[type];\n\n    if (!typeName) {\n      throw new Error(`Type not found: ${type}`);\n    }\n\n    return this.filterItemsByType(data, typeName, verbose);\n  }\n\n  async getProperty(modelID, elementID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    let propName = arguments.length > 3 ? arguments[3] : undefined;\n    const resultIDs = await this.getAllRelatedItemsOfType(modelID, elementID, propName);\n    const result = this.getItemsByID(modelID, resultIDs);\n\n    if (recursive) {\n      result.forEach(result => this.getReferencesRecursively(modelID, result));\n    }\n\n    return result;\n  }\n\n  getNodeType(modelID, id) {\n    return this.state.models[modelID].jsonData[id].type;\n  }\n\n  async getChunks(modelID, chunks, propNames) {\n    const relation = await this.getAllItemsOfType(modelID, propNames.name, true);\n    relation.forEach(rel => {\n      this.saveChunk(chunks, propNames, rel);\n    });\n  }\n\n  filterItemsByType(data, typeName, verbose) {\n    const result = [];\n    Object.keys(data).forEach(key => {\n      const numKey = parseInt(key);\n\n      if (data[numKey].type.toUpperCase() === typeName) {\n        result.push(verbose ? { ...data[numKey]\n        } : numKey);\n      }\n    });\n    return result;\n  }\n\n  async getAllRelatedItemsOfType(modelID, id, propNames) {\n    const lines = await this.getAllItemsOfType(modelID, propNames.name, true);\n    const IDs = [];\n    lines.forEach(line => {\n      const isRelated = JSONPropertyManager.isRelated(id, line, propNames);\n      if (isRelated) this.getRelated(line, propNames, IDs);\n    });\n    return IDs;\n  }\n\n  getItemsByID(modelID, ids) {\n    const data = this.state.models[modelID].jsonData;\n    const result = [];\n    ids.forEach(id => result.push({ ...data[id]\n    }));\n    return result;\n  }\n\n  getReferencesRecursively(modelID, jsonObject) {\n    if (jsonObject == undefined) return;\n    const keys = Object.keys(jsonObject);\n\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      this.getJSONItem(modelID, jsonObject, key);\n    }\n  }\n\n  getJSONItem(modelID, jsonObject, key) {\n    if (Array.isArray(jsonObject[key])) {\n      return this.getMultipleJSONItems(modelID, jsonObject, key);\n    }\n\n    if (jsonObject[key] && jsonObject[key].type === 5) {\n      jsonObject[key] = this.getItemsByID(modelID, [jsonObject[key].value])[0];\n      this.getReferencesRecursively(modelID, jsonObject[key]);\n    }\n  }\n\n  getMultipleJSONItems(modelID, jsonObject, key) {\n    jsonObject[key] = jsonObject[key].map(item => {\n      if (item.type === 5) {\n        item = this.getItemsByID(modelID, [item.value])[0];\n        this.getReferencesRecursively(modelID, item);\n      }\n\n      return item;\n    });\n  }\n\n}\n\nclass PropertyManager {\n  constructor(state) {\n    this.state = state;\n    this.webIfcProps = new WebIfcPropertyManager(state);\n    this.jsonProps = new JSONPropertyManager(state);\n    this.currentProps = this.webIfcProps;\n  }\n\n  getExpressId(geometry, faceIndex) {\n    if (!geometry.index) throw new Error('Geometry does not have index information.');\n    const geoIndex = geometry.index.array;\n    return geometry.attributes[IdAttrName].getX(geoIndex[3 * faceIndex]);\n  }\n\n  async getItemProperties(modelID, elementID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    this.updateCurrentProps();\n    return this.currentProps.getItemProperties(modelID, elementID, recursive);\n  }\n\n  async getAllItemsOfType(modelID, type, verbose) {\n    this.updateCurrentProps();\n    return this.currentProps.getAllItemsOfType(modelID, type, verbose);\n  }\n\n  async getPropertySets(modelID, elementID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    this.updateCurrentProps();\n    return this.currentProps.getPropertySets(modelID, elementID, recursive);\n  }\n\n  async getTypeProperties(modelID, elementID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    this.updateCurrentProps();\n    return this.currentProps.getTypeProperties(modelID, elementID, recursive);\n  }\n\n  async getMaterialsProperties(modelID, elementID) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    this.updateCurrentProps();\n    return this.currentProps.getMaterialsProperties(modelID, elementID, recursive);\n  }\n\n  async getSpatialStructure(modelID, includeProperties) {\n    this.updateCurrentProps();\n\n    if (!this.state.useJSON && includeProperties) {\n      console.warn('Including properties in getSpatialStructure with the JSON workflow disabled can lead to poor performance.');\n    }\n\n    return await this.currentProps.getSpatialStructure(modelID, includeProperties);\n  }\n\n  updateCurrentProps() {\n    this.currentProps = this.state.useJSON ? this.jsonProps : this.webIfcProps;\n  }\n\n}\n\nclass TypeManager {\n  constructor(state) {\n    this.state = state;\n    this.state = state;\n  }\n\n  async getAllTypes(worker) {\n    for (let modelID in this.state.models) {\n      const types = this.state.models[modelID].types;\n\n      if (Object.keys(types).length == 0) {\n        await this.getAllTypesOfModel(parseInt(modelID), worker);\n      }\n    }\n  }\n\n  async getAllTypesOfModel(modelID, worker) {\n    const result = {};\n    const elements = Object.keys(IfcElements).map(e => parseInt(e));\n\n    for (let i = 0; i < elements.length; i++) {\n      const element = elements[i];\n      const lines = await this.state.api.GetLineIDsWithType(modelID, element);\n      const size = lines.size();\n\n      for (let i = 0; i < size; i++) result[lines.get(i)] = element;\n    }\n\n    if (this.state.worker.active && worker) {\n      await worker.workerState.updateModelStateTypes(modelID, result);\n    } else {\n      this.state.models[modelID].types = result;\n    }\n  }\n\n}\n\nclass BvhManager {\n  initializeMeshBVH(computeBoundsTree, disposeBoundsTree, acceleratedRaycast) {\n    this.computeBoundsTree = computeBoundsTree;\n    this.disposeBoundsTree = disposeBoundsTree;\n    this.acceleratedRaycast = acceleratedRaycast;\n    this.setupThreeMeshBVH();\n  }\n\n  applyThreeMeshBVH(geometry) {\n    if (this.computeBoundsTree) geometry.computeBoundsTree();\n  }\n\n  setupThreeMeshBVH() {\n    if (!this.computeBoundsTree || !this.disposeBoundsTree || !this.acceleratedRaycast) return;\n    BufferGeometry.prototype.computeBoundsTree = this.computeBoundsTree;\n    BufferGeometry.prototype.disposeBoundsTree = this.disposeBoundsTree;\n    Mesh.prototype.raycast = this.acceleratedRaycast;\n  }\n\n}\n\nclass ItemsHider {\n  constructor(state) {\n    this.modelCoordinates = {};\n    this.expressIDCoordinatesMap = {};\n    this.state = state;\n  }\n\n  dispose() {\n    this.modelCoordinates = {};\n    this.expressIDCoordinatesMap = {};\n  }\n\n  processCoordinates(modelID) {\n    const attributes = this.getAttributes(modelID);\n    const ids = Array.from(attributes.expressID.array);\n    this.expressIDCoordinatesMap[modelID] = {};\n\n    for (let i = 0; i < ids.length; i++) {\n      if (!this.expressIDCoordinatesMap[modelID][ids[i]]) {\n        this.expressIDCoordinatesMap[modelID][ids[i]] = [];\n      }\n\n      const current = this.expressIDCoordinatesMap[modelID];\n      current[ids[i]].push(3 * i);\n    }\n\n    this.initializeCoordinates(modelID);\n  }\n\n  hideItems(modelID, ids) {\n    this.editCoordinates(modelID, ids, true);\n  }\n\n  showItems(modelID, ids) {\n    this.editCoordinates(modelID, ids, false);\n  }\n\n  editCoordinates(modelID, ids, hide) {\n    const current = this.expressIDCoordinatesMap[modelID];\n    const indices = [];\n    ids.forEach(id => {\n      if (current[id]) {\n        for (let i = 0; i < current[id].length; i++) {\n          indices.push(current[id][i]);\n        }\n      }\n    });\n    const coords = this.getCoordinates(modelID);\n    const initial = this.modelCoordinates[modelID];\n    if (hide) indices.forEach(i => coords.set([0, 0, 0], i));else indices.forEach(i => coords.set([initial[i], initial[i + 1], initial[i + 2]], i));\n    this.getAttributes(modelID).position.needsUpdate = true;\n  }\n\n  showAllItems(modelID) {\n    if (this.modelCoordinates[modelID]) {\n      this.resetCoordinates(modelID);\n      this.getAttributes(modelID).position.needsUpdate = true;\n    }\n  }\n\n  hideAllItems(modelID) {\n    this.getCoordinates(modelID).fill(0);\n    this.getAttributes(modelID).position.needsUpdate = true;\n  }\n\n  initializeCoordinates(modelID) {\n    const coordinates = this.getCoordinates(modelID);\n\n    if (!this.modelCoordinates[modelID]) {\n      this.modelCoordinates[modelID] = new Float32Array(coordinates);\n    }\n  }\n\n  resetCoordinates(modelID) {\n    const initial = this.modelCoordinates[modelID];\n    this.getCoordinates(modelID).set(initial);\n  }\n\n  getCoordinates(modelID) {\n    return this.getAttributes(modelID).position.array;\n  }\n\n  getAttributes(modelID) {\n    return this.state.models[modelID].mesh.geometry.attributes;\n  }\n\n}\n\nclass MemoryCleaner {\n  constructor(state) {\n    this.state = state;\n  }\n\n  releaseAllModels() {\n    const models = Object.values(this.state.models);\n    models.forEach(model => {\n      this.releaseMeshModelMemory(model);\n      this.releaseJSONMemory(model);\n      this.releaseGeometryByMaterials(model);\n      model.types = null;\n    });\n  }\n\n  releaseGeometryByMaterials(model) {\n    const keys = Object.keys(model.items);\n    keys.forEach(key => {\n      const geomsByMat = model.items[key];\n      geomsByMat.material.dispose();\n      geomsByMat.material = null;\n      Object.values(geomsByMat.geometries).forEach(geom => geom.dispose());\n      geomsByMat.geometries = null;\n    });\n    model.items = null;\n  }\n\n  releaseJSONMemory(model) {\n    const keys = Object.keys(model.jsonData);\n    keys.forEach(key => delete model.jsonData[parseInt(key)]);\n    model.jsonData = null;\n  }\n\n  releaseMeshModelMemory(model) {\n    this.releaseMeshMemory(model.mesh);\n    model.mesh = null;\n  }\n\n  releaseMeshMemory(mesh) {\n    if (mesh.geometry) {\n      mesh.geometry.dispose();\n    }\n\n    if (mesh.parent) {\n      mesh.parent.remove(mesh);\n    }\n\n    if (mesh.material) {\n      Array.isArray(mesh.material) ? mesh.material.forEach(mat => mat.dispose()) : mesh.material.dispose();\n    }\n\n    if (mesh.children.length > 0) {\n      mesh.children.forEach(child => {\n        if (child.type === \"Mesh\") this.releaseMeshMemory(child);\n        mesh.remove(child);\n      });\n    }\n  }\n\n}\n\nvar WorkerActions;\n\n(function (WorkerActions) {\n  WorkerActions[\"updateStateUseJson\"] = \"updateStateUseJson\";\n  WorkerActions[\"updateStateWebIfcSettings\"] = \"updateStateWebIfcSettings\";\n  WorkerActions[\"updateModelStateTypes\"] = \"updateModelStateTypes\";\n  WorkerActions[\"updateModelStateJsonData\"] = \"updateModelStateJsonData\";\n  WorkerActions[\"loadJsonDataFromWorker\"] = \"loadJsonDataFromWorker\";\n  WorkerActions[\"Close\"] = \"Close\";\n  WorkerActions[\"Init\"] = \"Init\";\n  WorkerActions[\"OpenModel\"] = \"OpenModel\";\n  WorkerActions[\"CreateModel\"] = \"CreateModel\";\n  WorkerActions[\"ExportFileAsIFC\"] = \"ExportFileAsIFC\";\n  WorkerActions[\"GetGeometry\"] = \"GetGeometry\";\n  WorkerActions[\"GetLine\"] = \"GetLine\";\n  WorkerActions[\"GetAndClearErrors\"] = \"GetAndClearErrors\";\n  WorkerActions[\"WriteLine\"] = \"WriteLine\";\n  WorkerActions[\"FlattenLine\"] = \"FlattenLine\";\n  WorkerActions[\"GetRawLineData\"] = \"GetRawLineData\";\n  WorkerActions[\"WriteRawLineData\"] = \"WriteRawLineData\";\n  WorkerActions[\"GetLineIDsWithType\"] = \"GetLineIDsWithType\";\n  WorkerActions[\"GetAllLines\"] = \"GetAllLines\";\n  WorkerActions[\"SetGeometryTransformation\"] = \"SetGeometryTransformation\";\n  WorkerActions[\"GetCoordinationMatrix\"] = \"GetCoordinationMatrix\";\n  WorkerActions[\"GetVertexArray\"] = \"GetVertexArray\";\n  WorkerActions[\"GetIndexArray\"] = \"GetIndexArray\";\n  WorkerActions[\"getSubArray\"] = \"getSubArray\";\n  WorkerActions[\"CloseModel\"] = \"CloseModel\";\n  WorkerActions[\"StreamAllMeshes\"] = \"StreamAllMeshes\";\n  WorkerActions[\"StreamAllMeshesWithTypes\"] = \"StreamAllMeshesWithTypes\";\n  WorkerActions[\"IsModelOpen\"] = \"IsModelOpen\";\n  WorkerActions[\"LoadAllGeometry\"] = \"LoadAllGeometry\";\n  WorkerActions[\"GetFlatMesh\"] = \"GetFlatMesh\";\n  WorkerActions[\"SetWasmPath\"] = \"SetWasmPath\";\n  WorkerActions[\"parse\"] = \"parse\";\n  WorkerActions[\"setupOptionalCategories\"] = \"setupOptionalCategories\";\n  WorkerActions[\"getExpressId\"] = \"getExpressId\";\n  WorkerActions[\"initializeProperties\"] = \"initializeProperties\";\n  WorkerActions[\"getAllItemsOfType\"] = \"getAllItemsOfType\";\n  WorkerActions[\"getItemProperties\"] = \"getItemProperties\";\n  WorkerActions[\"getMaterialsProperties\"] = \"getMaterialsProperties\";\n  WorkerActions[\"getPropertySets\"] = \"getPropertySets\";\n  WorkerActions[\"getSpatialStructure\"] = \"getSpatialStructure\";\n  WorkerActions[\"getTypeProperties\"] = \"getTypeProperties\";\n})(WorkerActions || (WorkerActions = {}));\n\nvar WorkerAPIs;\n\n(function (WorkerAPIs) {\n  WorkerAPIs[\"workerState\"] = \"workerState\";\n  WorkerAPIs[\"webIfc\"] = \"webIfc\";\n  WorkerAPIs[\"properties\"] = \"properties\";\n  WorkerAPIs[\"parser\"] = \"parser\";\n})(WorkerAPIs || (WorkerAPIs = {}));\n\nclass Vector {\n  constructor(vector) {\n    this._data = {};\n    this._size = vector.size;\n    const keys = Object.keys(vector).filter(key => key.indexOf('size') === -1).map(key => parseInt(key));\n    keys.forEach(key => this._data[key] = vector[key]);\n  }\n\n  size() {\n    return this._size;\n  }\n\n  get(index) {\n    return this._data[index];\n  }\n\n}\n\nclass IfcGeometry {\n  constructor(vector) {\n    this._GetVertexData = vector.GetVertexData;\n    this._GetVertexDataSize = vector.GetVertexDataSize;\n    this._GetIndexData = vector.GetIndexData;\n    this._GetIndexDataSize = vector.GetIndexDataSize;\n  }\n\n  GetVertexData() {\n    return this._GetVertexData;\n  }\n\n  GetVertexDataSize() {\n    return this._GetVertexDataSize;\n  }\n\n  GetIndexData() {\n    return this._GetIndexData;\n  }\n\n  GetIndexDataSize() {\n    return this._GetIndexDataSize;\n  }\n\n}\n\nclass FlatMesh {\n  constructor(serializer, flatMesh) {\n    this.expressID = flatMesh.expressID;\n    this.geometries = serializer.reconstructVector(flatMesh.geometries);\n  }\n\n}\n\nclass FlatMeshVector {\n  constructor(serializer, vector) {\n    this._data = {};\n    this._size = vector.size;\n    const keys = Object.keys(vector).filter(key => key.indexOf('size') === -1).map(key => parseInt(key));\n    keys.forEach(key => this._data[key] = serializer.reconstructFlatMesh(vector[key]));\n  }\n\n  size() {\n    return this._size;\n  }\n\n  get(index) {\n    return this._data[index];\n  }\n\n}\n\nclass SerializedMaterial {\n  constructor(material) {\n    this.color = [material.color.r, material.color.g, material.color.b];\n    this.opacity = material.opacity;\n    this.transparent = material.transparent;\n  }\n\n}\n\nclass MaterialReconstructor {\n  static new(material) {\n    return new MeshLambertMaterial({\n      color: new Color(material.color[0], material.color[1], material.color[2]),\n      opacity: material.opacity,\n      transparent: material.transparent\n    });\n  }\n\n}\n\nclass SerializedGeometry {\n  constructor(geometry) {\n    var _a, _b, _c, _d;\n\n    this.position = ((_a = geometry.attributes.position) === null || _a === void 0 ? void 0 : _a.array) || [];\n    this.normal = ((_b = geometry.attributes.normal) === null || _b === void 0 ? void 0 : _b.array) || [];\n    this.expressID = ((_c = geometry.attributes.expressID) === null || _c === void 0 ? void 0 : _c.array) || [];\n    this.index = ((_d = geometry.index) === null || _d === void 0 ? void 0 : _d.array) || [];\n    this.groups = geometry.groups;\n  }\n\n}\n\nclass GeometryReconstructor {\n  static new(serialized) {\n    const geom = new BufferGeometry();\n    GeometryReconstructor.set(geom, 'expressID', new Uint32Array(serialized.expressID), 1);\n    GeometryReconstructor.set(geom, 'position', new Float32Array(serialized.position), 3);\n    GeometryReconstructor.set(geom, 'normal', new Float32Array(serialized.normal), 3);\n    geom.setIndex(Array.from(serialized.index));\n    geom.groups = serialized.groups;\n    return geom;\n  }\n\n  static set(geom, name, data, size) {\n    if (data.length > 0) {\n      geom.setAttribute(name, new BufferAttribute(data, size));\n    }\n  }\n\n}\n\nclass SerializedMesh {\n  constructor(model) {\n    this.materials = [];\n    this.modelID = model.modelID;\n    this.geometry = new SerializedGeometry(model.geometry);\n\n    if (Array.isArray(model.material)) {\n      model.material.forEach(mat => {\n        this.materials.push(new SerializedMaterial(mat));\n      });\n    } else {\n      this.materials.push(new SerializedMaterial(model.material));\n    }\n  }\n\n}\n\nclass MeshReconstructor {\n  static new(serialized) {\n    const model = new IFCModel();\n    model.modelID = serialized.modelID;\n    model.geometry = GeometryReconstructor.new(serialized.geometry);\n    MeshReconstructor.getMaterials(serialized, model);\n    return model;\n  }\n\n  static getMaterials(serialized, model) {\n    model.material = [];\n    const mats = model.material;\n    serialized.materials.forEach(mat => {\n      mats.push(MaterialReconstructor.new(mat));\n    });\n  }\n\n}\n\nclass SerializedGeomsByMaterials {\n  constructor(geoms) {\n    const matIDs = Object.keys(geoms);\n    matIDs.forEach(id => {\n      this[id] = {};\n      this[id].material = new SerializedMaterial(geoms[id].material);\n      this[id].geometries = {};\n      const expressIDs = Object.keys(geoms[id].geometries).map(key => parseInt(key));\n      expressIDs.forEach(expressID => {\n        this[id].geometries[expressID] = new SerializedGeometry(geoms[id].geometries[expressID]);\n      });\n    });\n  }\n\n}\n\nclass GeomsByMaterialsReconstructor {\n  static new(serialized) {\n    const geomsByMat = {};\n    const matIDs = Object.keys(serialized);\n    matIDs.forEach(id => {\n      geomsByMat[id] = {};\n      geomsByMat[id].material = MaterialReconstructor.new(serialized[id].material);\n      geomsByMat[id].geometries = {};\n      const expressIDs = Object.keys(serialized[id].geometries).map(id => parseInt(id));\n      expressIDs.forEach(expressID => {\n        geomsByMat[id].geometries[expressID] = GeometryReconstructor.new(serialized[id].geometries[expressID]);\n      });\n    });\n    return geomsByMat;\n  }\n\n}\n\nclass Serializer {\n  serializeVector(vector) {\n    const size = vector.size();\n    const serialized = {\n      size\n    };\n\n    for (let i = 0; i < size; i++) {\n      serialized[i] = vector.get(i);\n    }\n\n    return serialized;\n  }\n\n  reconstructVector(vector) {\n    return new Vector(vector);\n  }\n\n  serializeIfcGeometry(geometry) {\n    const GetVertexData = geometry.GetVertexData();\n    const GetVertexDataSize = geometry.GetVertexDataSize();\n    const GetIndexData = geometry.GetIndexData();\n    const GetIndexDataSize = geometry.GetIndexDataSize();\n    return {\n      GetVertexData,\n      GetVertexDataSize,\n      GetIndexData,\n      GetIndexDataSize\n    };\n  }\n\n  reconstructIfcGeometry(geometry) {\n    return new IfcGeometry(geometry);\n  }\n\n  serializeFlatMesh(flatMesh) {\n    return {\n      expressID: flatMesh.expressID,\n      geometries: this.serializeVector(flatMesh.geometries)\n    };\n  }\n\n  reconstructFlatMesh(flatMesh) {\n    return new FlatMesh(this, flatMesh);\n  }\n\n  serializeFlatMeshVector(vector) {\n    const size = vector.size();\n    const serialized = {\n      size\n    };\n\n    for (let i = 0; i < size; i++) {\n      const flatMesh = vector.get(i);\n      serialized[i] = this.serializeFlatMesh(flatMesh);\n    }\n\n    return serialized;\n  }\n\n  reconstructFlatMeshVector(vector) {\n    return new FlatMeshVector(this, vector);\n  }\n\n  serializeIfcModel(model) {\n    return new SerializedMesh(model);\n  }\n\n  reconstructIfcModel(model) {\n    return MeshReconstructor.new(model);\n  }\n\n  serializeGeometriesByMaterials(geoms) {\n    return new SerializedGeomsByMaterials(geoms);\n  }\n\n  reconstructGeometriesByMaterials(geoms) {\n    return GeomsByMaterialsReconstructor.new(geoms);\n  }\n\n}\n\nclass PropertyHandler {\n  constructor(handler) {\n    this.handler = handler;\n    this.API = WorkerAPIs.properties;\n  }\n\n  getExpressId(geometry, faceIndex) {\n    if (!geometry.index) throw new Error('Geometry does not have index information.');\n    const geoIndex = geometry.index.array;\n    return geometry.attributes[IdAttrName].getX(geoIndex[3 * faceIndex]);\n  }\n\n  getAllItemsOfType(modelID, type, verbose) {\n    return this.handler.request(this.API, WorkerActions.getAllItemsOfType, {\n      modelID,\n      type,\n      verbose\n    });\n  }\n\n  getItemProperties(modelID, elementID, recursive) {\n    return this.handler.request(this.API, WorkerActions.getItemProperties, {\n      modelID,\n      elementID,\n      recursive\n    });\n  }\n\n  getMaterialsProperties(modelID, elementID, recursive) {\n    return this.handler.request(this.API, WorkerActions.getMaterialsProperties, {\n      modelID,\n      elementID,\n      recursive\n    });\n  }\n\n  getPropertySets(modelID, elementID, recursive) {\n    return this.handler.request(this.API, WorkerActions.getPropertySets, {\n      modelID,\n      elementID,\n      recursive\n    });\n  }\n\n  getTypeProperties(modelID, elementID, recursive) {\n    return this.handler.request(this.API, WorkerActions.getTypeProperties, {\n      modelID,\n      elementID,\n      recursive\n    });\n  }\n\n  getSpatialStructure(modelID, includeProperties) {\n    return this.handler.request(this.API, WorkerActions.getSpatialStructure, {\n      modelID,\n      includeProperties\n    });\n  }\n\n}\n\nclass WebIfcHandler {\n  constructor(handler, serializer) {\n    this.handler = handler;\n    this.serializer = serializer;\n    this.API = WorkerAPIs.webIfc;\n  }\n\n  async Init() {\n    this.wasmModule = true;\n    return this.handler.request(this.API, WorkerActions.Init);\n  }\n\n  async OpenModel(data, settings) {\n    return this.handler.request(this.API, WorkerActions.OpenModel, {\n      data,\n      settings\n    });\n  }\n\n  async CreateModel(settings) {\n    return this.handler.request(this.API, WorkerActions.CreateModel, {\n      settings\n    });\n  }\n\n  async ExportFileAsIFC(modelID) {\n    return this.handler.request(this.API, WorkerActions.ExportFileAsIFC, {\n      modelID\n    });\n  }\n\n  async GetGeometry(modelID, geometryExpressID) {\n    this.handler.serializeHandlers[this.handler.requestID] = geom => {\n      return this.serializer.reconstructIfcGeometry(geom);\n    };\n\n    return this.handler.request(this.API, WorkerActions.GetGeometry, {\n      modelID,\n      geometryExpressID\n    });\n  }\n\n  async GetLine(modelID, expressID, flatten) {\n    return this.handler.request(this.API, WorkerActions.GetLine, {\n      modelID,\n      expressID,\n      flatten\n    });\n  }\n\n  async GetAndClearErrors(modelID) {\n    this.handler.serializeHandlers[this.handler.requestID] = vector => {\n      return this.serializer.reconstructVector(vector);\n    };\n\n    return this.handler.request(this.API, WorkerActions.GetAndClearErrors, {\n      modelID\n    });\n  }\n\n  async WriteLine(modelID, lineObject) {\n    return this.handler.request(this.API, WorkerActions.WriteLine, {\n      modelID,\n      lineObject\n    });\n  }\n\n  async FlattenLine(modelID, line) {\n    return this.handler.request(this.API, WorkerActions.FlattenLine, {\n      modelID,\n      line\n    });\n  }\n\n  async GetRawLineData(modelID, expressID) {\n    return this.handler.request(this.API, WorkerActions.GetRawLineData, {\n      modelID,\n      expressID\n    });\n  }\n\n  async WriteRawLineData(modelID, data) {\n    return this.handler.request(this.API, WorkerActions.WriteRawLineData, {\n      modelID,\n      data\n    });\n  }\n\n  async GetLineIDsWithType(modelID, type) {\n    this.handler.serializeHandlers[this.handler.requestID] = vector => {\n      return this.serializer.reconstructVector(vector);\n    };\n\n    return this.handler.request(this.API, WorkerActions.GetLineIDsWithType, {\n      modelID,\n      type\n    });\n  }\n\n  async GetAllLines(modelID) {\n    this.handler.serializeHandlers[this.handler.requestID] = vector => {\n      return this.serializer.reconstructVector(vector);\n    };\n\n    return this.handler.request(this.API, WorkerActions.GetAllLines, {\n      modelID\n    });\n  }\n\n  async SetGeometryTransformation(modelID, transformationMatrix) {\n    return this.handler.request(this.API, WorkerActions.SetGeometryTransformation, {\n      modelID,\n      transformationMatrix\n    });\n  }\n\n  async GetCoordinationMatrix(modelID) {\n    return this.handler.request(this.API, WorkerActions.GetCoordinationMatrix, {\n      modelID\n    });\n  }\n\n  async GetVertexArray(ptr, size) {\n    return this.handler.request(this.API, WorkerActions.GetVertexArray, {\n      ptr,\n      size\n    });\n  }\n\n  async GetIndexArray(ptr, size) {\n    return this.handler.request(this.API, WorkerActions.GetIndexArray, {\n      ptr,\n      size\n    });\n  }\n\n  async getSubArray(heap, startPtr, sizeBytes) {\n    return this.handler.request(this.API, WorkerActions.getSubArray, {\n      heap,\n      startPtr,\n      sizeBytes\n    });\n  }\n\n  async CloseModel(modelID) {\n    return this.handler.request(this.API, WorkerActions.CloseModel, {\n      modelID\n    });\n  }\n\n  async StreamAllMeshes(modelID, meshCallback) {\n    this.handler.callbackHandlers[this.handler.requestID] = {\n      action: meshCallback,\n      serializer: this.serializer.reconstructFlatMesh\n    };\n    return this.handler.request(this.API, WorkerActions.StreamAllMeshes, {\n      modelID\n    });\n  }\n\n  async StreamAllMeshesWithTypes(modelID, types, meshCallback) {\n    this.handler.callbackHandlers[this.handler.requestID] = {\n      action: meshCallback,\n      serializer: this.serializer.reconstructFlatMesh\n    };\n    return this.handler.request(this.API, WorkerActions.StreamAllMeshesWithTypes, {\n      modelID,\n      types\n    });\n  }\n\n  async IsModelOpen(modelID) {\n    return this.handler.request(this.API, WorkerActions.IsModelOpen, {\n      modelID\n    });\n  }\n\n  async LoadAllGeometry(modelID) {\n    this.handler.serializeHandlers[this.handler.requestID] = vector => {\n      return this.serializer.reconstructFlatMeshVector(vector);\n    };\n\n    return this.handler.request(this.API, WorkerActions.LoadAllGeometry, {\n      modelID\n    });\n  }\n\n  async GetFlatMesh(modelID, expressID) {\n    this.handler.serializeHandlers[this.handler.requestID] = flatMesh => {\n      return this.serializer.reconstructFlatMesh(flatMesh);\n    };\n\n    return this.handler.request(this.API, WorkerActions.GetFlatMesh, {\n      modelID,\n      expressID\n    });\n  }\n\n  async SetWasmPath(path) {\n    return this.handler.request(this.API, WorkerActions.SetWasmPath, {\n      path\n    });\n  }\n\n}\n\nclass WorkerStateHandler {\n  constructor(handler) {\n    this.handler = handler;\n    this.API = WorkerAPIs.workerState;\n    this.state = this.handler.state;\n  }\n\n  async updateStateUseJson() {\n    const useJson = this.state.useJSON;\n    return this.handler.request(this.API, WorkerActions.updateStateUseJson, {\n      useJson\n    });\n  }\n\n  async updateStateWebIfcSettings() {\n    const webIfcSettings = this.state.webIfcSettings;\n    return this.handler.request(this.API, WorkerActions.updateStateWebIfcSettings, {\n      webIfcSettings\n    });\n  }\n\n  async updateModelStateTypes(modelID, types) {\n    return this.handler.request(this.API, WorkerActions.updateModelStateTypes, {\n      modelID,\n      types\n    });\n  }\n\n  async updateModelStateJsonData(modelID, jsonData) {\n    return this.handler.request(this.API, WorkerActions.updateModelStateJsonData, {\n      modelID,\n      jsonData\n    });\n  }\n\n  async loadJsonDataFromWorker(modelID, path) {\n    return this.handler.request(this.API, WorkerActions.loadJsonDataFromWorker, {\n      modelID,\n      path\n    });\n  }\n\n}\n\nvar DBOperation;\n\n(function (DBOperation) {\n  DBOperation[DBOperation[\"transferIfcModel\"] = 0] = \"transferIfcModel\";\n  DBOperation[DBOperation[\"transferIndividualItems\"] = 1] = \"transferIndividualItems\";\n})(DBOperation || (DBOperation = {}));\n\nclass IndexedDatabase {\n  async save(item, id) {\n    const open = IndexedDatabase.openOrCreateDB(id);\n    this.createSchema(open, id);\n    return new Promise((resolve, reject) => {\n      open.onsuccess = () => this.saveItem(item, open, id, resolve);\n    });\n  }\n\n  async load(id) {\n    const open = IndexedDatabase.openOrCreateDB(id);\n    return new Promise((resolve, reject) => {\n      open.onsuccess = () => this.loadItem(open, id, resolve);\n    });\n  }\n\n  createSchema(open, id) {\n    open.onupgradeneeded = function () {\n      const db = open.result;\n      db.createObjectStore(id.toString(), {\n        keyPath: \"id\"\n      });\n    };\n  }\n\n  saveItem(item, open, id, resolve) {\n    const {\n      db,\n      tx,\n      store\n    } = IndexedDatabase.getDBItems(open, id);\n    item.id = id;\n    store.put(item);\n\n    tx.oncomplete = () => IndexedDatabase.closeDB(db, tx, resolve);\n  }\n\n  loadItem(open, id, resolve) {\n    const {\n      db,\n      tx,\n      store\n    } = IndexedDatabase.getDBItems(open, id);\n    const item = store.get(id);\n\n    const callback = () => {\n      delete item.result.id;\n      resolve(item.result);\n    };\n\n    tx.oncomplete = () => IndexedDatabase.closeDB(db, tx, callback);\n  }\n\n  static getDBItems(open, id) {\n    const db = open.result;\n    const tx = db.transaction(id.toString(), \"readwrite\");\n    const store = tx.objectStore(id.toString());\n    return {\n      db,\n      tx,\n      store\n    };\n  }\n\n  static openOrCreateDB(id) {\n    return indexedDB.open(id.toString(), 1);\n  }\n\n  static closeDB(db, tx, resolve) {\n    db.close();\n    resolve(\"success\");\n  }\n\n}\n\nclass ParserHandler {\n  constructor(handler, serializer, BVH, IDB) {\n    this.handler = handler;\n    this.serializer = serializer;\n    this.BVH = BVH;\n    this.IDB = IDB;\n    this.API = WorkerAPIs.parser;\n  }\n\n  async setupOptionalCategories(config) {\n    return this.handler.request(this.API, WorkerActions.setupOptionalCategories, {\n      config\n    });\n  }\n\n  async parse(buffer, coordinationMatrix) {\n    this.handler.onprogressHandlers[this.handler.requestID] = progress => {\n      if (this.handler.state.onProgress) this.handler.state.onProgress(progress);\n    };\n\n    this.handler.serializeHandlers[this.handler.requestID] = async result => {\n      this.updateState(result.modelID);\n      await this.getItems(result.modelID);\n      return this.getModel();\n    };\n\n    return this.handler.request(this.API, WorkerActions.parse, {\n      buffer,\n      coordinationMatrix\n    });\n  }\n\n  getAndClearErrors(_modelId) {}\n\n  updateState(modelID) {\n    this.handler.state.models[modelID] = {\n      modelID: modelID,\n      mesh: {},\n      items: {},\n      types: {},\n      jsonData: {}\n    };\n  }\n\n  async getItems(modelID) {\n    const items = await this.IDB.load(DBOperation.transferIndividualItems);\n    this.handler.state.models[modelID].items = this.serializer.reconstructGeometriesByMaterials(items);\n  }\n\n  async getModel() {\n    const serializedModel = await this.IDB.load(DBOperation.transferIfcModel);\n    const model = this.serializer.reconstructIfcModel(serializedModel);\n    this.BVH.applyThreeMeshBVH(model.geometry);\n    this.handler.state.models[model.modelID].mesh = model;\n    return model;\n  }\n\n}\n\nclass IFCWorkerHandler {\n  constructor(state, BVH) {\n    this.state = state;\n    this.BVH = BVH;\n    this.requestID = 0;\n    this.rejectHandlers = {};\n    this.resolveHandlers = {};\n    this.serializeHandlers = {};\n    this.callbackHandlers = {};\n    this.onprogressHandlers = {};\n    this.serializer = new Serializer();\n    this.IDB = new IndexedDatabase();\n    this.workerPath = this.state.worker.path;\n    this.ifcWorker = new Worker(this.workerPath);\n\n    this.ifcWorker.onmessage = data => this.handleResponse(data);\n\n    this.properties = new PropertyHandler(this);\n    this.parser = new ParserHandler(this, this.serializer, this.BVH, this.IDB);\n    this.webIfc = new WebIfcHandler(this, this.serializer);\n    this.workerState = new WorkerStateHandler(this);\n  }\n\n  request(worker, action, args) {\n    const data = {\n      worker,\n      action,\n      args,\n      id: this.requestID,\n      result: undefined,\n      onProgress: false\n    };\n    return new Promise((resolve, reject) => {\n      this.resolveHandlers[this.requestID] = resolve;\n      this.rejectHandlers[this.requestID] = reject;\n      this.requestID++;\n      this.ifcWorker.postMessage(data);\n    });\n  }\n\n  async Close() {\n    await this.request(WorkerAPIs.webIfc, WorkerActions.Close);\n  }\n\n  handleResponse(event) {\n    const data = event.data;\n\n    if (data.onProgress) {\n      this.resolveOnProgress(data);\n      return;\n    }\n\n    this.callHandlers(data);\n    delete this.resolveHandlers[data.id];\n    delete this.rejectHandlers[data.id];\n    delete this.onprogressHandlers[data.id];\n  }\n\n  callHandlers(data) {\n    try {\n      this.resolveSerializations(data);\n      this.resolveCallbacks(data);\n      this.resolveHandlers[data.id](data.result);\n    } catch (error) {\n      this.rejectHandlers[data.id](error);\n    }\n  }\n\n  resolveOnProgress(data) {\n    if (this.onprogressHandlers[data.id]) {\n      data.result = this.onprogressHandlers[data.id](data.result);\n    }\n  }\n\n  resolveSerializations(data) {\n    if (this.serializeHandlers[data.id]) {\n      data.result = this.serializeHandlers[data.id](data.result);\n      delete this.serializeHandlers[data.id];\n    }\n  }\n\n  resolveCallbacks(data) {\n    if (this.callbackHandlers[data.id]) {\n      let callbackParameter = data.result;\n\n      if (this.callbackHandlers[data.id].serializer) {\n        callbackParameter = this.callbackHandlers[data.id].serializer(data.result);\n      }\n\n      this.callbackHandlers[data.id].action(callbackParameter);\n    }\n  }\n\n}\n\nclass IFCManager {\n  constructor() {\n    this.state = {\n      models: [],\n      api: new WebIFC.IfcAPI(),\n      useJSON: false,\n      worker: {\n        active: false,\n        path: ''\n      }\n    };\n    this.BVH = new BvhManager();\n    this.parser = new IFCParser(this.state, this.BVH);\n    this.subsets = new SubsetManager(this.state, this.BVH);\n    this.properties = new PropertyManager(this.state);\n    this.types = new TypeManager(this.state);\n    this.hider = new ItemsHider(this.state);\n    this.cleaner = new MemoryCleaner(this.state);\n  }\n\n  get ifcAPI() {\n    return this.state.api;\n  }\n\n  async parse(buffer) {\n    var _a;\n\n    const model = await this.parser.parse(buffer, (_a = this.state.coordinationMatrix) === null || _a === void 0 ? void 0 : _a.toArray());\n    model.setIFCManager(this);\n    this.state.useJSON ? await this.disposeMemory() : await this.types.getAllTypes(this.worker);\n    this.hider.processCoordinates(model.modelID);\n    return model;\n  }\n\n  async setWasmPath(path) {\n    this.state.api.SetWasmPath(path);\n  }\n\n  setupThreeMeshBVH(computeBoundsTree, disposeBoundsTree, acceleratedRaycast) {\n    this.BVH.initializeMeshBVH(computeBoundsTree, disposeBoundsTree, acceleratedRaycast);\n  }\n\n  setOnProgress(onProgress) {\n    this.state.onProgress = onProgress;\n  }\n\n  setupCoordinationMatrix(matrix) {\n    this.state.coordinationMatrix = matrix;\n  }\n\n  clearCoordinationMatrix() {\n    delete this.state.coordinationMatrix;\n  }\n\n  async applyWebIfcConfig(settings) {\n    this.state.webIfcSettings = settings;\n\n    if (this.state.worker.active && this.worker) {\n      await this.worker.workerState.updateStateWebIfcSettings();\n    }\n  }\n\n  async useWebWorkers(active, path) {\n    if (this.state.worker.active === active) return;\n    this.state.api = null;\n\n    if (active) {\n      if (!path) throw new Error('You must provide a path to the web worker.');\n      this.state.worker.active = active;\n      this.state.worker.path = path;\n      await this.initializeWorkers();\n    } else {\n      this.state.api = new WebIFC.IfcAPI();\n    }\n  }\n\n  async useJSONData() {\n    let useJSON = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n    var _a;\n\n    this.state.useJSON = useJSON;\n\n    if (useJSON) {\n      await ((_a = this.worker) === null || _a === void 0 ? void 0 : _a.workerState.updateStateUseJson());\n    }\n  }\n\n  async addModelJSONData(modelID, data) {\n    var _a;\n\n    const model = this.state.models[modelID];\n    if (!model) throw new Error('The specified model for the JSON data does not exist');\n\n    if (this.state.worker.active) {\n      await ((_a = this.worker) === null || _a === void 0 ? void 0 : _a.workerState.updateModelStateJsonData(modelID, data));\n    } else {\n      model.jsonData = data;\n    }\n  }\n\n  async loadJsonDataFromWorker(modelID, path) {\n    var _a;\n\n    if (this.state.worker.active) {\n      await ((_a = this.worker) === null || _a === void 0 ? void 0 : _a.workerState.loadJsonDataFromWorker(modelID, path));\n    }\n  }\n\n  close(modelID, scene) {\n    this.state.api.CloseModel(modelID);\n    if (scene) scene.remove(this.state.models[modelID].mesh);\n    delete this.state.models[modelID];\n  }\n\n  getExpressId(geometry, faceIndex) {\n    return this.properties.getExpressId(geometry, faceIndex);\n  }\n\n  getAllItemsOfType(modelID, type, verbose) {\n    return this.properties.getAllItemsOfType(modelID, type, verbose);\n  }\n\n  getItemProperties(modelID, id) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return this.properties.getItemProperties(modelID, id, recursive);\n  }\n\n  getPropertySets(modelID, id) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return this.properties.getPropertySets(modelID, id, recursive);\n  }\n\n  getTypeProperties(modelID, id) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return this.properties.getTypeProperties(modelID, id, recursive);\n  }\n\n  getMaterialsProperties(modelID, id) {\n    let recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return this.properties.getMaterialsProperties(modelID, id, recursive);\n  }\n\n  getIfcType(modelID, id) {\n    const typeID = this.state.models[modelID].types[id];\n    return IfcElements[typeID];\n  }\n\n  getSpatialStructure(modelID, includeProperties) {\n    return this.properties.getSpatialStructure(modelID, includeProperties);\n  }\n\n  getSubset(modelID, material, customId) {\n    return this.subsets.getSubset(modelID, material, customId);\n  }\n\n  removeSubset(modelID, parent, material, customId) {\n    this.subsets.removeSubset(modelID, parent, material, customId);\n  }\n\n  createSubset(config) {\n    return this.subsets.createSubset(config);\n  }\n\n  hideItems(modelID, ids) {\n    this.hider.hideItems(modelID, ids);\n  }\n\n  hideAllItems(modelID) {\n    this.hider.hideAllItems(modelID);\n  }\n\n  showItems(modelID, ids) {\n    this.hider.showItems(modelID, ids);\n  }\n\n  showAllItems(modelID) {\n    this.hider.showAllItems(modelID);\n  }\n\n  releaseAllMemory() {\n    this.subsets.dispose();\n    this.hider.dispose();\n    this.cleaner.releaseAllModels();\n    this.state.api = null;\n    this.state.models = null;\n    this.state = null;\n  }\n\n  async disposeMemory() {\n    var _a;\n\n    if (this.state.worker.active) {\n      await ((_a = this.worker) === null || _a === void 0 ? void 0 : _a.Close());\n    } else {\n      this.state.api = null;\n      this.state.api = new WebIFC.IfcAPI();\n    }\n  }\n\n  getAndClearErrors(modelID) {\n    return this.parser.getAndClearErrors(modelID);\n  }\n\n  async initializeWorkers() {\n    this.worker = new IFCWorkerHandler(this.state, this.BVH);\n    this.state.api = this.worker.webIfc;\n    this.properties = this.worker.properties;\n    this.parser = this.worker.parser;\n    await this.worker.workerState.updateStateUseJson();\n    await this.worker.workerState.updateStateWebIfcSettings();\n  }\n\n}\n\nclass IFCLoader extends Loader {\n  constructor(manager) {\n    super(manager);\n    this.ifcManager = new IFCManager();\n  }\n\n  load(url, onLoad, onProgress, onError) {\n    const scope = this;\n    const loader = new FileLoader(scope.manager);\n    this.onProgress = onProgress;\n    loader.setPath(scope.path);\n    loader.setResponseType('arraybuffer');\n    loader.setRequestHeader(scope.requestHeader);\n    loader.setWithCredentials(scope.withCredentials);\n    loader.load(url, async function (buffer) {\n      try {\n        if (typeof buffer == 'string') {\n          throw new Error('IFC files must be given as a buffer!');\n        }\n\n        onLoad(await scope.parse(buffer));\n      } catch (e) {\n        if (onError) {\n          onError(e);\n        } else {\n          console.error(e);\n        }\n\n        scope.manager.itemError(url);\n      }\n    }, onProgress, onError);\n  }\n\n  parse(buffer) {\n    return this.ifcManager.parse(buffer);\n  }\n\n}\n\nexport { IFCLoader };","map":{"version":3,"sources":["../src/IFC/BaseDefinitions.ts","../src/IFC/components/IFCModel.ts","../src/IFC/components/IFCParser.ts","../src/IFC/components/SubsetManager.ts","../src/IFC/components/properties/BasePropertyManager.ts","../src/IFC/components/IFCElementsMap.ts","../src/IFC/components/properties/WebIfcPropertyManager.ts","../src/IFC/components/IfcTypesMap.ts","../src/IFC/components/properties/JSONPropertyManager.ts","../src/IFC/components/properties/PropertyManager.ts","../src/IFC/components/TypeManager.ts","../src/IFC/components/BvhManager.ts","../src/IFC/components/ItemsHider.ts","../src/IFC/components/MemoryCleaner.ts","../src/IFC/web-workers/BaseDefinitions.ts","../src/IFC/web-workers/serializer/Vector.ts","../src/IFC/web-workers/serializer/IfcGeometry.ts","../src/IFC/web-workers/serializer/FlatMesh.ts","../src/IFC/web-workers/serializer/FlatMeshVector.ts","../src/IFC/web-workers/serializer/Material.ts","../src/IFC/web-workers/serializer/Geometry.ts","../src/IFC/web-workers/serializer/Mesh.ts","../src/IFC/web-workers/serializer/GeomsByMaterials.ts","../src/IFC/web-workers/serializer/Serializer.ts","../src/IFC/web-workers/handlers/PropertyHandler.ts","../src/IFC/web-workers/handlers/WebIfcHandler.ts","../src/IFC/web-workers/handlers/WorkerStateHandler.ts","../src/IFC/indexedDB/IndexedDatabase.ts","../src/IFC/web-workers/handlers/ParserHandler.ts","../src/IFC/web-workers/IFCWorkerHandler.ts","../src/IFC/components/IFCManager.ts","../src/IFCLoader.ts"],"names":[],"mappings":"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vET,cAAA,sBDuES;ACrED,cAAM,uBDqEL;ACpEN,cAAM,wBDoEA;ACnEN,cAAM,aDmEA;AClEN,cAAK,gBDkEC;ACjEF,cAAA,SDiEE;AChEL,cAAA,yBDgEK;AC/DN,cAAA,mBD+DM;AC9DT,cAAA,eD8DS;AC5DS,cAAA,gBD4DT;AC3DN,cAAM,cD2DA;AC1DN,cAAA,iBD0DM;ACzDT,cAAA,YDyDS;ACvDS,cAAM,cDuDf;ACtDN,cAAM,iCDsDA;ACrDN,cAAK,oBDqDC;ACpDF,cAAA,iBDoDE;ACnDF,cAAA,sBDmDE;AClDL,cAAA,SDkDK;ACjDT,cAAA,oBDiDS;AC/CF,cAAM,mBD+CJ;AC9CN,cAAM,WD8CA;AC7CN,cAAM,qBD6CA;AC5CN,cAAK,WD4CC;AC3CF,cAAA,wBD2CE;AC1CF,cAAA,SD0CE;ACzCF,cAAA,eDyCE;cCzCa,qBDyCb;ACxCL,cAAA,4BDwCK;ACvCN,cAAA,qBDuCM;ACtCT,cAAA,wBDsCS;wBAAA;iCAAA;AErGP,cAAM,sBFqGC;AEpGV,cAAU,qBFoGA;AEnGV,cAAU,UFmGA;AElGV,cAAU,4BFkGA;AEjGV,cAAU,qBFiGA;AEhGV,cAAU,eFgGA;AE/FV,cAAS,YF+FC;AE9FV,cAAU,WF8FA;AE7FV,cAAU,8BF6FA;AE5FV,cAAU,kBF4FA;AE3FV,cAAU,QF2FA;AE1FV,cAAS,gBF0FC;AEzFV,cAAU,sBFyFA;AExFV,cAAU,gBFwFA;AEvFV,cAAU,wBFuFA;AEtFV,cAAU,qBFsFA;AErFV,cAAU,gBFqFA;AEpFV,cAAU,eFoFA;AEnFV,cAAS,mBFmFC;AElFV,cAAS,gBFkFC;AEjFV,cAAU,iBFiFA;AEhFV,cAAU,sBFgFA;AE/EV,cAAU,WF+EA;AE9EV,cAAU,sBF8EA;AE7EV,cAAU,wBF6EA;AE5EV,cAAU,WF4EA;AE3EV,cAAU,gBF2EA;AE1EV,cAAU,YF0EA;AEzEV,cAAU,WFyEA;AExEV,cAAS,WFwEC;AEvEV,cAAS,oBFuEC;AEtEV,cAAS,eFsEC;AErEV,cAAS,sBFqEC;AEpEV,cAAU,gBFoEA;AEnEV,cAAU,UFmEA;AElEV,cAAU,iBFkEA;AEjEV,cAAU,kB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,eA3rBE;AA4rBZ,cAAU,eA5rBE;AA6rBZ,cAAU,yBA7rBE;AA8rBZ,aAAA,wBA9rBY;AA+rBZ,cAAU,4BA/rBE;AAgsBZ,cAAU,YAhsBE;AAisBZ,cAAU,YAjsBE;AAksBZ,aAAA,iBAlsBY;AAmsBZ,cAAU,+BAnsBE;AAosBf,cAAA,mBApsBe;2CAAA;ACvGH,cAAA,wBDuGG;ACrGZ,cAAM,6BDqGM;ACpGR,cAAA,iBDoGQ;ACnGX,cAAA,yBDmGW;ACjGZ,cAAM,2BDiGM;AChGR,cAAM,0BDgGE;AC/FR,aAAA,wBD+FQ;AC9FR,cAAM,6BD8FE;AC7FR,aAAA,mBD6FQ;AC5FR,cAAM,mBD4FE;AC3FR,cAAA,mBD2FQ;AC1FX,cAAA,4BD0FW;ACxFZ,aAAM,iBDwFM;ACvFR,cAAM,oBDuFE;ACtFR,cAAM,wBDsFE;ACrFR,cAAK,WDqFG;ACpFJ,aAAA,2BDoFI;ACnFP,cAAA,+BDmFO;AClFR,cAAA,qBDkFQ;ACjFX,aAAA,UDiFW;AC/EH,cAAM,gBD+EH;AC9ER,aAAA,aD8EQ;AC7ER,aAAA,SD6EQ;AC5ER,WAAA,aD4EQ;AC3EJ,cAAA,SD2EI;AC1EP,cAAA,aD0EO;ACzER,cAAA,sBDyEQ;ACxEX,cAAA,aDwEW;ACtEO,aAAA,mBDsEP;ACrER,cAAA,WDqEQ;ACpEX,cAAA,iBDoEW;AClEO,cAAM,qBDkEb;ACjER,cAAM,kBDiEE;AChER,cAAA,sBDgEQ;AC/DJ,cAAA,eD+DI;AC9DP,cAAE,uBD8DK;AC7DX,aAAA,oBD6DW;AC3DJ,cAAA,gBD2DI;AC1DR,cAAM,0BD0DE;ACzDR,cAAM,cDyDE;ACxDJ,cAAA,uBDwDI;ACvDJ,cAAA,4BDuDI;cCtDA,uBDsDA;aCrDH,sBDqDG;ACpDP,cAAE,+BDoDK;ACnDR,cAAA,eDmDQ;AClDX,cAAA,kBDkDW;AChDJ,cAAM,sBDgDF;AC/CR,cAAM,eD+CE;AC9CR,cAAM,eD8CE;AC7CR,aAAK,oBD6CG;AC5CJ,cAAA,kCD4CI;AC3CJ,cAAA,2BD2CI;cC3CW,oBD2CX;AC1CP,cAAE,gBD0CK;ACzCR,cAAA,oBDyCQ;ACxCX,cAAA,6BDwCW;ACtCJ,cAAA,q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","sourcesContent":["import { BufferAttribute, BufferGeometry, Material, Matrix4, Mesh, Object3D } from 'three';\r\n// TODO: Remove ts ignore comments when @types/three gets updated\r\n// @ts-ignore\r\nimport { mergeBufferGeometries } from 'three/examples/jsm/utils/BufferGeometryUtils';\r\nimport {\r\n    FlatMesh,\r\n    IfcGeometry,\r\n    IFCRELAGGREGATES, IFCRELASSOCIATESMATERIAL,\r\n    IFCRELCONTAINEDINSPATIALSTRUCTURE,\r\n    IFCRELDEFINESBYPROPERTIES,\r\n    IFCRELDEFINESBYTYPE, LoaderError, LoaderSettings, RawLineData, Vector\r\n} from 'web-ifc';\r\nimport {ParserProgress} from \"./components/IFCParser\";\r\n\r\nexport const IdAttrName = 'expressID';\r\n\r\nexport type IdAttributeByMaterial = { [id: number]: number };\r\nexport type IdAttributesByMaterials = { [materialID: string]: IdAttributeByMaterial };\r\n\r\nexport const merge = (geoms: BufferGeometry[], createGroups = false) => {\r\n    // @ts-ignore\r\n    return mergeBufferGeometries(geoms, createGroups);\r\n};\r\n\r\nexport const newFloatAttr = (data: any[], size: number) => {\r\n    return new BufferAttribute(new Float32Array(data), size);\r\n};\r\n\r\nexport const newIntAttr = (data: any[], size: number) => {\r\n    return new BufferAttribute(new Uint32Array(data), size);\r\n};\r\n\r\n//TODO: Rename \"scene\" to \"parent\" in the next major release\r\nexport interface HighlightConfig {\r\n    scene: Object3D;\r\n    ids: number[];\r\n    removePrevious: boolean;\r\n    material?: Material;\r\n    customId?: string;\r\n}\r\n\r\nexport interface HighlightConfigOfModel extends HighlightConfig {\r\n    modelID: number;\r\n}\r\n\r\nexport const DEFAULT = 'default';\r\n\r\nexport type SelectedItems = {\r\n    [matID: string]: { ids: Set<number>; mesh: Mesh };\r\n};\r\n\r\nexport type MapFaceindexID = { [key: number]: number };\r\n\r\nexport type IdGeometries = {\r\n    [expressID: number]: BufferGeometry;\r\n};\r\n\r\nexport type GeometriesByMaterial = {\r\n    material: Material;\r\n    geometries: IdGeometries;\r\n};\r\n\r\nexport interface GeometriesByMaterials {\r\n    [materialID: string]: GeometriesByMaterial;\r\n}\r\n\r\nexport interface TypesMap {\r\n    [key: number]: number;\r\n}\r\n\r\nexport interface IfcModel {\r\n    modelID: number;\r\n    mesh: IfcMesh;\r\n    items: GeometriesByMaterials;\r\n    types: TypesMap;\r\n    jsonData: { [id: number]: JSONObject };\r\n}\r\n\r\nexport interface JSONObject {\r\n    expressID: number;\r\n    type: string;\r\n    [key: string]: any;\r\n}\r\n\r\nexport interface Worker {\r\n    active: boolean;\r\n    path: string;\r\n}\r\n\r\nexport interface IfcState {\r\n    models: { [modelID: number]: IfcModel };\r\n    api: WebIfcAPI;\r\n    useJSON: boolean;\r\n    worker: Worker;\r\n    webIfcSettings?: LoaderSettings;\r\n    onProgress?: (event: ParserProgress) => void;\r\n    coordinationMatrix?: Matrix4\r\n}\r\n\r\nexport interface IfcMesh extends Mesh {\r\n    modelID: number;\r\n}\r\n\r\nexport interface Node {\r\n    expressID: number;\r\n    type: string;\r\n    children: Node[];\r\n}\r\n\r\nexport interface pName {\r\n    name: number;\r\n    relating: string;\r\n    related: string;\r\n    key: string;\r\n}\r\n\r\nexport const PropsNames = {\r\n    aggregates: {\r\n        name: IFCRELAGGREGATES,\r\n        relating: 'RelatingObject',\r\n        related: 'RelatedObjects',\r\n        key: 'children'\r\n    },\r\n    spatial: {\r\n        name: IFCRELCONTAINEDINSPATIALSTRUCTURE,\r\n        relating: 'RelatingStructure',\r\n        related: 'RelatedElements',\r\n        key: 'children'\r\n    },\r\n    psets: {\r\n        name: IFCRELDEFINESBYPROPERTIES,\r\n        relating: 'RelatingPropertyDefinition',\r\n        related: 'RelatedObjects',\r\n        key: 'hasPsets'\r\n    },\r\n    materials: {\r\n        name: IFCRELASSOCIATESMATERIAL,\r\n        relating: 'RelatingMaterial',\r\n        related: 'RelatedObjects',\r\n        key: 'hasMaterial'\r\n    },\r\n    type: {\r\n        name: IFCRELDEFINESBYTYPE,\r\n        relating: 'RelatingType',\r\n        related: 'RelatedObjects',\r\n        key: 'hasType'\r\n    }\r\n};\r\n\r\nexport interface WebIfcAPI {\r\n\r\n    wasmModule: any;\r\n\r\n    Init(): void | Promise<void>;\r\n\r\n    // To close the web worker\r\n    Close?: () => void;\r\n\r\n    /**\r\n     * Opens a model and returns a modelID number\r\n     * @data Buffer containing IFC data (bytes)\r\n     * @data Settings settings for loading the model\r\n     */\r\n    OpenModel(data: string | Uint8Array, settings?: LoaderSettings): number | Promise<number>;\r\n\r\n    /**\r\n     * Creates a new model and returns a modelID number\r\n     * @data Settings settings for generating data the model\r\n     */\r\n    CreateModel(settings?: LoaderSettings): number | Promise<number>;\r\n\r\n    ExportFileAsIFC(modelID: number): Uint8Array | Promise<Uint8Array>;\r\n\r\n    /**\r\n     * Opens a model and returns a modelID number\r\n     * @modelID Model handle retrieved by OpenModel, model must not be closed\r\n     * @data Buffer containing IFC data (bytes)\r\n     */\r\n    GetGeometry(modelID: number, geometryExpressID: number): IfcGeometry | Promise<IfcGeometry>;\r\n\r\n    GetLine(modelID: number, expressID: number, flatten?: boolean):  any | Promise<any>;\r\n\r\n    GetAndClearErrors(modelID: number): Vector<LoaderError> | Promise<Vector<LoaderError>>;\r\n\r\n    WriteLine(modelID: number, lineObject: any): void | Promise<void>;\r\n\r\n    FlattenLine(modelID: number, line: any): void | Promise<void>;\r\n\r\n    GetRawLineData(modelID: number, expressID: number): RawLineData | Promise<RawLineData>;\r\n\r\n    WriteRawLineData(modelID: number, data: RawLineData):  any | Promise<any>;\r\n\r\n    GetLineIDsWithType(modelID: number, type: number): Vector<number> | Promise<Vector<number>>;\r\n\r\n    GetAllLines(modelID: Number): Vector<number> | Promise<Vector<number>>;\r\n\r\n    SetGeometryTransformation(modelID: number, transformationMatrix: Array<number>): void | Promise<void>;\r\n\r\n    GetCoordinationMatrix(modelID: number): Array<number> | Promise<Array<number>>;\r\n\r\n    GetVertexArray(ptr: number, size: number): Float32Array | Promise<Float32Array>;\r\n\r\n    GetIndexArray(ptr: number, size: number): Uint32Array | Promise<Uint32Array>;\r\n\r\n    getSubArray(heap: any, startPtr: any, sizeBytes: any): any | Promise<any>;\r\n\r\n    /**\r\n     * Closes a model and frees all related memory\r\n     * @modelID Model handle retrieved by OpenModel, model must not be closed\r\n     */\r\n    CloseModel(modelID: number): void | Promise<void>;\r\n\r\n    StreamAllMeshes(modelID: number, meshCallback: (mesh: FlatMesh) => void): void | Promise<void>;\r\n\r\n    StreamAllMeshesWithTypes(modelID: number, types: Array<number>, meshCallback: (mesh: FlatMesh) => void): void | Promise<void>;\r\n\r\n    /**\r\n     * Checks if a specific model ID is open or closed\r\n     * @modelID Model handle retrieved by OpenModel\r\n     */\r\n    IsModelOpen(modelID: number): boolean | Promise<boolean>;\r\n\r\n    /**\r\n     * Load all geometry in a model\r\n     * @modelID Model handle retrieved by OpenModel\r\n     */\r\n    LoadAllGeometry(modelID: number): Vector<FlatMesh> | Promise<Vector<FlatMesh>>;\r\n\r\n    /**\r\n     * Load geometry for a single element\r\n     * @modelID Model handle retrieved by OpenModel\r\n     */\r\n    GetFlatMesh(modelID: number, expressID: number): FlatMesh | Promise<FlatMesh>;\r\n\r\n    SetWasmPath(path: string): void | Promise<void>;\r\n}\r\n","import { BufferGeometry, Material, Mesh, Object3D, Scene } from 'three';\r\nimport { IFCManager } from './IFCManager';\r\nimport { HighlightConfig } from '../BaseDefinitions';\r\n\r\nlet modelIdCounter = 0;\r\nconst nullIfcManagerErrorMessage = 'IfcManager is null!';\r\n\r\n/**\r\n * Represents an IFC model. This object is returned by the `IFCLoader` after loading an IFC.\r\n * @geometry `THREE.Buffergeometry`, see Three.js documentation.\r\n * @materials `THREE.Material[]`, see Three.js documentation.\r\n * @manager contains all the logic to work with IFC.\r\n */\r\nexport class IFCModel extends Mesh {\r\n    modelID = modelIdCounter++;\r\n    ifcManager: IFCManager | null = null;\r\n\r\n    /**\r\n     * @deprecated `IfcModel` is already a mesh; you can place it in the scene directly.\r\n     */\r\n    mesh = this;\r\n\r\n    setIFCManager(manager: IFCManager) {\r\n        this.ifcManager = manager;\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.setWasmPath` instead.\r\n     *\r\n     * Sets the relative path of web-ifc.wasm file in the project.\r\n     * Beware: you **must** serve this file in your page; this means\r\n     * that you have to copy this files from *node_modules/web-ifc*\r\n     * to your deployment directory.\r\n     *\r\n     * If you don't use this methods,\r\n     * IFC.js assumes that you are serving it in the root directory.\r\n     *\r\n     * Example if web-ifc.wasm is in dist/wasmDir:\r\n     * `ifcLoader.setWasmPath(\"dist/wasmDir/\");`\r\n     *\r\n     * @path Relative path to web-ifc.wasm.\r\n     */\r\n    setWasmPath(path: string) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        this.ifcManager.setWasmPath(path);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.close` instead.\r\n     *\r\n     * Closes the specified model and deletes it from the [scene](https://threejs.org/docs/#api/en/scenes/Scene).\r\n     * @scene Scene where the model is (if it's located in a scene).\r\n     */\r\n    close(scene?: Scene) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        this.ifcManager.close(this.modelID, scene);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.getExpressId` instead.\r\n     *\r\n     * Gets the **Express ID** to which the given face belongs.\r\n     * This ID uniquely identifies this entity within this IFC file.\r\n     * @geometry The geometry of the IFC model.\r\n     * @faceIndex The index of the face of a geometry.You can easily get this index using the [Raycaster](https://threejs.org/docs/#api/en/core/Raycaster).\r\n     */\r\n    getExpressId(geometry: BufferGeometry, faceIndex: number) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        return this.ifcManager.getExpressId(geometry, faceIndex);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.getAllItemsOfType` instead.\r\n     *\r\n     * Returns all items of the specified type. You can import\r\n     * the types from *web-ifc*.\r\n     *\r\n     * Example to get all the standard walls of a project:\r\n     * ```js\r\n     * import { IFCWALLSTANDARDCASE } from 'web-ifc';\r\n     * const walls = ifcLoader.getAllItemsOfType(IFCWALLSTANDARDCASE);\r\n     * ```\r\n     * @type The type of IFC items to get.\r\n     * @verbose If false (default), this only gets IDs. If true, this also gets the native properties of all the fetched items.\r\n     */\r\n    getAllItemsOfType(type: number, verbose: boolean) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        return this.ifcManager.getAllItemsOfType(this.modelID, type, verbose);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.getItemProperties` instead.\r\n     *\r\n     * Gets the native properties of the given element.\r\n     * @id Express ID of the element.\r\n     * @recursive Wether you want to get the information of the referenced elements recursively.\r\n     */\r\n    getItemProperties(id: number, recursive = false) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        return this.ifcManager.getItemProperties(this.modelID, id, recursive);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.getPropertySets` instead.\r\n     *\r\n     * Gets the [property sets](https://standards.buildingsmart.org/IFC/DEV/IFC4_2/FINAL/HTML/schema/ifckernel/lexical/ifcpropertyset.htm)\r\n     * assigned to the given element.\r\n     * @id Express ID of the element.\r\n     * @recursive If true, this gets the native properties of the referenced elements recursively.\r\n     */\r\n    getPropertySets(id: number, recursive = false) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        return this.ifcManager.getPropertySets(this.modelID, id, recursive);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.getTypeProperties` instead.\r\n     *\r\n     * Gets the properties of the type assigned to the element.\r\n     * For example, if applied to a wall (IfcWall), this would get back the information\r\n     * contained in the IfcWallType assigned to it, if any.\r\n     * @id Express ID of the element.\r\n     * @recursive If true, this gets the native properties of the referenced elements recursively.\r\n     */\r\n    getTypeProperties(id: number, recursive = false) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        return this.ifcManager.getTypeProperties(this.modelID, id, recursive);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.getIfcType` instead.\r\n     *\r\n     * Gets the ifc type of the specified item.\r\n     * @id Express ID of the element.\r\n     */\r\n    getIfcType(id: number) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        return this.ifcManager.getIfcType(this.modelID, id);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.getSpatialStructure` instead.\r\n     *\r\n     * Gets the spatial structure of the project. The\r\n     * [spatial structure](https://standards.buildingsmart.org/IFC/DEV/IFC4_2/FINAL/HTML/schema/ifcproductextension/lexical/ifcspatialstructureelement.htm)\r\n     * is the hierarchical structure that organizes every IFC project (all physical items\r\n     * are referenced to an element of the spatial structure). It is formed by\r\n     * one IfcProject that contains one or more IfcSites, that contain one or more\r\n     * IfcBuildings, that contain one or more IfcBuildingStoreys, that contain\r\n     * one or more IfcSpaces.\r\n     */\r\n    getSpatialStructure() {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        return this.ifcManager.getSpatialStructure(this.modelID);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.getSubset` instead.\r\n     *\r\n     * Gets the mesh of the subset with the specified [material](https://threejs.org/docs/#api/en/materials/Material).\r\n     * If no material is given, this returns the subset with the original materials.\r\n     * @material Material assigned to the subset, if any.\r\n     */\r\n    getSubset(material?: Material) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        return this.ifcManager.getSubset(this.modelID, material);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.removeSubset` instead.\r\n     *\r\n     * Removes the specified subset.\r\n     * @parent The parent where the subset is (can be any `THREE.Object3D`).\r\n     * @material Material assigned to the subset, if any.\r\n     */\r\n    removeSubset(parent?: Object3D, material?: Material) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        this.ifcManager.removeSubset(this.modelID, parent, material);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.createSubset` instead.\r\n     *\r\n     * Creates a new geometric subset.\r\n     * @config A configuration object with the following options:\r\n     * - **scene**: `THREE.Object3D` where the model is located.\r\n     * - **ids**: Express IDs of the items of the model that will conform the subset.\r\n     * - **removePrevious**: Wether to remove the previous subset of this model with this material.\r\n     * - **material**: (optional) Wether to apply a material to the subset\r\n     */\r\n    createSubset(config: HighlightConfig) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        const modelConfig = { ...config, modelID: this.modelID };\r\n        return this.ifcManager.createSubset(modelConfig);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.hideItems` instead.\r\n     *\r\n     * Hides the selected items in the specified model\r\n     * @ids Express ID of the elements.\r\n     */\r\n    hideItems(ids: number[]) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        this.ifcManager.hideItems(this.modelID, ids);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.hideAllItems` instead.\r\n     *\r\n     * Hides all the items of the specified model\r\n     */\r\n    hideAllItems() {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        this.ifcManager.hideAllItems(this.modelID);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.showItems` instead.\r\n     *\r\n     * Hides all the items of the specified model\r\n     * @ids Express ID of the elements.\r\n     */\r\n    showItems(ids: number[]) {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        this.ifcManager.showItems(this.modelID, ids);\r\n    }\r\n\r\n    /**\r\n     * @deprecated Use `IfcModel.ifcManager.showAllItems` instead.\r\n     *\r\n     * Shows all the items of the specified model\r\n     */\r\n    showAllItems() {\r\n        if (this.ifcManager === null) throw new Error(nullIfcManagerErrorMessage);\r\n        this.ifcManager.showAllItems(this.modelID);\r\n    }\r\n}\r\n","//@ts-ignore\r\nimport { PlacedGeometry, Color as ifcColor, IfcGeometry, IFCSPACE, FlatMesh, IFCOPENINGELEMENT } from 'web-ifc';\r\nimport {\r\n    IfcState,\r\n    IfcMesh,\r\n    IdAttrName,\r\n    merge,\r\n    newFloatAttr,\r\n    newIntAttr\r\n} from '../BaseDefinitions';\r\nimport {\r\n    Color,\r\n    MeshLambertMaterial,\r\n    DoubleSide,\r\n    Matrix4,\r\n    BufferGeometry,\r\n    BufferAttribute,\r\n    Material\r\n} from 'three';\r\nimport {BvhManager} from './BvhManager';\r\nimport {IFCModel} from './IFCModel';\r\n\r\nexport interface ParserProgress {\r\n    loaded: number;\r\n    total: number;\r\n}\r\n\r\nexport interface OptionalCategories {\r\n    [category: number]: boolean\r\n}\r\n\r\nexport interface ParserAPI {\r\n    parse(buffer: any, coordinationMatrix?: number[]): Promise<IFCModel>;\r\n\r\n    getAndClearErrors(_modelId: number): void;\r\n\r\n    setupOptionalCategories(config: OptionalCategories): void;\r\n}\r\n\r\n/**\r\n * Reads all the geometry of the IFC file and generates an optimized `THREE.Mesh`.\r\n */\r\nexport class IFCParser implements ParserAPI {\r\n    loadedModels = 0;\r\n\r\n    optionalCategories: OptionalCategories = {\r\n        [IFCSPACE]: true,\r\n        [IFCOPENINGELEMENT]: false\r\n    }\r\n\r\n    // Represents the index of the model in webIfcAPI\r\n    private currentWebIfcID = -1;\r\n    // When using JSON data for optimization, webIfcAPI is reinitialized every time a model is loaded\r\n    // This means that currentID is always 0, while currentModelID is the real index of stored models\r\n    private currentModelID = -1;\r\n\r\n    // BVH is optional because when using workers we have to apply it in the main thread,\r\n    // once the model has been serialized and reconstructed\r\n    constructor(private state: IfcState, private BVH?: BvhManager) {\r\n    }\r\n\r\n    async setupOptionalCategories(config: OptionalCategories) {\r\n        this.optionalCategories = config;\r\n    }\r\n\r\n    async parse(buffer: any, coordinationMatrix?: number[]) {\r\n        if (this.state.api.wasmModule === undefined) await this.state.api.Init();\r\n        await this.newIfcModel(buffer);\r\n        this.loadedModels++;\r\n        if(coordinationMatrix){\r\n            await this.state.api.SetGeometryTransformation(this.currentWebIfcID, coordinationMatrix);\r\n        }\r\n        return this.loadAllGeometry();\r\n    }\r\n\r\n    getAndClearErrors(_modelId: number) {\r\n        // return this.state.api.GetAndClearErrors(modelId);\r\n    }\r\n\r\n    private notifyProgress(loaded: number, total: number) {\r\n        if (this.state.onProgress) this.state.onProgress({loaded, total});\r\n    }\r\n\r\n    private async newIfcModel(buffer: any) {\r\n        const data = new Uint8Array(buffer);\r\n        this.currentWebIfcID = await this.state.api.OpenModel(data, this.state.webIfcSettings);\r\n        this.currentModelID = this.state.useJSON ? this.loadedModels : this.currentWebIfcID;\r\n        this.state.models[this.currentModelID] = {\r\n            modelID: this.currentModelID,\r\n            mesh: {} as IfcMesh,\r\n            items: {},\r\n            types: {},\r\n            jsonData: {}\r\n        };\r\n    }\r\n\r\n    private async loadAllGeometry() {\r\n        await this.saveAllPlacedGeometriesByMaterial();\r\n        return this.generateAllGeometriesByMaterial();\r\n    }\r\n\r\n    private generateAllGeometriesByMaterial() {\r\n        const {geometry, materials} = this.getGeometryAndMaterials();\r\n        if(this.BVH) this.BVH.applyThreeMeshBVH(geometry);\r\n        const mesh = new IFCModel(geometry, materials);\r\n        mesh.modelID = this.currentModelID;\r\n        this.state.models[this.currentModelID].mesh = mesh;\r\n        return mesh;\r\n    }\r\n\r\n    private getGeometryAndMaterials() {\r\n        const items = this.state.models[this.currentModelID].items;\r\n        const mergedByMaterial: BufferGeometry[] = [];\r\n        const materials: Material[] = [];\r\n        for (let materialID in items) {\r\n            if (items.hasOwnProperty(materialID)) {\r\n                materials.push(items[materialID].material);\r\n                const geometries = Object.values(items[materialID].geometries);\r\n                mergedByMaterial.push(merge(geometries));\r\n            }\r\n        }\r\n        const geometry = merge(mergedByMaterial, true);\r\n        return {geometry, materials};\r\n    }\r\n\r\n    private async saveAllPlacedGeometriesByMaterial() {\r\n\r\n        await this.addOptionalCategories();\r\n\r\n        const flatMeshes = await this.state.api.LoadAllGeometry(this.currentWebIfcID);\r\n        const size = flatMeshes.size();\r\n        let counter = 0;\r\n        for (let i = 0; i < size; i++) {\r\n            if(i > counter) {\r\n                this.notifyProgress(i, size);\r\n                counter += Math.trunc(size / 10);\r\n            }\r\n            const flatMesh = flatMeshes.get(i);\r\n            const placedGeom = flatMesh.geometries;\r\n            for (let j = 0; j < placedGeom.size(); j++) {\r\n                await this.savePlacedGeometry(placedGeom.get(j), flatMesh.expressID);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Temporary: in the future everything will use StreamAllMeshes()\r\n    private async addOptionalCategories() {\r\n\r\n        const optionalTypes: number[] =[];\r\n\r\n        for(let key in this.optionalCategories) {\r\n            if(this.optionalCategories.hasOwnProperty(key)) {\r\n                const category = parseInt(key);\r\n                if(this.optionalCategories[category]) optionalTypes.push(category);\r\n            }\r\n        }\r\n\r\n        await this.state.api.StreamAllMeshesWithTypes(this.currentWebIfcID, optionalTypes, async (mesh: FlatMesh) => {\r\n            const geometries = mesh.geometries;\r\n            const size = geometries.size();\r\n            for (let j = 0; j < size; j++) {\r\n                await this.savePlacedGeometry(geometries.get(j), mesh.expressID);\r\n            }\r\n        });\r\n    }\r\n\r\n    private async savePlacedGeometry(placedGeometry: PlacedGeometry, id: number) {\r\n        const geometry = await this.getGeometry(placedGeometry);\r\n        this.saveGeometryByMaterial(geometry, placedGeometry, id);\r\n    }\r\n\r\n    private async getGeometry(placedGeometry: PlacedGeometry) {\r\n        const geometry = await this.getBufferGeometry(placedGeometry);\r\n        geometry.computeVertexNormals();\r\n        const matrix = IFCParser.getMeshMatrix(placedGeometry.flatTransformation);\r\n        geometry.applyMatrix4(matrix);\r\n        return geometry;\r\n    }\r\n\r\n    private async getBufferGeometry(placed: PlacedGeometry) {\r\n        const geometry = await this.state.api.GetGeometry(this.currentWebIfcID, placed.geometryExpressID);\r\n        const vertexData = await this.getVertices(geometry);\r\n        const indices = await this.getIndices(geometry);\r\n        const {vertices, normals} = IFCParser.extractVertexData(vertexData);\r\n        return IFCParser.ifcGeomToBufferGeom(vertices, normals, indices);\r\n    }\r\n\r\n    private async getVertices(geometry: IfcGeometry) {\r\n        const vData = geometry.GetVertexData();\r\n        const vDataSize = geometry.GetVertexDataSize();\r\n        return this.state.api.GetVertexArray(vData, vDataSize);\r\n    }\r\n\r\n    private async getIndices(geometry: IfcGeometry) {\r\n        const iData = geometry.GetIndexData();\r\n        const iDataSize = geometry.GetIndexDataSize();\r\n        return this.state.api.GetIndexArray(iData, iDataSize);\r\n    }\r\n\r\n    private static getMeshMatrix(matrix: number[]) {\r\n        const mat = new Matrix4();\r\n        mat.fromArray(matrix);\r\n        return mat;\r\n    }\r\n\r\n    private static ifcGeomToBufferGeom(vertices: any[], normals: any[], indexData: any) {\r\n        const geometry = new BufferGeometry();\r\n        geometry.setAttribute('position', newFloatAttr(vertices, 3));\r\n        geometry.setAttribute('normal', newFloatAttr(normals, 3));\r\n        geometry.setIndex(new BufferAttribute(indexData, 1));\r\n        return geometry;\r\n    }\r\n\r\n    private static extractVertexData(vertexData: any) {\r\n        const vertices = [];\r\n        const normals = [];\r\n        let isNormalData = false;\r\n        for (let i = 0; i < vertexData.length; i++) {\r\n            isNormalData ? normals.push(vertexData[i]) : vertices.push(vertexData[i]);\r\n            if ((i + 1) % 3 == 0) isNormalData = !isNormalData;\r\n        }\r\n        return {vertices, normals};\r\n    }\r\n\r\n    private saveGeometryByMaterial(geom: BufferGeometry, placedGeom: PlacedGeometry, id: number) {\r\n        const color = placedGeom.color;\r\n        const colorID = `${color.x}${color.y}${color.z}${color.w}`;\r\n        IFCParser.storeGeometryAttribute(id, geom);\r\n        this.createMaterial(colorID, color);\r\n        const item = this.state.models[this.currentModelID].items[colorID];\r\n        const currentGeom = item.geometries[id];\r\n        if (!currentGeom) return (item.geometries[id] = geom);\r\n        item.geometries[id] = merge([currentGeom, geom]);\r\n    }\r\n\r\n    private static storeGeometryAttribute(id: number, geometry: BufferGeometry) {\r\n        const size = geometry.attributes.position.count;\r\n        const idAttribute = new Array(size).fill(id);\r\n        geometry.setAttribute(IdAttrName, newIntAttr(idAttribute, 1));\r\n    }\r\n\r\n    private createMaterial(colorID: string, color: ifcColor) {\r\n        const items = this.state.models[this.currentModelID].items;\r\n        if (items[colorID]) return;\r\n        const col = new Color(color.x, color.y, color.z);\r\n        const newMaterial = new MeshLambertMaterial({color: col, side: DoubleSide});\r\n        newMaterial.transparent = color.w !== 1;\r\n        if (newMaterial.transparent) newMaterial.opacity = color.w;\r\n        items[colorID] = {material: newMaterial, geometries: {}};\r\n    }\r\n}\r\n","import { BufferGeometry, Material, Mesh, Object3D } from 'three';\r\nimport {\r\n    DEFAULT,\r\n    GeometriesByMaterials,\r\n    HighlightConfigOfModel,\r\n    IdGeometries,\r\n    IfcState,\r\n    merge,\r\n    SelectedItems\r\n} from '../BaseDefinitions';\r\nimport { BvhManager } from './BvhManager';\r\n\r\n\r\n/**\r\n * Contains the logic to get, create and delete geometric subsets of an IFC model. For example,\r\n * this can extract all the items in a specific IfcBuildingStorey and create a new Mesh.\r\n */\r\nexport class SubsetManager {\r\n    private state: IfcState;\r\n    private BVH: BvhManager;\r\n    private selected: SelectedItems = {};\r\n\r\n    constructor(state: IfcState, BVH: BvhManager) {\r\n        this.state = state;\r\n        this.BVH = BVH;\r\n    }\r\n\r\n    dispose() {\r\n        // @ts-ignore\r\n        // this.BVH = null;\r\n        // const items = Object.values(this.selected);\r\n        // items.forEach(item => {\r\n        //     const mesh = item.mesh;\r\n        //     mesh.geometry.dispose();\r\n        //     Array.isArray(mesh.material) ?\r\n        //         mesh.material.forEach(mat => mat.dispose()) :\r\n        //         mesh.material.dispose();\r\n        // });\r\n        // this.selected = {};\r\n    }\r\n\r\n    getSubset(modelID: number, material?: Material, customId?: string) {\r\n        const currentMat = this.matIDNoConfig(modelID, material, customId);\r\n        return this.selected[currentMat].mesh || null;\r\n    }\r\n\r\n    removeSubset(modelID: number, parent?: Object3D, material?: Material, customId?: string) {\r\n        const currentMat = this.matIDNoConfig(modelID, material, customId);\r\n        if (!this.selected[currentMat]) return;\r\n        if (parent) parent.remove(this.selected[currentMat].mesh);\r\n\r\n        // const mesh = this.selected[currentMat].mesh;\r\n        // mesh.geometry.dispose();\r\n        // mesh.geometry = {} as any;\r\n        //\r\n        // if(!Array.isArray(mesh.material)) mesh.material.dispose();\r\n        // else mesh.material.forEach(mat => mat.dispose());\r\n        // mesh.material = {} as any;\r\n\r\n        delete this.selected[currentMat];\r\n    }\r\n\r\n    createSubset(config: HighlightConfigOfModel) {\r\n        this.checkConfigValid(config);\r\n        if (this.isPreviousSelection(config)) return;\r\n        if (this.isEasySelection(config)) return this.addToPreviousSelection(config);\r\n        this.updatePreviousSelection(config.scene, config);\r\n        return this.createSelectionInScene(config);\r\n    }\r\n\r\n    private createSelectionInScene(config: HighlightConfigOfModel) {\r\n        const filtered = this.filter(config);\r\n        const { geomsByMaterial, materials } = this.getGeomAndMat(filtered);\r\n        if (geomsByMaterial.length <= 0) return null;\r\n        const isDefMaterial = this.isDefaultMat(config);\r\n        const geometry = this.getMergedGeometry(geomsByMaterial, isDefMaterial);\r\n        const mats = isDefMaterial ? materials : config.material;\r\n        this.BVH.applyThreeMeshBVH(geometry);\r\n        //@ts-ignore\r\n        const mesh = new Mesh(geometry, mats);\r\n        this.selected[this.matID(config)].mesh = mesh;\r\n        //@ts-ignore\r\n        mesh.modelID = config.modelID;\r\n        config.scene.add(mesh);\r\n        return mesh;\r\n    }\r\n\r\n    private getMergedGeometry(geomsByMaterial: BufferGeometry[], hasDefaultMaterial: boolean) {\r\n        return geomsByMaterial.length > 0\r\n            ? merge(geomsByMaterial, hasDefaultMaterial)\r\n            : new BufferGeometry();\r\n    }\r\n\r\n    private checkConfigValid(config: HighlightConfigOfModel) {\r\n        this.checkValidConfigParam(config.scene);\r\n        this.checkValidConfigParam(config.modelID);\r\n        this.checkValidConfigParam(config.ids);\r\n        this.checkValidConfigParam(config.removePrevious);\r\n        if (config.ids.length <= 0) {\r\n            throw new Error('Error: config parameter ids cannot be empty');\r\n        }\r\n    }\r\n\r\n    private checkValidConfigParam(item: any) {\r\n        if (item === undefined || item === null) throw new Error(`Error with subset config parameter: ${item}`);\r\n    }\r\n\r\n    private getGeomAndMat(filtered: GeometriesByMaterials) {\r\n        const geomsByMaterial: BufferGeometry[] = [];\r\n        const materials: Material[] = [];\r\n        for (let matID in filtered) {\r\n            let geoms = Object.values(filtered[matID].geometries);\r\n            geoms = geoms.filter(geom => Object.values(geom.attributes).length > 0);\r\n            if (!geoms.length) continue;\r\n            materials.push(filtered[matID].material);\r\n            if (geoms.length > 1) geomsByMaterial.push(merge(geoms));\r\n            else geomsByMaterial.push(...geoms);\r\n        }\r\n        return { geomsByMaterial, materials };\r\n    }\r\n\r\n    private updatePreviousSelection(parent: Object3D, config: HighlightConfigOfModel) {\r\n        const previous = this.selected[this.matID(config)];\r\n        if (!previous) return this.newSelectionGroup(config);\r\n        parent.remove(previous.mesh);\r\n        config.removePrevious\r\n            ? (previous.ids = new Set(config.ids))\r\n            : config.ids.forEach((id) => previous.ids.add(id));\r\n    }\r\n\r\n    private newSelectionGroup(config: HighlightConfigOfModel) {\r\n        this.selected[this.matID(config)] = {\r\n            ids: new Set(config.ids),\r\n            mesh: {} as Mesh\r\n        };\r\n    }\r\n\r\n    private isPreviousSelection(config: HighlightConfigOfModel) {\r\n        if (!this.selected[this.matID(config)]) return false;\r\n        if (this.containsIds(config)) return true;\r\n        const previousIds = this.selected[this.matID(config)].ids;\r\n        return JSON.stringify(config.ids) === JSON.stringify(previousIds);\r\n    }\r\n\r\n    private containsIds(config: HighlightConfigOfModel) {\r\n        const newIds = config.ids;\r\n        const previous = Array.from(this.selected[this.matID(config)].ids);\r\n        // prettier-ignore\r\n        //@ts-ignore\r\n        return newIds.every((i => v => (i = previous.indexOf(v, i) + 1))(0));\r\n    }\r\n\r\n    private addToPreviousSelection(config: HighlightConfigOfModel) {\r\n        const previous = this.selected[this.matID(config)];\r\n        const filtered = this.filter(config, new Set(config.ids));\r\n        // @ts-ignore\r\n        // prettier-ignore\r\n        const geometries = Object.values(filtered).map((i) => Object.values(i.geometries)).flat();\r\n        const previousGeom = previous.mesh.geometry;\r\n        previous.mesh.geometry = merge([previousGeom, ...geometries]);\r\n        config.ids.forEach((id) => previous.ids.add(id));\r\n    }\r\n\r\n    private filter(config: HighlightConfigOfModel, itemsID?: Set<number>) {\r\n        const ids = itemsID || this.selected[this.matID(config)].ids;\r\n        const items = this.state.models[config.modelID].items;\r\n        const filtered: GeometriesByMaterials = {};\r\n        for (let matID in items) {\r\n            filtered[matID] = {\r\n                material: items[matID].material,\r\n                geometries: this.filterGeometries(ids, items[matID].geometries)\r\n            };\r\n        }\r\n        return filtered;\r\n    }\r\n\r\n    private filterGeometries(selectedIDs: Set<number>, geometries: IdGeometries) {\r\n        const ids = Array.from(selectedIDs);\r\n        return Object.keys(geometries)\r\n            .filter((key) => ids.includes(parseInt(key, 10)))\r\n            .reduce((obj, key) => {\r\n                //@ts-ignore\r\n                return { ...obj, [key]: geometries[key] };\r\n            }, {});\r\n    }\r\n\r\n    private isEasySelection(config: HighlightConfigOfModel) {\r\n        const matID = this.matID(config);\r\n        if (!config.removePrevious && !this.isDefaultMat(config) && this.selected[matID]) return true;\r\n    }\r\n\r\n    private isDefaultMat(config: HighlightConfigOfModel) {\r\n        const id = this.matIDNoConfig(config.modelID, undefined, config.customId);\r\n        const id2 = this.matID(config);\r\n        return id === id2;\r\n    }\r\n\r\n    private matID(config: HighlightConfigOfModel) {\r\n        let name;\r\n        if (!config.material) name = DEFAULT;\r\n        else name = config.material.uuid;\r\n        name += ' - ' + (config.customId || \"\");\r\n        return name.concat(' - ').concat(config.modelID.toString());\r\n    }\r\n\r\n    private matIDNoConfig(modelID: number, material?: Material, customId = \"\") {\r\n        let name = DEFAULT;\r\n        if (material) name = material.uuid;\r\n        name += ' - ' + customId;\r\n        return name.concat(' - ').concat(modelID.toString());\r\n    }\r\n}\r\n","import { IfcState, pName, PropsNames, Node } from '../../BaseDefinitions';\r\n\r\nexport class BasePropertyManager {\r\n\r\n    constructor(protected state: IfcState) {\r\n    }\r\n\r\n    async getPropertySets(modelID: number, elementID: number, recursive = false) {\r\n        return await this.getProperty(modelID, elementID, recursive, PropsNames.psets);\r\n    }\r\n\r\n    async getTypeProperties(modelID: number, elementID: number, recursive = false) {\r\n        return await this.getProperty(modelID, elementID, recursive, PropsNames.type);\r\n    }\r\n\r\n    async getMaterialsProperties(modelID: number, elementID: number, recursive = false) {\r\n        return await this.getProperty(modelID, elementID, recursive, PropsNames.materials);\r\n    }\r\n\r\n    protected async getSpatialNode(modelID: number, node: Node, treeChunks: any, includeProperties?: boolean) {\r\n        await this.getChildren(modelID, node, treeChunks, PropsNames.aggregates, includeProperties);\r\n        await this.getChildren(modelID, node, treeChunks, PropsNames.spatial, includeProperties);\r\n    }\r\n\r\n    protected async getChildren(modelID: number, node: Node, treeChunks: any, propNames: pName, includeProperties?: boolean) {\r\n        const children = treeChunks[node.expressID];\r\n        if (children == undefined) return;\r\n        const prop = propNames.key as keyof Node;\r\n        const nodes: any[] = [];\r\n        for(let i = 0; i < children.length; i++){\r\n            const child = children[i];\r\n            let node = this.newNode(modelID, child);\r\n            if (includeProperties) {\r\n                const properties = await this.getItemProperties(modelID, node.expressID) as any;\r\n                node = { ...properties, ...node };\r\n            }\r\n            await this.getSpatialNode(modelID, node, treeChunks, includeProperties);\r\n            nodes.push(node);\r\n        }\r\n        (node[prop] as Node[]) = nodes;\r\n    }\r\n\r\n    protected newNode(modelID: number, id: number) {\r\n        const typeName = this.getNodeType(modelID, id);\r\n        return {\r\n            expressID: id,\r\n            type: typeName,\r\n            children: []\r\n        };\r\n    }\r\n\r\n    protected async getSpatialTreeChunks(modelID: number) {\r\n        const treeChunks: any = {};\r\n        await this.getChunks(modelID, treeChunks, PropsNames.aggregates);\r\n        await this.getChunks(modelID, treeChunks, PropsNames.spatial);\r\n        return treeChunks;\r\n    }\r\n\r\n    protected saveChunk(chunks: any, propNames: pName, rel: any) {\r\n        const relating = rel[propNames.relating].value;\r\n        const related = rel[propNames.related].map((r: any) => r.value);\r\n        if (chunks[relating] == undefined) {\r\n            chunks[relating] = related;\r\n        } else {\r\n            chunks[relating] = chunks[relating].concat(related);\r\n        }\r\n    }\r\n\r\n    protected getRelated(rel: any, propNames: pName, IDs: number[]) {\r\n        const element = rel[propNames.relating];\r\n        if (!Array.isArray(element)) IDs.push(element.value);\r\n        else element.forEach((ele) => IDs.push(ele.value));\r\n    }\r\n\r\n    protected static isRelated(id: number, rel: any, propNames: pName) {\r\n        const relatedItems = rel[propNames.related];\r\n        if (Array.isArray(relatedItems)) {\r\n            const values = relatedItems.map((item) => item.value);\r\n            return values.includes(id);\r\n        }\r\n        return relatedItems.value === id;\r\n    }\r\n\r\n    protected static newIfcProject(id: number) {\r\n        return {\r\n            expressID: id,\r\n            type: 'IFCPROJECT',\r\n            children: []\r\n        };\r\n    }\r\n\r\n    async getProperty(modelID: number, elementID: number, recursive = false, propName: pName): Promise<any> {\r\n    }\r\n\r\n    protected async getChunks(modelID: number, chunks: any, propNames: pName): Promise<void> {\r\n    }\r\n\r\n    protected async getItemProperties(modelID: number, expressID: number, recursive = false): Promise<any> {\r\n    }\r\n\r\n    protected getNodeType(modelID: number, id: number): any {\r\n    }\r\n}","export const IfcElements: {[key: number]: string} = {\r\n  103090709: 'IFCPROJECT',\r\n  4097777520: 'IFCSITE',\r\n  4031249490: 'IFCBUILDING',\r\n  3124254112: 'IFCBUILDINGSTOREY',\r\n  3856911033: 'IFCSPACE',\r\n  1674181508: 'IFCANNOTATION',\r\n  25142252: 'IFCCONTROLLER',\r\n  32344328: 'IFCBOILER',\r\n  76236018: 'IFCLAMP',\r\n  90941305: 'IFCPUMP',\r\n  177149247: 'IFCAIRTERMINALBOX',\r\n  182646315: 'IFCFLOWINSTRUMENT',\r\n  263784265: 'IFCFURNISHINGELEMENT',\r\n  264262732: 'IFCELECTRICGENERATOR',\r\n  277319702: 'IFCAUDIOVISUALAPPLIANCE',\r\n  310824031: 'IFCPIPEFITTING',\r\n  331165859: 'IFCSTAIR',\r\n  342316401: 'IFCDUCTFITTING',\r\n  377706215: 'IFCMECHANICALFASTENER',\r\n  395920057: 'IFCDOOR',\r\n  402227799: 'IFCELECTRICMOTOR',\r\n  413509423: 'IFCSYSTEMFURNITUREELEMENT',\r\n  484807127: 'IFCEVAPORATOR',\r\n  486154966: 'IFCWINDOWSTANDARDCASE',\r\n  629592764: 'IFCLIGHTFIXTURE',\r\n  630975310: 'IFCUNITARYCONTROLELEMENT',\r\n  635142910: 'IFCCABLECARRIERFITTING',\r\n  639361253: 'IFCCOIL',\r\n  647756555: 'IFCFASTENER',\r\n  707683696: 'IFCFLOWSTORAGEDEVICE',\r\n  738039164: 'IFCPROTECTIVEDEVICE',\r\n  753842376: 'IFCBEAM',\r\n  812556717: 'IFCTANK',\r\n  819412036: 'IFCFILTER',\r\n  843113511: 'IFCCOLUMN',\r\n  862014818: 'IFCELECTRICDISTRIBUTIONBOARD',\r\n  900683007: 'IFCFOOTING',\r\n  905975707: 'IFCCOLUMNSTANDARDCASE',\r\n  926996030: 'IFCVOIDINGFEATURE',\r\n  979691226: 'IFCREINFORCINGBAR',\r\n  987401354: 'IFCFLOWSEGMENT',\r\n  1003880860: 'IFCELECTRICTIMECONTROL',\r\n  1051757585: 'IFCCABLEFITTING',\r\n  1052013943: 'IFCDISTRIBUTIONCHAMBERELEMENT',\r\n  1062813311: 'IFCDISTRIBUTIONCONTROLELEMENT',\r\n  1073191201: 'IFCMEMBER',\r\n  1095909175: 'IFCBUILDINGELEMENTPROXY',\r\n  1156407060: 'IFCPLATESTANDARDCASE',\r\n  1162798199: 'IFCSWITCHINGDEVICE',\r\n  1329646415: 'IFCSHADINGDEVICE',\r\n  1335981549: 'IFCDISCRETEACCESSORY',\r\n  1360408905: 'IFCDUCTSILENCER',\r\n  1404847402: 'IFCSTACKTERMINAL',\r\n  1426591983: 'IFCFIRESUPPRESSIONTERMINAL',\r\n  1437502449: 'IFCMEDICALDEVICE',\r\n  1509553395: 'IFCFURNITURE',\r\n  1529196076: 'IFCSLAB',\r\n  1620046519: 'IFCTRANSPORTELEMENT',\r\n  1634111441: 'IFCAIRTERMINAL',\r\n  1658829314: 'IFCENERGYCONVERSIONDEVICE',\r\n  1677625105: 'IFCCIVILELEMENT',\r\n  1687234759: 'IFCPILE',\r\n  1904799276: 'IFCELECTRICAPPLIANCE',\r\n  1911478936: 'IFCMEMBERSTANDARDCASE',\r\n  1945004755: 'IFCDISTRIBUTIONELEMENT',\r\n  1973544240: 'IFCCOVERING',\r\n  1999602285: 'IFCSPACEHEATER',\r\n  2016517767: 'IFCROOF',\r\n  2056796094: 'IFCAIRTOAIRHEATRECOVERY',\r\n  2058353004: 'IFCFLOWCONTROLLER',\r\n  2068733104: 'IFCHUMIDIFIER',\r\n  2176052936: 'IFCJUNCTIONBOX',\r\n  2188021234: 'IFCFLOWMETER',\r\n  2223149337: 'IFCFLOWTERMINAL',\r\n  2262370178: 'IFCRAILING',\r\n  2272882330: 'IFCCONDENSER',\r\n  2295281155: 'IFCPROTECTIVEDEVICETRIPPINGUNIT',\r\n  2320036040: 'IFCREINFORCINGMESH',\r\n  2347447852: 'IFCTENDONANCHOR',\r\n  2391383451: 'IFCVIBRATIONISOLATOR',\r\n  2391406946: 'IFCWALL',\r\n  2474470126: 'IFCMOTORCONNECTION',\r\n  2769231204: 'IFCVIRTUALELEMENT',\r\n  2814081492: 'IFCENGINE',\r\n  2906023776: 'IFCBEAMSTANDARDCASE',\r\n  2938176219: 'IFCBURNER',\r\n  2979338954: 'IFCBUILDINGELEMENTPART',\r\n  3024970846: 'IFCRAMP',\r\n  3026737570: 'IFCTUBEBUNDLE',\r\n  3027962421: 'IFCSLABSTANDARDCASE',\r\n  3040386961: 'IFCDISTRIBUTIONFLOWELEMENT',\r\n  3053780830: 'IFCSANITARYTERMINAL',\r\n  3079942009: 'IFCOPENINGSTANDARDCASE',\r\n  3087945054: 'IFCALARM',\r\n  3101698114: 'IFCSURFACEFEATURE',\r\n  3127900445: 'IFCSLABELEMENTEDCASE',\r\n  3132237377: 'IFCFLOWMOVINGDEVICE',\r\n  3171933400: 'IFCPLATE',\r\n  3221913625: 'IFCCOMMUNICATIONSAPPLIANCE',\r\n  3242481149: 'IFCDOORSTANDARDCASE',\r\n  3283111854: 'IFCRAMPFLIGHT',\r\n  3296154744: 'IFCCHIMNEY',\r\n  3304561284: 'IFCWINDOW',\r\n  3310460725: 'IFCELECTRICFLOWSTORAGEDEVICE',\r\n  3319311131: 'IFCHEATEXCHANGER',\r\n  3415622556: 'IFCFAN',\r\n  3420628829: 'IFCSOLARDEVICE',\r\n  3493046030: 'IFCGEOGRAPHICELEMENT',\r\n  3495092785: 'IFCCURTAINWALL',\r\n  3508470533: 'IFCFLOWTREATMENTDEVICE',\r\n  3512223829: 'IFCWALLSTANDARDCASE',\r\n  3518393246: 'IFCDUCTSEGMENT',\r\n  3571504051: 'IFCCOMPRESSOR',\r\n  3588315303: 'IFCOPENINGELEMENT',\r\n  3612865200: 'IFCPIPESEGMENT',\r\n  3640358203: 'IFCCOOLINGTOWER',\r\n  3651124850: 'IFCPROJECTIONELEMENT',\r\n  3694346114: 'IFCOUTLET',\r\n  3747195512: 'IFCEVAPORATIVECOOLER',\r\n  3758799889: 'IFCCABLECARRIERSEGMENT',\r\n  3824725483: 'IFCTENDON',\r\n  3825984169: 'IFCTRANSFORMER',\r\n  3902619387: 'IFCCHILLER',\r\n  4074379575: 'IFCDAMPER',\r\n  4086658281: 'IFCSENSOR',\r\n  4123344466: 'IFCELEMENTASSEMBLY',\r\n  4136498852: 'IFCCOOLEDBEAM',\r\n  4156078855: 'IFCWALLELEMENTEDCASE',\r\n  4175244083: 'IFCINTERCEPTOR',\r\n  4207607924: 'IFCVALVE',\r\n  4217484030: 'IFCCABLESEGMENT',\r\n  4237592921: 'IFCWASTETERMINAL',\r\n  4252922144: 'IFCSTAIRFLIGHT',\r\n  4278956645: 'IFCFLOWFITTING',\r\n  4288193352: 'IFCACTUATOR',\r\n  4292641817: 'IFCUNITARYEQUIPMENT',\r\n  3009204131: 'IFCGRID'\r\n};\r\n","import { BasePropertyManager } from './BasePropertyManager';\r\nimport { IFCPROJECT } from 'web-ifc';\r\nimport { pName } from '../../BaseDefinitions';\r\nimport { PropertyAPI } from './BaseDefinitions';\r\nimport { IfcElements } from '../IFCElementsMap';\r\n\r\nexport class WebIfcPropertyManager extends BasePropertyManager  implements PropertyAPI {\r\n    async getItemProperties(modelID: number, id: number, recursive = false) {\r\n        return this.state.api.GetLine(modelID, id, recursive);\r\n    }\r\n\r\n    async getSpatialStructure(modelID: number, includeProperties?: boolean) {\r\n        const chunks = await this.getSpatialTreeChunks(modelID);\r\n        const allLines = await this.state.api.GetLineIDsWithType(modelID, IFCPROJECT);\r\n        const projectID = allLines.get(0);\r\n        const project = WebIfcPropertyManager.newIfcProject(projectID);\r\n        await this.getSpatialNode(modelID, project, chunks, includeProperties);\r\n        return project;\r\n    }\r\n\r\n    async getAllItemsOfType(modelID: number, type: number, verbose: boolean) {\r\n        let items: number[] = [];\r\n        const lines = await this.state.api.GetLineIDsWithType(modelID, type);\r\n        for (let i = 0; i < lines.size(); i++) items.push(lines.get(i));\r\n        if (!verbose) return items;\r\n        const result: any[] = [];\r\n        for (let i = 0; i < items.length; i++) {\r\n            result.push(await this.state.api.GetLine(modelID, items[i]));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    override async getProperty(modelID: number, elementID: number, recursive = false, propName: pName) {\r\n        const propSetIds = await this.getAllRelatedItemsOfType(modelID, elementID, propName);\r\n        const result: any[] = [];\r\n        for (let i = 0; i < propSetIds.length; i++) {\r\n            result.push(await this.state.api.GetLine(modelID, propSetIds[i], recursive));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    protected override getNodeType(modelID: number, id: number) {\r\n        const typeID = this.state.models[modelID].types[id];\r\n        return IfcElements[typeID];\r\n    }\r\n\r\n    protected override async getChunks(modelID: number, chunks: any, propNames: pName) {\r\n        const relation = await this.state.api.GetLineIDsWithType(modelID, propNames.name);\r\n        for (let i = 0; i < relation.size(); i++) {\r\n            const rel = await this.state.api.GetLine(modelID, relation.get(i), false);\r\n            this.saveChunk(chunks, propNames, rel);\r\n        }\r\n    }\r\n\r\n    private async getAllRelatedItemsOfType(modelID: number, id: number, propNames: pName) {\r\n        const lines = await this.state.api.GetLineIDsWithType(modelID, propNames.name);\r\n        const IDs: number[] = [];\r\n        for (let i = 0; i < lines.size(); i++) {\r\n            const rel = await this.state.api.GetLine(modelID, lines.get(i));\r\n            const isRelated = BasePropertyManager.isRelated(id, rel, propNames);\r\n            if (isRelated) this.getRelated(rel, propNames, IDs);\r\n        }\r\n        return IDs;\r\n    }\r\n}","export const IfcTypesMap:  {[key: number]: string} = {\r\n    3821786052: \"IFCACTIONREQUEST\",\r\n    2296667514: \"IFCACTOR\",\r\n    3630933823: \"IFCACTORROLE\",\r\n    4288193352: \"IFCACTUATOR\",\r\n    2874132201: \"IFCACTUATORTYPE\",\r\n    618182010: \"IFCADDRESS\",\r\n    1635779807: \"IFCADVANCEDBREP\",\r\n    2603310189: \"IFCADVANCEDBREPWITHVOIDS\",\r\n    3406155212: \"IFCADVANCEDFACE\",\r\n    1634111441: \"IFCAIRTERMINAL\",\r\n    177149247: \"IFCAIRTERMINALBOX\",\r\n    1411407467: \"IFCAIRTERMINALBOXTYPE\",\r\n    3352864051: \"IFCAIRTERMINALTYPE\",\r\n    2056796094: \"IFCAIRTOAIRHEATRECOVERY\",\r\n    1871374353: \"IFCAIRTOAIRHEATRECOVERYTYPE\",\r\n    3087945054: \"IFCALARM\",\r\n    3001207471: \"IFCALARMTYPE\",\r\n    325726236: \"IFCALIGNMENT\",\r\n    749761778: \"IFCALIGNMENT2DHORIZONTAL\",\r\n    3199563722: \"IFCALIGNMENT2DHORIZONTALSEGMENT\",\r\n    2483840362: \"IFCALIGNMENT2DSEGMENT\",\r\n    3379348081: \"IFCALIGNMENT2DVERSEGCIRCULARARC\",\r\n    3239324667: \"IFCALIGNMENT2DVERSEGLINE\",\r\n    4263986512: \"IFCALIGNMENT2DVERSEGPARABOLICARC\",\r\n    53199957: \"IFCALIGNMENT2DVERTICAL\",\r\n    2029264950: \"IFCALIGNMENT2DVERTICALSEGMENT\",\r\n    3512275521: \"IFCALIGNMENTCURVE\",\r\n    1674181508: \"IFCANNOTATION\",\r\n    669184980: \"IFCANNOTATIONFILLAREA\",\r\n    639542469: \"IFCAPPLICATION\",\r\n    411424972: \"IFCAPPLIEDVALUE\",\r\n    130549933: \"IFCAPPROVAL\",\r\n    3869604511: \"IFCAPPROVALRELATIONSHIP\",\r\n    3798115385: \"IFCARBITRARYCLOSEDPROFILEDEF\",\r\n    1310608509: \"IFCARBITRARYOPENPROFILEDEF\",\r\n    2705031697: \"IFCARBITRARYPROFILEDEFWITHVOIDS\",\r\n    3460190687: \"IFCASSET\",\r\n    3207858831: \"IFCASYMMETRICISHAPEPROFILEDEF\",\r\n    277319702: \"IFCAUDIOVISUALAPPLIANCE\",\r\n    1532957894: \"IFCAUDIOVISUALAPPLIANCETYPE\",\r\n    4261334040: \"IFCAXIS1PLACEMENT\",\r\n    3125803723: \"IFCAXIS2PLACEMENT2D\",\r\n    2740243338: \"IFCAXIS2PLACEMENT3D\",\r\n    1967976161: \"IFCBSPLINECURVE\",\r\n    2461110595: \"IFCBSPLINECURVEWITHKNOTS\",\r\n    2887950389: \"IFCBSPLINESURFACE\",\r\n    167062518: \"IFCBSPLINESURFACEWITHKNOTS\",\r\n    753842376: \"IFCBEAM\",\r\n    2906023776: \"IFCBEAMSTANDARDCASE\",\r\n    819618141: \"IFCBEAMTYPE\",\r\n    4196446775: \"IFCBEARING\",\r\n    3649138523: \"IFCBEARINGTYPE\",\r\n    616511568: \"IFCBLOBTEXTURE\",\r\n    1334484129: \"IFCBLOCK\",\r\n    32344328: \"IFCBOILER\",\r\n    231477066: \"IFCBOILERTYPE\",\r\n    3649129432: \"IFCBOOLEANCLIPPINGRESULT\",\r\n    2736907675: \"IFCBOOLEANRESULT\",\r\n    4037036970: \"IFCBOUNDARYCONDITION\",\r\n    1136057603: \"IFCBOUNDARYCURVE\",\r\n    1560379544: \"IFCBOUNDARYEDGECONDITION\",\r\n    3367102660: \"IFCBOUNDARYFACECONDITION\",\r\n    1387855156: \"IFCBOUNDARYNODECONDITION\",\r\n    2069777674: \"IFCBOUNDARYNODECONDITIONWARPING\",\r\n    1260505505: \"IFCBOUNDEDCURVE\",\r\n    4182860854: \"IFCBOUNDEDSURFACE\",\r\n    2581212453: \"IFCBOUNDINGBOX\",\r\n    2713105998: \"IFCBOXEDHALFSPACE\",\r\n    644574406: \"IFCBRIDGE\",\r\n    963979645: \"IFCBRIDGEPART\",\r\n    4031249490: \"IFCBUILDING\",\r\n    3299480353: \"IFCBUILDINGELEMENT\",\r\n    2979338954: \"IFCBUILDINGELEMENTPART\",\r\n    39481116: \"IFCBUILDINGELEMENTPARTTYPE\",\r\n    1095909175: \"IFCBUILDINGELEMENTPROXY\",\r\n    1909888760: \"IFCBUILDINGELEMENTPROXYTYPE\",\r\n    1950629157: \"IFCBUILDINGELEMENTTYPE\",\r\n    3124254112: \"IFCBUILDINGSTOREY\",\r\n    1177604601: \"IFCBUILDINGSYSTEM\",\r\n    2938176219: \"IFCBURNER\",\r\n    2188180465: \"IFCBURNERTYPE\",\r\n    2898889636: \"IFCCSHAPEPROFILEDEF\",\r\n    635142910: \"IFCCABLECARRIERFITTING\",\r\n    395041908: \"IFCCABLECARRIERFITTINGTYPE\",\r\n    3758799889: \"IFCCABLECARRIERSEGMENT\",\r\n    3293546465: \"IFCCABLECARRIERSEGMENTTYPE\",\r\n    1051757585: \"IFCCABLEFITTING\",\r\n    2674252688: \"IFCCABLEFITTINGTYPE\",\r\n    4217484030: \"IFCCABLESEGMENT\",\r\n    1285652485: \"IFCCABLESEGMENTTYPE\",\r\n    3999819293: \"IFCCAISSONFOUNDATION\",\r\n    3203706013: \"IFCCAISSONFOUNDATIONTYPE\",\r\n    1123145078: \"IFCCARTESIANPOINT\",\r\n    574549367: \"IFCCARTESIANPOINTLIST\",\r\n    1675464909: \"IFCCARTESIANPOINTLIST2D\",\r\n    2059837836: \"IFCCARTESIANPOINTLIST3D\",\r\n    59481748: \"IFCCARTESIANTRANSFORMATIONOPERATOR\",\r\n    3749851601: \"IFCCARTESIANTRANSFORMATIONOPERATOR2D\",\r\n    3486308946: \"IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM\",\r\n    3331915920: \"IFCCARTESIANTRANSFORMATIONOPERATOR3D\",\r\n    1416205885: \"IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM\",\r\n    3150382593: \"IFCCENTERLINEPROFILEDEF\",\r\n    3902619387: \"IFCCHILLER\",\r\n    2951183804: \"IFCCHILLERTYPE\",\r\n    3296154744: \"IFCCHIMNEY\",\r\n    2197970202: \"IFCCHIMNEYTYPE\",\r\n    2611217952: \"IFCCIRCLE\",\r\n    2937912522: \"IFCCIRCLEHOLLOWPROFILEDEF\",\r\n    1383045692: \"IFCCIRCLEPROFILEDEF\",\r\n    1062206242: \"IFCCIRCULARARCSEGMENT2D\",\r\n    1677625105: \"IFCCIVILELEMENT\",\r\n    3893394355: \"IFCCIVILELEMENTTYPE\",\r\n    747523909: \"IFCCLASSIFICATION\",\r\n    647927063: \"IFCCLASSIFICATIONREFERENCE\",\r\n    2205249479: \"IFCCLOSEDSHELL\",\r\n    639361253: \"IFCCOIL\",\r\n    2301859152: \"IFCCOILTYPE\",\r\n    776857604: \"IFCCOLOURRGB\",\r\n    3285139300: \"IFCCOLOURRGBLIST\",\r\n    3264961684: \"IFCCOLOURSPECIFICATION\",\r\n    843113511: \"IFCCOLUMN\",\r\n    905975707: \"IFCCOLUMNSTANDARDCASE\",\r\n    300633059: \"IFCCOLUMNTYPE\",\r\n    3221913625: \"IFCCOMMUNICATIONSAPPLIANCE\",\r\n    400855858: \"IFCCOMMUNICATIONSAPPLIANCETYPE\",\r\n    2542286263: \"IFCCOMPLEXPROPERTY\",\r\n    3875453745: \"IFCCOMPLEXPROPERTYTEMPLATE\",\r\n    3732776249: \"IFCCOMPOSITECURVE\",\r\n    15328376: \"IFCCOMPOSITECURVEONSURFACE\",\r\n    2485617015: \"IFCCOMPOSITECURVESEGMENT\",\r\n    1485152156: \"IFCCOMPOSITEPROFILEDEF\",\r\n    3571504051: \"IFCCOMPRESSOR\",\r\n    3850581409: \"IFCCOMPRESSORTYPE\",\r\n    2272882330: \"IFCCONDENSER\",\r\n    2816379211: \"IFCCONDENSERTYPE\",\r\n    2510884976: \"IFCCONIC\",\r\n    370225590: \"IFCCONNECTEDFACESET\",\r\n    1981873012: \"IFCCONNECTIONCURVEGEOMETRY\",\r\n    2859738748: \"IFCCONNECTIONGEOMETRY\",\r\n    45288368: \"IFCCONNECTIONPOINTECCENTRICITY\",\r\n    2614616156: \"IFCCONNECTIONPOINTGEOMETRY\",\r\n    2732653382: \"IFCCONNECTIONSURFACEGEOMETRY\",\r\n    775493141: \"IFCCONNECTIONVOLUMEGEOMETRY\",\r\n    1959218052: \"IFCCONSTRAINT\",\r\n    3898045240: \"IFCCONSTRUCTIONEQUIPMENTRESOURCE\",\r\n    2185764099: \"IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE\",\r\n    1060000209: \"IFCCONSTRUCTIONMATERIALRESOURCE\",\r\n    4105962743: \"IFCCONSTRUCTIONMATERIALRESOURCETYPE\",\r\n    488727124: \"IFCCONSTRUCTIONPRODUCTRESOURCE\",\r\n    1525564444: \"IFCCONSTRUCTIONPRODUCTRESOURCETYPE\",\r\n    2559216714: \"IFCCONSTRUCTIONRESOURCE\",\r\n    2574617495: \"IFCCONSTRUCTIONRESOURCETYPE\",\r\n    3419103109: \"IFCCONTEXT\",\r\n    3050246964: \"IFCCONTEXTDEPENDENTUNIT\",\r\n    3293443760: \"IFCCONTROL\",\r\n    25142252: \"IFCCONTROLLER\",\r\n    578613899: \"IFCCONTROLLERTYPE\",\r\n    2889183280: \"IFCCONVERSIONBASEDUNIT\",\r\n    2713554722: \"IFCCONVERSIONBASEDUNITWITHOFFSET\",\r\n    4136498852: \"IFCCOOLEDBEAM\",\r\n    335055490: \"IFCCOOLEDBEAMTYPE\",\r\n    3640358203: \"IFCCOOLINGTOWER\",\r\n    2954562838: \"IFCCOOLINGTOWERTYPE\",\r\n    1785450214: \"IFCCOORDINATEOPERATION\",\r\n    1466758467: \"IFCCOORDINATEREFERENCESYSTEM\",\r\n    3895139033: \"IFCCOSTITEM\",\r\n    1419761937: \"IFCCOSTSCHEDULE\",\r\n    602808272: \"IFCCOSTVALUE\",\r\n    1973544240: \"IFCCOVERING\",\r\n    1916426348: \"IFCCOVERINGTYPE\",\r\n    3295246426: \"IFCCREWRESOURCE\",\r\n    1815067380: \"IFCCREWRESOURCETYPE\",\r\n    2506170314: \"IFCCSGPRIMITIVE3D\",\r\n    2147822146: \"IFCCSGSOLID\",\r\n    539742890: \"IFCCURRENCYRELATIONSHIP\",\r\n    3495092785: \"IFCCURTAINWALL\",\r\n    1457835157: \"IFCCURTAINWALLTYPE\",\r\n    2601014836: \"IFCCURVE\",\r\n    2827736869: \"IFCCURVEBOUNDEDPLANE\",\r\n    2629017746: \"IFCCURVEBOUNDEDSURFACE\",\r\n    1186437898: \"IFCCURVESEGMENT2D\",\r\n    3800577675: \"IFCCURVESTYLE\",\r\n    1105321065: \"IFCCURVESTYLEFONT\",\r\n    2367409068: \"IFCCURVESTYLEFONTANDSCALING\",\r\n    3510044353: \"IFCCURVESTYLEFONTPATTERN\",\r\n    1213902940: \"IFCCYLINDRICALSURFACE\",\r\n    4074379575: \"IFCDAMPER\",\r\n    3961806047: \"IFCDAMPERTYPE\",\r\n    3426335179: \"IFCDEEPFOUNDATION\",\r\n    1306400036: \"IFCDEEPFOUNDATIONTYPE\",\r\n    3632507154: \"IFCDERIVEDPROFILEDEF\",\r\n    1765591967: \"IFCDERIVEDUNIT\",\r\n    1045800335: \"IFCDERIVEDUNITELEMENT\",\r\n    2949456006: \"IFCDIMENSIONALEXPONENTS\",\r\n    32440307: \"IFCDIRECTION\",\r\n    1335981549: \"IFCDISCRETEACCESSORY\",\r\n    2635815018: \"IFCDISCRETEACCESSORYTYPE\",\r\n    1945343521: \"IFCDISTANCEEXPRESSION\",\r\n    1052013943: \"IFCDISTRIBUTIONCHAMBERELEMENT\",\r\n    1599208980: \"IFCDISTRIBUTIONCHAMBERELEMENTTYPE\",\r\n    562808652: \"IFCDISTRIBUTIONCIRCUIT\",\r\n    1062813311: \"IFCDISTRIBUTIONCONTROLELEMENT\",\r\n    2063403501: \"IFCDISTRIBUTIONCONTROLELEMENTTYPE\",\r\n    1945004755: \"IFCDISTRIBUTIONELEMENT\",\r\n    3256556792: \"IFCDISTRIBUTIONELEMENTTYPE\",\r\n    3040386961: \"IFCDISTRIBUTIONFLOWELEMENT\",\r\n    3849074793: \"IFCDISTRIBUTIONFLOWELEMENTTYPE\",\r\n    3041715199: \"IFCDISTRIBUTIONPORT\",\r\n    3205830791: \"IFCDISTRIBUTIONSYSTEM\",\r\n    1154170062: \"IFCDOCUMENTINFORMATION\",\r\n    770865208: \"IFCDOCUMENTINFORMATIONRELATIONSHIP\",\r\n    3732053477: \"IFCDOCUMENTREFERENCE\",\r\n    395920057: \"IFCDOOR\",\r\n    2963535650: \"IFCDOORLININGPROPERTIES\",\r\n    1714330368: \"IFCDOORPANELPROPERTIES\",\r\n    3242481149: \"IFCDOORSTANDARDCASE\",\r\n    526551008: \"IFCDOORSTYLE\",\r\n    2323601079: \"IFCDOORTYPE\",\r\n    445594917: \"IFCDRAUGHTINGPREDEFINEDCOLOUR\",\r\n    4006246654: \"IFCDRAUGHTINGPREDEFINEDCURVEFONT\",\r\n    342316401: \"IFCDUCTFITTING\",\r\n    869906466: \"IFCDUCTFITTINGTYPE\",\r\n    3518393246: \"IFCDUCTSEGMENT\",\r\n    3760055223: \"IFCDUCTSEGMENTTYPE\",\r\n    1360408905: \"IFCDUCTSILENCER\",\r\n    2030761528: \"IFCDUCTSILENCERTYPE\",\r\n    3900360178: \"IFCEDGE\",\r\n    476780140: \"IFCEDGECURVE\",\r\n    1472233963: \"IFCEDGELOOP\",\r\n    1904799276: \"IFCELECTRICAPPLIANCE\",\r\n    663422040: \"IFCELECTRICAPPLIANCETYPE\",\r\n    862014818: \"IFCELECTRICDISTRIBUTIONBOARD\",\r\n    2417008758: \"IFCELECTRICDISTRIBUTIONBOARDTYPE\",\r\n    3310460725: \"IFCELECTRICFLOWSTORAGEDEVICE\",\r\n    3277789161: \"IFCELECTRICFLOWSTORAGEDEVICETYPE\",\r\n    264262732: \"IFCELECTRICGENERATOR\",\r\n    1534661035: \"IFCELECTRICGENERATORTYPE\",\r\n    402227799: \"IFCELECTRICMOTOR\",\r\n    1217240411: \"IFCELECTRICMOTORTYPE\",\r\n    1003880860: \"IFCELECTRICTIMECONTROL\",\r\n    712377611: \"IFCELECTRICTIMECONTROLTYPE\",\r\n    1758889154: \"IFCELEMENT\",\r\n    4123344466: \"IFCELEMENTASSEMBLY\",\r\n    2397081782: \"IFCELEMENTASSEMBLYTYPE\",\r\n    1623761950: \"IFCELEMENTCOMPONENT\",\r\n    2590856083: \"IFCELEMENTCOMPONENTTYPE\",\r\n    1883228015: \"IFCELEMENTQUANTITY\",\r\n    339256511: \"IFCELEMENTTYPE\",\r\n    2777663545: \"IFCELEMENTARYSURFACE\",\r\n    1704287377: \"IFCELLIPSE\",\r\n    2835456948: \"IFCELLIPSEPROFILEDEF\",\r\n    1658829314: \"IFCENERGYCONVERSIONDEVICE\",\r\n    2107101300: \"IFCENERGYCONVERSIONDEVICETYPE\",\r\n    2814081492: \"IFCENGINE\",\r\n    132023988: \"IFCENGINETYPE\",\r\n    3747195512: \"IFCEVAPORATIVECOOLER\",\r\n    3174744832: \"IFCEVAPORATIVECOOLERTYPE\",\r\n    484807127: \"IFCEVAPORATOR\",\r\n    3390157468: \"IFCEVAPORATORTYPE\",\r\n    4148101412: \"IFCEVENT\",\r\n    211053100: \"IFCEVENTTIME\",\r\n    4024345920: \"IFCEVENTTYPE\",\r\n    297599258: \"IFCEXTENDEDPROPERTIES\",\r\n    4294318154: \"IFCEXTERNALINFORMATION\",\r\n    3200245327: \"IFCEXTERNALREFERENCE\",\r\n    1437805879: \"IFCEXTERNALREFERENCERELATIONSHIP\",\r\n    1209101575: \"IFCEXTERNALSPATIALELEMENT\",\r\n    2853485674: \"IFCEXTERNALSPATIALSTRUCTUREELEMENT\",\r\n    2242383968: \"IFCEXTERNALLYDEFINEDHATCHSTYLE\",\r\n    1040185647: \"IFCEXTERNALLYDEFINEDSURFACESTYLE\",\r\n    3548104201: \"IFCEXTERNALLYDEFINEDTEXTFONT\",\r\n    477187591: \"IFCEXTRUDEDAREASOLID\",\r\n    2804161546: \"IFCEXTRUDEDAREASOLIDTAPERED\",\r\n    2556980723: \"IFCFACE\",\r\n    2047409740: \"IFCFACEBASEDSURFACEMODEL\",\r\n    1809719519: \"IFCFACEBOUND\",\r\n    803316827: \"IFCFACEOUTERBOUND\",\r\n    3008276851: \"IFCFACESURFACE\",\r\n    807026263: \"IFCFACETEDBREP\",\r\n    3737207727: \"IFCFACETEDBREPWITHVOIDS\",\r\n    24185140: \"IFCFACILITY\",\r\n    1310830890: \"IFCFACILITYPART\",\r\n    4219587988: \"IFCFAILURECONNECTIONCONDITION\",\r\n    3415622556: \"IFCFAN\",\r\n    346874300: \"IFCFANTYPE\",\r\n    647756555: \"IFCFASTENER\",\r\n    2489546625: \"IFCFASTENERTYPE\",\r\n    2827207264: \"IFCFEATUREELEMENT\",\r\n    2143335405: \"IFCFEATUREELEMENTADDITION\",\r\n    1287392070: \"IFCFEATUREELEMENTSUBTRACTION\",\r\n    738692330: \"IFCFILLAREASTYLE\",\r\n    374418227: \"IFCFILLAREASTYLEHATCHING\",\r\n    315944413: \"IFCFILLAREASTYLETILES\",\r\n    819412036: \"IFCFILTER\",\r\n    1810631287: \"IFCFILTERTYPE\",\r\n    1426591983: \"IFCFIRESUPPRESSIONTERMINAL\",\r\n    4222183408: \"IFCFIRESUPPRESSIONTERMINALTYPE\",\r\n    2652556860: \"IFCFIXEDREFERENCESWEPTAREASOLID\",\r\n    2058353004: \"IFCFLOWCONTROLLER\",\r\n    3907093117: \"IFCFLOWCONTROLLERTYPE\",\r\n    4278956645: \"IFCFLOWFITTING\",\r\n    3198132628: \"IFCFLOWFITTINGTYPE\",\r\n    182646315: \"IFCFLOWINSTRUMENT\",\r\n    4037862832: \"IFCFLOWINSTRUMENTTYPE\",\r\n    2188021234: \"IFCFLOWMETER\",\r\n    3815607619: \"IFCFLOWMETERTYPE\",\r\n    3132237377: \"IFCFLOWMOVINGDEVICE\",\r\n    1482959167: \"IFCFLOWMOVINGDEVICETYPE\",\r\n    987401354: \"IFCFLOWSEGMENT\",\r\n    1834744321: \"IFCFLOWSEGMENTTYPE\",\r\n    707683696: \"IFCFLOWSTORAGEDEVICE\",\r\n    1339347760: \"IFCFLOWSTORAGEDEVICETYPE\",\r\n    2223149337: \"IFCFLOWTERMINAL\",\r\n    2297155007: \"IFCFLOWTERMINALTYPE\",\r\n    3508470533: \"IFCFLOWTREATMENTDEVICE\",\r\n    3009222698: \"IFCFLOWTREATMENTDEVICETYPE\",\r\n    900683007: \"IFCFOOTING\",\r\n    1893162501: \"IFCFOOTINGTYPE\",\r\n    263784265: \"IFCFURNISHINGELEMENT\",\r\n    4238390223: \"IFCFURNISHINGELEMENTTYPE\",\r\n    1509553395: \"IFCFURNITURE\",\r\n    1268542332: \"IFCFURNITURETYPE\",\r\n    3493046030: \"IFCGEOGRAPHICELEMENT\",\r\n    4095422895: \"IFCGEOGRAPHICELEMENTTYPE\",\r\n    987898635: \"IFCGEOMETRICCURVESET\",\r\n    3448662350: \"IFCGEOMETRICREPRESENTATIONCONTEXT\",\r\n    2453401579: \"IFCGEOMETRICREPRESENTATIONITEM\",\r\n    4142052618: \"IFCGEOMETRICREPRESENTATIONSUBCONTEXT\",\r\n    3590301190: \"IFCGEOMETRICSET\",\r\n    3009204131: \"IFCGRID\",\r\n    852622518: \"IFCGRIDAXIS\",\r\n    178086475: \"IFCGRIDPLACEMENT\",\r\n    2706460486: \"IFCGROUP\",\r\n    812098782: \"IFCHALFSPACESOLID\",\r\n    3319311131: \"IFCHEATEXCHANGER\",\r\n    1251058090: \"IFCHEATEXCHANGERTYPE\",\r\n    2068733104: \"IFCHUMIDIFIER\",\r\n    1806887404: \"IFCHUMIDIFIERTYPE\",\r\n    1484403080: \"IFCISHAPEPROFILEDEF\",\r\n    3905492369: \"IFCIMAGETEXTURE\",\r\n    3570813810: \"IFCINDEXEDCOLOURMAP\",\r\n    2571569899: \"IFCINDEXEDPOLYCURVE\",\r\n    178912537: \"IFCINDEXEDPOLYGONALFACE\",\r\n    2294589976: \"IFCINDEXEDPOLYGONALFACEWITHVOIDS\",\r\n    1437953363: \"IFCINDEXEDTEXTUREMAP\",\r\n    2133299955: \"IFCINDEXEDTRIANGLETEXTUREMAP\",\r\n    4175244083: \"IFCINTERCEPTOR\",\r\n    3946677679: \"IFCINTERCEPTORTYPE\",\r\n    3113134337: \"IFCINTERSECTIONCURVE\",\r\n    2391368822: \"IFCINVENTORY\",\r\n    3741457305: \"IFCIRREGULARTIMESERIES\",\r\n    3020489413: \"IFCIRREGULARTIMESERIESVALUE\",\r\n    2176052936: \"IFCJUNCTIONBOX\",\r\n    4288270099: \"IFCJUNCTIONBOXTYPE\",\r\n    572779678: \"IFCLSHAPEPROFILEDEF\",\r\n    3827777499: \"IFCLABORRESOURCE\",\r\n    428585644: \"IFCLABORRESOURCETYPE\",\r\n    1585845231: \"IFCLAGTIME\",\r\n    76236018: \"IFCLAMP\",\r\n    1051575348: \"IFCLAMPTYPE\",\r\n    2655187982: \"IFCLIBRARYINFORMATION\",\r\n    3452421091: \"IFCLIBRARYREFERENCE\",\r\n    4162380809: \"IFCLIGHTDISTRIBUTIONDATA\",\r\n    629592764: \"IFCLIGHTFIXTURE\",\r\n    1161773419: \"IFCLIGHTFIXTURETYPE\",\r\n    1566485204: \"IFCLIGHTINTENSITYDISTRIBUTION\",\r\n    1402838566: \"IFCLIGHTSOURCE\",\r\n    125510826: \"IFCLIGHTSOURCEAMBIENT\",\r\n    2604431987: \"IFCLIGHTSOURCEDIRECTIONAL\",\r\n    4266656042: \"IFCLIGHTSOURCEGONIOMETRIC\",\r\n    1520743889: \"IFCLIGHTSOURCEPOSITIONAL\",\r\n    3422422726: \"IFCLIGHTSOURCESPOT\",\r\n    1281925730: \"IFCLINE\",\r\n    3092502836: \"IFCLINESEGMENT2D\",\r\n    388784114: \"IFCLINEARPLACEMENT\",\r\n    1154579445: \"IFCLINEARPOSITIONINGELEMENT\",\r\n    2624227202: \"IFCLOCALPLACEMENT\",\r\n    1008929658: \"IFCLOOP\",\r\n    1425443689: \"IFCMANIFOLDSOLIDBREP\",\r\n    3057273783: \"IFCMAPCONVERSION\",\r\n    2347385850: \"IFCMAPPEDITEM\",\r\n    1838606355: \"IFCMATERIAL\",\r\n    1847130766: \"IFCMATERIALCLASSIFICATIONRELATIONSHIP\",\r\n    3708119000: \"IFCMATERIALCONSTITUENT\",\r\n    2852063980: \"IFCMATERIALCONSTITUENTSET\",\r\n    760658860: \"IFCMATERIALDEFINITION\",\r\n    2022407955: \"IFCMATERIALDEFINITIONREPRESENTATION\",\r\n    248100487: \"IFCMATERIALLAYER\",\r\n    3303938423: \"IFCMATERIALLAYERSET\",\r\n    1303795690: \"IFCMATERIALLAYERSETUSAGE\",\r\n    1847252529: \"IFCMATERIALLAYERWITHOFFSETS\",\r\n    2199411900: \"IFCMATERIALLIST\",\r\n    2235152071: \"IFCMATERIALPROFILE\",\r\n    164193824: \"IFCMATERIALPROFILESET\",\r\n    3079605661: \"IFCMATERIALPROFILESETUSAGE\",\r\n    3404854881: \"IFCMATERIALPROFILESETUSAGETAPERING\",\r\n    552965576: \"IFCMATERIALPROFILEWITHOFFSETS\",\r\n    3265635763: \"IFCMATERIALPROPERTIES\",\r\n    853536259: \"IFCMATERIALRELATIONSHIP\",\r\n    1507914824: \"IFCMATERIALUSAGEDEFINITION\",\r\n    2597039031: \"IFCMEASUREWITHUNIT\",\r\n    377706215: \"IFCMECHANICALFASTENER\",\r\n    2108223431: \"IFCMECHANICALFASTENERTYPE\",\r\n    1437502449: \"IFCMEDICALDEVICE\",\r\n    1114901282: \"IFCMEDICALDEVICETYPE\",\r\n    1073191201: \"IFCMEMBER\",\r\n    1911478936: \"IFCMEMBERSTANDARDCASE\",\r\n    3181161470: \"IFCMEMBERTYPE\",\r\n    3368373690: \"IFCMETRIC\",\r\n    2998442950: \"IFCMIRROREDPROFILEDEF\",\r\n    2706619895: \"IFCMONETARYUNIT\",\r\n    2474470126: \"IFCMOTORCONNECTION\",\r\n    977012517: \"IFCMOTORCONNECTIONTYPE\",\r\n    1918398963: \"IFCNAMEDUNIT\",\r\n    3888040117: \"IFCOBJECT\",\r\n    219451334: \"IFCOBJECTDEFINITION\",\r\n    3701648758: \"IFCOBJECTPLACEMENT\",\r\n    2251480897: \"IFCOBJECTIVE\",\r\n    4143007308: \"IFCOCCUPANT\",\r\n    590820931: \"IFCOFFSETCURVE\",\r\n    3388369263: \"IFCOFFSETCURVE2D\",\r\n    3505215534: \"IFCOFFSETCURVE3D\",\r\n    2485787929: \"IFCOFFSETCURVEBYDISTANCES\",\r\n    2665983363: \"IFCOPENSHELL\",\r\n    3588315303: \"IFCOPENINGELEMENT\",\r\n    3079942009: \"IFCOPENINGSTANDARDCASE\",\r\n    4251960020: \"IFCORGANIZATION\",\r\n    1411181986: \"IFCORGANIZATIONRELATIONSHIP\",\r\n    643959842: \"IFCORIENTATIONEXPRESSION\",\r\n    1029017970: \"IFCORIENTEDEDGE\",\r\n    144952367: \"IFCOUTERBOUNDARYCURVE\",\r\n    3694346114: \"IFCOUTLET\",\r\n    2837617999: \"IFCOUTLETTYPE\",\r\n    1207048766: \"IFCOWNERHISTORY\",\r\n    2529465313: \"IFCPARAMETERIZEDPROFILEDEF\",\r\n    2519244187: \"IFCPATH\",\r\n    1682466193: \"IFCPCURVE\",\r\n    2382730787: \"IFCPERFORMANCEHISTORY\",\r\n    3566463478: \"IFCPERMEABLECOVERINGPROPERTIES\",\r\n    3327091369: \"IFCPERMIT\",\r\n    2077209135: \"IFCPERSON\",\r\n    101040310: \"IFCPERSONANDORGANIZATION\",\r\n    3021840470: \"IFCPHYSICALCOMPLEXQUANTITY\",\r\n    2483315170: \"IFCPHYSICALQUANTITY\",\r\n    2226359599: \"IFCPHYSICALSIMPLEQUANTITY\",\r\n    1687234759: \"IFCPILE\",\r\n    1158309216: \"IFCPILETYPE\",\r\n    310824031: \"IFCPIPEFITTING\",\r\n    804291784: \"IFCPIPEFITTINGTYPE\",\r\n    3612865200: \"IFCPIPESEGMENT\",\r\n    4231323485: \"IFCPIPESEGMENTTYPE\",\r\n    597895409: \"IFCPIXELTEXTURE\",\r\n    2004835150: \"IFCPLACEMENT\",\r\n    603570806: \"IFCPLANARBOX\",\r\n    1663979128: \"IFCPLANAREXTENT\",\r\n    220341763: \"IFCPLANE\",\r\n    3171933400: \"IFCPLATE\",\r\n    1156407060: \"IFCPLATESTANDARDCASE\",\r\n    4017108033: \"IFCPLATETYPE\",\r\n    2067069095: \"IFCPOINT\",\r\n    4022376103: \"IFCPOINTONCURVE\",\r\n    1423911732: \"IFCPOINTONSURFACE\",\r\n    2924175390: \"IFCPOLYLOOP\",\r\n    2775532180: \"IFCPOLYGONALBOUNDEDHALFSPACE\",\r\n    2839578677: \"IFCPOLYGONALFACESET\",\r\n    3724593414: \"IFCPOLYLINE\",\r\n    3740093272: \"IFCPORT\",\r\n    1946335990: \"IFCPOSITIONINGELEMENT\",\r\n    3355820592: \"IFCPOSTALADDRESS\",\r\n    759155922: \"IFCPREDEFINEDCOLOUR\",\r\n    2559016684: \"IFCPREDEFINEDCURVEFONT\",\r\n    3727388367: \"IFCPREDEFINEDITEM\",\r\n    3778827333: \"IFCPREDEFINEDPROPERTIES\",\r\n    3967405729: \"IFCPREDEFINEDPROPERTYSET\",\r\n    1775413392: \"IFCPREDEFINEDTEXTFONT\",\r\n    677532197: \"IFCPRESENTATIONITEM\",\r\n    2022622350: \"IFCPRESENTATIONLAYERASSIGNMENT\",\r\n    1304840413: \"IFCPRESENTATIONLAYERWITHSTYLE\",\r\n    3119450353: \"IFCPRESENTATIONSTYLE\",\r\n    2417041796: \"IFCPRESENTATIONSTYLEASSIGNMENT\",\r\n    2744685151: \"IFCPROCEDURE\",\r\n    569719735: \"IFCPROCEDURETYPE\",\r\n    2945172077: \"IFCPROCESS\",\r\n    4208778838: \"IFCPRODUCT\",\r\n    673634403: \"IFCPRODUCTDEFINITIONSHAPE\",\r\n    2095639259: \"IFCPRODUCTREPRESENTATION\",\r\n    3958567839: \"IFCPROFILEDEF\",\r\n    2802850158: \"IFCPROFILEPROPERTIES\",\r\n    103090709: \"IFCPROJECT\",\r\n    653396225: \"IFCPROJECTLIBRARY\",\r\n    2904328755: \"IFCPROJECTORDER\",\r\n    3843373140: \"IFCPROJECTEDCRS\",\r\n    3651124850: \"IFCPROJECTIONELEMENT\",\r\n    2598011224: \"IFCPROPERTY\",\r\n    986844984: \"IFCPROPERTYABSTRACTION\",\r\n    871118103: \"IFCPROPERTYBOUNDEDVALUE\",\r\n    1680319473: \"IFCPROPERTYDEFINITION\",\r\n    148025276: \"IFCPROPERTYDEPENDENCYRELATIONSHIP\",\r\n    4166981789: \"IFCPROPERTYENUMERATEDVALUE\",\r\n    3710013099: \"IFCPROPERTYENUMERATION\",\r\n    2752243245: \"IFCPROPERTYLISTVALUE\",\r\n    941946838: \"IFCPROPERTYREFERENCEVALUE\",\r\n    1451395588: \"IFCPROPERTYSET\",\r\n    3357820518: \"IFCPROPERTYSETDEFINITION\",\r\n    492091185: \"IFCPROPERTYSETTEMPLATE\",\r\n    3650150729: \"IFCPROPERTYSINGLEVALUE\",\r\n    110355661: \"IFCPROPERTYTABLEVALUE\",\r\n    3521284610: \"IFCPROPERTYTEMPLATE\",\r\n    1482703590: \"IFCPROPERTYTEMPLATEDEFINITION\",\r\n    738039164: \"IFCPROTECTIVEDEVICE\",\r\n    2295281155: \"IFCPROTECTIVEDEVICETRIPPINGUNIT\",\r\n    655969474: \"IFCPROTECTIVEDEVICETRIPPINGUNITTYPE\",\r\n    1842657554: \"IFCPROTECTIVEDEVICETYPE\",\r\n    3219374653: \"IFCPROXY\",\r\n    90941305: \"IFCPUMP\",\r\n    2250791053: \"IFCPUMPTYPE\",\r\n    2044713172: \"IFCQUANTITYAREA\",\r\n    2093928680: \"IFCQUANTITYCOUNT\",\r\n    931644368: \"IFCQUANTITYLENGTH\",\r\n    2090586900: \"IFCQUANTITYSET\",\r\n    3252649465: \"IFCQUANTITYTIME\",\r\n    2405470396: \"IFCQUANTITYVOLUME\",\r\n    825690147: \"IFCQUANTITYWEIGHT\",\r\n    2262370178: \"IFCRAILING\",\r\n    2893384427: \"IFCRAILINGTYPE\",\r\n    3024970846: \"IFCRAMP\",\r\n    3283111854: \"IFCRAMPFLIGHT\",\r\n    2324767716: \"IFCRAMPFLIGHTTYPE\",\r\n    1469900589: \"IFCRAMPTYPE\",\r\n    1232101972: \"IFCRATIONALBSPLINECURVEWITHKNOTS\",\r\n    683857671: \"IFCRATIONALBSPLINESURFACEWITHKNOTS\",\r\n    2770003689: \"IFCRECTANGLEHOLLOWPROFILEDEF\",\r\n    3615266464: \"IFCRECTANGLEPROFILEDEF\",\r\n    2798486643: \"IFCRECTANGULARPYRAMID\",\r\n    3454111270: \"IFCRECTANGULARTRIMMEDSURFACE\",\r\n    3915482550: \"IFCRECURRENCEPATTERN\",\r\n    2433181523: \"IFCREFERENCE\",\r\n    4021432810: \"IFCREFERENT\",\r\n    3413951693: \"IFCREGULARTIMESERIES\",\r\n    1580146022: \"IFCREINFORCEMENTBARPROPERTIES\",\r\n    3765753017: \"IFCREINFORCEMENTDEFINITIONPROPERTIES\",\r\n    979691226: \"IFCREINFORCINGBAR\",\r\n    2572171363: \"IFCREINFORCINGBARTYPE\",\r\n    3027567501: \"IFCREINFORCINGELEMENT\",\r\n    964333572: \"IFCREINFORCINGELEMENTTYPE\",\r\n    2320036040: \"IFCREINFORCINGMESH\",\r\n    2310774935: \"IFCREINFORCINGMESHTYPE\",\r\n    160246688: \"IFCRELAGGREGATES\",\r\n    3939117080: \"IFCRELASSIGNS\",\r\n    1683148259: \"IFCRELASSIGNSTOACTOR\",\r\n    2495723537: \"IFCRELASSIGNSTOCONTROL\",\r\n    1307041759: \"IFCRELASSIGNSTOGROUP\",\r\n    1027710054: \"IFCRELASSIGNSTOGROUPBYFACTOR\",\r\n    4278684876: \"IFCRELASSIGNSTOPROCESS\",\r\n    2857406711: \"IFCRELASSIGNSTOPRODUCT\",\r\n    205026976: \"IFCRELASSIGNSTORESOURCE\",\r\n    1865459582: \"IFCRELASSOCIATES\",\r\n    4095574036: \"IFCRELASSOCIATESAPPROVAL\",\r\n    919958153: \"IFCRELASSOCIATESCLASSIFICATION\",\r\n    2728634034: \"IFCRELASSOCIATESCONSTRAINT\",\r\n    982818633: \"IFCRELASSOCIATESDOCUMENT\",\r\n    3840914261: \"IFCRELASSOCIATESLIBRARY\",\r\n    2655215786: \"IFCRELASSOCIATESMATERIAL\",\r\n    826625072: \"IFCRELCONNECTS\",\r\n    1204542856: \"IFCRELCONNECTSELEMENTS\",\r\n    3945020480: \"IFCRELCONNECTSPATHELEMENTS\",\r\n    4201705270: \"IFCRELCONNECTSPORTTOELEMENT\",\r\n    3190031847: \"IFCRELCONNECTSPORTS\",\r\n    2127690289: \"IFCRELCONNECTSSTRUCTURALACTIVITY\",\r\n    1638771189: \"IFCRELCONNECTSSTRUCTURALMEMBER\",\r\n    504942748: \"IFCRELCONNECTSWITHECCENTRICITY\",\r\n    3678494232: \"IFCRELCONNECTSWITHREALIZINGELEMENTS\",\r\n    3242617779: \"IFCRELCONTAINEDINSPATIALSTRUCTURE\",\r\n    886880790: \"IFCRELCOVERSBLDGELEMENTS\",\r\n    2802773753: \"IFCRELCOVERSSPACES\",\r\n    2565941209: \"IFCRELDECLARES\",\r\n    2551354335: \"IFCRELDECOMPOSES\",\r\n    693640335: \"IFCRELDEFINES\",\r\n    1462361463: \"IFCRELDEFINESBYOBJECT\",\r\n    4186316022: \"IFCRELDEFINESBYPROPERTIES\",\r\n    307848117: \"IFCRELDEFINESBYTEMPLATE\",\r\n    781010003: \"IFCRELDEFINESBYTYPE\",\r\n    3940055652: \"IFCRELFILLSELEMENT\",\r\n    279856033: \"IFCRELFLOWCONTROLELEMENTS\",\r\n    427948657: \"IFCRELINTERFERESELEMENTS\",\r\n    3268803585: \"IFCRELNESTS\",\r\n    1441486842: \"IFCRELPOSITIONS\",\r\n    750771296: \"IFCRELPROJECTSELEMENT\",\r\n    1245217292: \"IFCRELREFERENCEDINSPATIALSTRUCTURE\",\r\n    4122056220: \"IFCRELSEQUENCE\",\r\n    366585022: \"IFCRELSERVICESBUILDINGS\",\r\n    3451746338: \"IFCRELSPACEBOUNDARY\",\r\n    3523091289: \"IFCRELSPACEBOUNDARY1STLEVEL\",\r\n    1521410863: \"IFCRELSPACEBOUNDARY2NDLEVEL\",\r\n    1401173127: \"IFCRELVOIDSELEMENT\",\r\n    478536968: \"IFCRELATIONSHIP\",\r\n    816062949: \"IFCREPARAMETRISEDCOMPOSITECURVESEGMENT\",\r\n    1076942058: \"IFCREPRESENTATION\",\r\n    3377609919: \"IFCREPRESENTATIONCONTEXT\",\r\n    3008791417: \"IFCREPRESENTATIONITEM\",\r\n    1660063152: \"IFCREPRESENTATIONMAP\",\r\n    2914609552: \"IFCRESOURCE\",\r\n    2943643501: \"IFCRESOURCEAPPROVALRELATIONSHIP\",\r\n    1608871552: \"IFCRESOURCECONSTRAINTRELATIONSHIP\",\r\n    2439245199: \"IFCRESOURCELEVELRELATIONSHIP\",\r\n    1042787934: \"IFCRESOURCETIME\",\r\n    1856042241: \"IFCREVOLVEDAREASOLID\",\r\n    3243963512: \"IFCREVOLVEDAREASOLIDTAPERED\",\r\n    4158566097: \"IFCRIGHTCIRCULARCONE\",\r\n    3626867408: \"IFCRIGHTCIRCULARCYLINDER\",\r\n    2016517767: \"IFCROOF\",\r\n    2781568857: \"IFCROOFTYPE\",\r\n    2341007311: \"IFCROOT\",\r\n    2778083089: \"IFCROUNDEDRECTANGLEPROFILEDEF\",\r\n    448429030: \"IFCSIUNIT\",\r\n    3053780830: \"IFCSANITARYTERMINAL\",\r\n    1768891740: \"IFCSANITARYTERMINALTYPE\",\r\n    1054537805: \"IFCSCHEDULINGTIME\",\r\n    2157484638: \"IFCSEAMCURVE\",\r\n    2042790032: \"IFCSECTIONPROPERTIES\",\r\n    4165799628: \"IFCSECTIONREINFORCEMENTPROPERTIES\",\r\n    1862484736: \"IFCSECTIONEDSOLID\",\r\n    1290935644: \"IFCSECTIONEDSOLIDHORIZONTAL\",\r\n    1509187699: \"IFCSECTIONEDSPINE\",\r\n    4086658281: \"IFCSENSOR\",\r\n    1783015770: \"IFCSENSORTYPE\",\r\n    1329646415: \"IFCSHADINGDEVICE\",\r\n    4074543187: \"IFCSHADINGDEVICETYPE\",\r\n    867548509: \"IFCSHAPEASPECT\",\r\n    3982875396: \"IFCSHAPEMODEL\",\r\n    4240577450: \"IFCSHAPEREPRESENTATION\",\r\n    4124623270: \"IFCSHELLBASEDSURFACEMODEL\",\r\n    3692461612: \"IFCSIMPLEPROPERTY\",\r\n    3663146110: \"IFCSIMPLEPROPERTYTEMPLATE\",\r\n    4097777520: \"IFCSITE\",\r\n    1529196076: \"IFCSLAB\",\r\n    3127900445: \"IFCSLABELEMENTEDCASE\",\r\n    3027962421: \"IFCSLABSTANDARDCASE\",\r\n    2533589738: \"IFCSLABTYPE\",\r\n    2609359061: \"IFCSLIPPAGECONNECTIONCONDITION\",\r\n    3420628829: \"IFCSOLARDEVICE\",\r\n    1072016465: \"IFCSOLARDEVICETYPE\",\r\n    723233188: \"IFCSOLIDMODEL\",\r\n    3856911033: \"IFCSPACE\",\r\n    1999602285: \"IFCSPACEHEATER\",\r\n    1305183839: \"IFCSPACEHEATERTYPE\",\r\n    3812236995: \"IFCSPACETYPE\",\r\n    1412071761: \"IFCSPATIALELEMENT\",\r\n    710998568: \"IFCSPATIALELEMENTTYPE\",\r\n    2706606064: \"IFCSPATIALSTRUCTUREELEMENT\",\r\n    3893378262: \"IFCSPATIALSTRUCTUREELEMENTTYPE\",\r\n    463610769: \"IFCSPATIALZONE\",\r\n    2481509218: \"IFCSPATIALZONETYPE\",\r\n    451544542: \"IFCSPHERE\",\r\n    4015995234: \"IFCSPHERICALSURFACE\",\r\n    1404847402: \"IFCSTACKTERMINAL\",\r\n    3112655638: \"IFCSTACKTERMINALTYPE\",\r\n    331165859: \"IFCSTAIR\",\r\n    4252922144: \"IFCSTAIRFLIGHT\",\r\n    1039846685: \"IFCSTAIRFLIGHTTYPE\",\r\n    338393293: \"IFCSTAIRTYPE\",\r\n    682877961: \"IFCSTRUCTURALACTION\",\r\n    3544373492: \"IFCSTRUCTURALACTIVITY\",\r\n    2515109513: \"IFCSTRUCTURALANALYSISMODEL\",\r\n    1179482911: \"IFCSTRUCTURALCONNECTION\",\r\n    2273995522: \"IFCSTRUCTURALCONNECTIONCONDITION\",\r\n    1004757350: \"IFCSTRUCTURALCURVEACTION\",\r\n    4243806635: \"IFCSTRUCTURALCURVECONNECTION\",\r\n    214636428: \"IFCSTRUCTURALCURVEMEMBER\",\r\n    2445595289: \"IFCSTRUCTURALCURVEMEMBERVARYING\",\r\n    2757150158: \"IFCSTRUCTURALCURVEREACTION\",\r\n    3136571912: \"IFCSTRUCTURALITEM\",\r\n    1807405624: \"IFCSTRUCTURALLINEARACTION\",\r\n    2162789131: \"IFCSTRUCTURALLOAD\",\r\n    385403989: \"IFCSTRUCTURALLOADCASE\",\r\n    3478079324: \"IFCSTRUCTURALLOADCONFIGURATION\",\r\n    1252848954: \"IFCSTRUCTURALLOADGROUP\",\r\n    1595516126: \"IFCSTRUCTURALLOADLINEARFORCE\",\r\n    609421318: \"IFCSTRUCTURALLOADORRESULT\",\r\n    2668620305: \"IFCSTRUCTURALLOADPLANARFORCE\",\r\n    2473145415: \"IFCSTRUCTURALLOADSINGLEDISPLACEMENT\",\r\n    1973038258: \"IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION\",\r\n    1597423693: \"IFCSTRUCTURALLOADSINGLEFORCE\",\r\n    1190533807: \"IFCSTRUCTURALLOADSINGLEFORCEWARPING\",\r\n    2525727697: \"IFCSTRUCTURALLOADSTATIC\",\r\n    3408363356: \"IFCSTRUCTURALLOADTEMPERATURE\",\r\n    530289379: \"IFCSTRUCTURALMEMBER\",\r\n    1621171031: \"IFCSTRUCTURALPLANARACTION\",\r\n    2082059205: \"IFCSTRUCTURALPOINTACTION\",\r\n    734778138: \"IFCSTRUCTURALPOINTCONNECTION\",\r\n    1235345126: \"IFCSTRUCTURALPOINTREACTION\",\r\n    3689010777: \"IFCSTRUCTURALREACTION\",\r\n    2986769608: \"IFCSTRUCTURALRESULTGROUP\",\r\n    3657597509: \"IFCSTRUCTURALSURFACEACTION\",\r\n    1975003073: \"IFCSTRUCTURALSURFACECONNECTION\",\r\n    3979015343: \"IFCSTRUCTURALSURFACEMEMBER\",\r\n    2218152070: \"IFCSTRUCTURALSURFACEMEMBERVARYING\",\r\n    603775116: \"IFCSTRUCTURALSURFACEREACTION\",\r\n    2830218821: \"IFCSTYLEMODEL\",\r\n    3958052878: \"IFCSTYLEDITEM\",\r\n    3049322572: \"IFCSTYLEDREPRESENTATION\",\r\n    148013059: \"IFCSUBCONTRACTRESOURCE\",\r\n    4095615324: \"IFCSUBCONTRACTRESOURCETYPE\",\r\n    2233826070: \"IFCSUBEDGE\",\r\n    2513912981: \"IFCSURFACE\",\r\n    699246055: \"IFCSURFACECURVE\",\r\n    2028607225: \"IFCSURFACECURVESWEPTAREASOLID\",\r\n    3101698114: \"IFCSURFACEFEATURE\",\r\n    2809605785: \"IFCSURFACEOFLINEAREXTRUSION\",\r\n    4124788165: \"IFCSURFACEOFREVOLUTION\",\r\n    2934153892: \"IFCSURFACEREINFORCEMENTAREA\",\r\n    1300840506: \"IFCSURFACESTYLE\",\r\n    3303107099: \"IFCSURFACESTYLELIGHTING\",\r\n    1607154358: \"IFCSURFACESTYLEREFRACTION\",\r\n    1878645084: \"IFCSURFACESTYLERENDERING\",\r\n    846575682: \"IFCSURFACESTYLESHADING\",\r\n    1351298697: \"IFCSURFACESTYLEWITHTEXTURES\",\r\n    626085974: \"IFCSURFACETEXTURE\",\r\n    2247615214: \"IFCSWEPTAREASOLID\",\r\n    1260650574: \"IFCSWEPTDISKSOLID\",\r\n    1096409881: \"IFCSWEPTDISKSOLIDPOLYGONAL\",\r\n    230924584: \"IFCSWEPTSURFACE\",\r\n    1162798199: \"IFCSWITCHINGDEVICE\",\r\n    2315554128: \"IFCSWITCHINGDEVICETYPE\",\r\n    2254336722: \"IFCSYSTEM\",\r\n    413509423: \"IFCSYSTEMFURNITUREELEMENT\",\r\n    1580310250: \"IFCSYSTEMFURNITUREELEMENTTYPE\",\r\n    3071757647: \"IFCTSHAPEPROFILEDEF\",\r\n    985171141: \"IFCTABLE\",\r\n    2043862942: \"IFCTABLECOLUMN\",\r\n    531007025: \"IFCTABLEROW\",\r\n    812556717: \"IFCTANK\",\r\n    5716631: \"IFCTANKTYPE\",\r\n    3473067441: \"IFCTASK\",\r\n    1549132990: \"IFCTASKTIME\",\r\n    2771591690: \"IFCTASKTIMERECURRING\",\r\n    3206491090: \"IFCTASKTYPE\",\r\n    912023232: \"IFCTELECOMADDRESS\",\r\n    3824725483: \"IFCTENDON\",\r\n    2347447852: \"IFCTENDONANCHOR\",\r\n    3081323446: \"IFCTENDONANCHORTYPE\",\r\n    3663046924: \"IFCTENDONCONDUIT\",\r\n    2281632017: \"IFCTENDONCONDUITTYPE\",\r\n    2415094496: \"IFCTENDONTYPE\",\r\n    2387106220: \"IFCTESSELLATEDFACESET\",\r\n    901063453: \"IFCTESSELLATEDITEM\",\r\n    4282788508: \"IFCTEXTLITERAL\",\r\n    3124975700: \"IFCTEXTLITERALWITHEXTENT\",\r\n    1447204868: \"IFCTEXTSTYLE\",\r\n    1983826977: \"IFCTEXTSTYLEFONTMODEL\",\r\n    2636378356: \"IFCTEXTSTYLEFORDEFINEDFONT\",\r\n    1640371178: \"IFCTEXTSTYLETEXTMODEL\",\r\n    280115917: \"IFCTEXTURECOORDINATE\",\r\n    1742049831: \"IFCTEXTURECOORDINATEGENERATOR\",\r\n    2552916305: \"IFCTEXTUREMAP\",\r\n    1210645708: \"IFCTEXTUREVERTEX\",\r\n    3611470254: \"IFCTEXTUREVERTEXLIST\",\r\n    1199560280: \"IFCTIMEPERIOD\",\r\n    3101149627: \"IFCTIMESERIES\",\r\n    581633288: \"IFCTIMESERIESVALUE\",\r\n    1377556343: \"IFCTOPOLOGICALREPRESENTATIONITEM\",\r\n    1735638870: \"IFCTOPOLOGYREPRESENTATION\",\r\n    1935646853: \"IFCTOROIDALSURFACE\",\r\n    3825984169: \"IFCTRANSFORMER\",\r\n    1692211062: \"IFCTRANSFORMERTYPE\",\r\n    2595432518: \"IFCTRANSITIONCURVESEGMENT2D\",\r\n    1620046519: \"IFCTRANSPORTELEMENT\",\r\n    2097647324: \"IFCTRANSPORTELEMENTTYPE\",\r\n    2715220739: \"IFCTRAPEZIUMPROFILEDEF\",\r\n    2916149573: \"IFCTRIANGULATEDFACESET\",\r\n    1229763772: \"IFCTRIANGULATEDIRREGULARNETWORK\",\r\n    3593883385: \"IFCTRIMMEDCURVE\",\r\n    3026737570: \"IFCTUBEBUNDLE\",\r\n    1600972822: \"IFCTUBEBUNDLETYPE\",\r\n    1628702193: \"IFCTYPEOBJECT\",\r\n    3736923433: \"IFCTYPEPROCESS\",\r\n    2347495698: \"IFCTYPEPRODUCT\",\r\n    3698973494: \"IFCTYPERESOURCE\",\r\n    427810014: \"IFCUSHAPEPROFILEDEF\",\r\n    180925521: \"IFCUNITASSIGNMENT\",\r\n    630975310: \"IFCUNITARYCONTROLELEMENT\",\r\n    3179687236: \"IFCUNITARYCONTROLELEMENTTYPE\",\r\n    4292641817: \"IFCUNITARYEQUIPMENT\",\r\n    1911125066: \"IFCUNITARYEQUIPMENTTYPE\",\r\n    4207607924: \"IFCVALVE\",\r\n    728799441: \"IFCVALVETYPE\",\r\n    1417489154: \"IFCVECTOR\",\r\n    2799835756: \"IFCVERTEX\",\r\n    2759199220: \"IFCVERTEXLOOP\",\r\n    1907098498: \"IFCVERTEXPOINT\",\r\n    1530820697: \"IFCVIBRATIONDAMPER\",\r\n    3956297820: \"IFCVIBRATIONDAMPERTYPE\",\r\n    2391383451: \"IFCVIBRATIONISOLATOR\",\r\n    3313531582: \"IFCVIBRATIONISOLATORTYPE\",\r\n    2769231204: \"IFCVIRTUALELEMENT\",\r\n    891718957: \"IFCVIRTUALGRIDINTERSECTION\",\r\n    926996030: \"IFCVOIDINGFEATURE\",\r\n    2391406946: \"IFCWALL\",\r\n    4156078855: \"IFCWALLELEMENTEDCASE\",\r\n    3512223829: \"IFCWALLSTANDARDCASE\",\r\n    1898987631: \"IFCWALLTYPE\",\r\n    4237592921: \"IFCWASTETERMINAL\",\r\n    1133259667: \"IFCWASTETERMINALTYPE\",\r\n    3304561284: \"IFCWINDOW\",\r\n    336235671: \"IFCWINDOWLININGPROPERTIES\",\r\n    512836454: \"IFCWINDOWPANELPROPERTIES\",\r\n    486154966: \"IFCWINDOWSTANDARDCASE\",\r\n    1299126871: \"IFCWINDOWSTYLE\",\r\n    4009809668: \"IFCWINDOWTYPE\",\r\n    4088093105: \"IFCWORKCALENDAR\",\r\n    1028945134: \"IFCWORKCONTROL\",\r\n    4218914973: \"IFCWORKPLAN\",\r\n    3342526732: \"IFCWORKSCHEDULE\",\r\n    1236880293: \"IFCWORKTIME\",\r\n    2543172580: \"IFCZSHAPEPROFILEDEF\",\r\n    1033361043: \"IFCZONE\",\r\n}","import { IfcTypesMap } from '../IfcTypesMap';\r\nimport { JSONObject, pName } from '../../BaseDefinitions';\r\nimport { BasePropertyManager } from './BasePropertyManager';\r\nimport { IFCPROJECT } from 'web-ifc';\r\nimport { PropertyAPI } from './BaseDefinitions';\r\n\r\nexport class JSONPropertyManager extends BasePropertyManager implements PropertyAPI {\r\n\r\n    async getItemProperties(modelID: number, id: number, recursive = false) {\r\n        return { ...this.state.models[modelID].jsonData[id] };\r\n    }\r\n\r\n    async getSpatialStructure(modelID: number, includeProperties?: boolean) {\r\n        const chunks = await this.getSpatialTreeChunks(modelID);\r\n        const projectsIDs = await this.getAllItemsOfType(modelID, IFCPROJECT, false);\r\n        const projectID = projectsIDs[0];\r\n        const project = JSONPropertyManager.newIfcProject(projectID);\r\n        await this.getSpatialNode(modelID, project, chunks, includeProperties);\r\n        return { ...project };\r\n    }\r\n\r\n    async getAllItemsOfType(modelID: number, type: number, verbose: boolean) {\r\n        const data = this.state.models[modelID].jsonData;\r\n        const typeName = IfcTypesMap[type];\r\n        if (!typeName) {\r\n            throw new Error(`Type not found: ${type}`);\r\n        }\r\n        return this.filterItemsByType(data, typeName, verbose);\r\n    }\r\n\r\n    override async getProperty(modelID: number, elementID: number, recursive = false, propName: pName) {\r\n        const resultIDs = await this.getAllRelatedItemsOfType(modelID, elementID, propName);\r\n        const result = this.getItemsByID(modelID, resultIDs);\r\n        if (recursive) {\r\n            result.forEach(result => this.getReferencesRecursively(modelID, result));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    protected override getNodeType(modelID: number, id: number) {\r\n        return this.state.models[modelID].jsonData[id].type;\r\n    }\r\n\r\n    protected override async getChunks(modelID: number, chunks: any, propNames: pName) {\r\n        const relation = await this.getAllItemsOfType(modelID, propNames.name, true);\r\n        relation.forEach(rel => {\r\n            this.saveChunk(chunks, propNames, rel);\r\n        });\r\n    }\r\n\r\n    private filterItemsByType(data: { [id: number]: JSONObject }, typeName: string, verbose: boolean) {\r\n        const result: any[] = [];\r\n        Object.keys(data).forEach(key => {\r\n            const numKey = parseInt(key);\r\n            if (data[numKey].type.toUpperCase() === typeName) {\r\n                result.push(verbose ? { ...data[numKey] } : numKey);\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n    private async getAllRelatedItemsOfType(modelID: number, id: number, propNames: pName) {\r\n        const lines = await this.getAllItemsOfType(modelID, propNames.name, true);\r\n        const IDs: number[] = [];\r\n        lines.forEach(line => {\r\n            const isRelated = JSONPropertyManager.isRelated(id, line, propNames);\r\n            if (isRelated) this.getRelated(line, propNames, IDs);\r\n        });\r\n        return IDs;\r\n    }\r\n\r\n    private getItemsByID(modelID: number, ids: number[]) {\r\n        const data = this.state.models[modelID].jsonData;\r\n        const result: any[] = [];\r\n        ids.forEach(id => result.push({ ...data[id] }));\r\n        return result;\r\n    }\r\n\r\n    private getReferencesRecursively(modelID: number, jsonObject: any) {\r\n        if (jsonObject == undefined) return;\r\n        const keys = Object.keys(jsonObject);\r\n        for (let i = 0; i < keys.length; i++) {\r\n            const key = keys[i];\r\n            this.getJSONItem(modelID, jsonObject, key);\r\n        }\r\n    }\r\n\r\n    private getJSONItem(modelID: number, jsonObject: any, key: string) {\r\n        if (Array.isArray(jsonObject[key])) {\r\n            return this.getMultipleJSONItems(modelID, jsonObject, key);\r\n        }\r\n        if (jsonObject[key] && jsonObject[key].type === 5) {\r\n            jsonObject[key] = this.getItemsByID(modelID, [jsonObject[key].value])[0];\r\n            this.getReferencesRecursively(modelID, jsonObject[key]);\r\n        }\r\n    }\r\n\r\n    private getMultipleJSONItems(modelID: number, jsonObject: any, key: string) {\r\n        jsonObject[key] = jsonObject[key].map((item: any) => {\r\n            if (item.type === 5) {\r\n                item = this.getItemsByID(modelID, [item.value])[0];\r\n                this.getReferencesRecursively(modelID, item);\r\n            }\r\n            return item;\r\n        });\r\n    }\r\n}","import {\r\n    IdAttrName\r\n} from '../../BaseDefinitions';\r\nimport { IfcState } from '../../BaseDefinitions';\r\nimport { BufferGeometry } from 'three';\r\nimport { WebIfcPropertyManager } from './WebIfcPropertyManager';\r\nimport { JSONPropertyManager } from './JSONPropertyManager';\r\nimport { PropertyManagerAPI, PropertyAPI } from './BaseDefinitions';\r\nimport { IfcElements } from '../IFCElementsMap';\r\n\r\n/**\r\n * Contains the logic to get the properties of the items within an IFC model.\r\n */\r\nexport class PropertyManager implements PropertyManagerAPI {\r\n    private readonly webIfcProps: WebIfcPropertyManager;\r\n    private readonly jsonProps: JSONPropertyManager;\r\n    private currentProps: PropertyAPI;\r\n\r\n    constructor(private state: IfcState) {\r\n        this.webIfcProps = new WebIfcPropertyManager(state);\r\n        this.jsonProps = new JSONPropertyManager(state);\r\n        this.currentProps = this.webIfcProps;\r\n    }\r\n\r\n    getExpressId(geometry: BufferGeometry, faceIndex: number) {\r\n        if (!geometry.index) throw new Error('Geometry does not have index information.');\r\n        const geoIndex = geometry.index.array;\r\n        return geometry.attributes[IdAttrName].getX(geoIndex[3 * faceIndex]);\r\n    }\r\n\r\n    async getItemProperties(modelID: number, elementID: number, recursive = false) {\r\n        this.updateCurrentProps();\r\n        return this.currentProps.getItemProperties(modelID, elementID, recursive);\r\n    }\r\n\r\n    async getAllItemsOfType(modelID: number, type: number, verbose: boolean) {\r\n        this.updateCurrentProps();\r\n        return this.currentProps.getAllItemsOfType(modelID, type, verbose);\r\n    }\r\n\r\n    async getPropertySets(modelID: number, elementID: number, recursive = false) {\r\n        this.updateCurrentProps();\r\n        return this.currentProps.getPropertySets(modelID, elementID, recursive);\r\n    }\r\n\r\n    async getTypeProperties(modelID: number, elementID: number, recursive = false) {\r\n        this.updateCurrentProps();\r\n        return this.currentProps.getTypeProperties(modelID, elementID, recursive);\r\n    }\r\n\r\n    async getMaterialsProperties(modelID: number, elementID: number, recursive = false) {\r\n        this.updateCurrentProps();\r\n        return this.currentProps.getMaterialsProperties(modelID, elementID, recursive);\r\n    }\r\n\r\n    async getSpatialStructure(modelID: number, includeProperties?: boolean) {\r\n        this.updateCurrentProps();\r\n        if (!this.state.useJSON && includeProperties) {\r\n            console.warn('Including properties in getSpatialStructure with the JSON workflow disabled can lead to poor performance.');\r\n        }\r\n        return await this.currentProps.getSpatialStructure(modelID, includeProperties);\r\n    }\r\n\r\n    private updateCurrentProps() {\r\n        this.currentProps = this.state.useJSON ? this.jsonProps : this.webIfcProps;\r\n    }\r\n\r\n}\r\n","import { IfcState, SelectedItems } from '../BaseDefinitions';\r\nimport { IfcElements } from './IFCElementsMap'\r\nimport { IFCWorkerHandler } from '../web-workers/IFCWorkerHandler';\r\n\r\n/**\r\n * Contains the logic to manage the type (e. g. IfcWall, IfcWindow, IfcDoor) of\r\n * all the items within an IFC file.\r\n */\r\nexport class TypeManager {\r\n\r\n    constructor(private state: IfcState) {\r\n        this.state = state;\r\n    }\r\n\r\n    async getAllTypes(worker?: IFCWorkerHandler){\r\n        for(let modelID in this.state.models){\r\n            const types = this.state.models[modelID].types;\r\n            if(Object.keys(types).length == 0) {\r\n                await this.getAllTypesOfModel(parseInt(modelID), worker);\r\n            }\r\n        }\r\n    }\r\n\r\n    async getAllTypesOfModel(modelID: number, worker?: IFCWorkerHandler) {\r\n        const result = {};\r\n        const elements = Object.keys(IfcElements).map((e) => parseInt(e));\r\n        for(let i = 0; i < elements.length; i++) {\r\n            const element = elements[i];\r\n            const lines = await this.state.api.GetLineIDsWithType(modelID, element);\r\n            const size = lines.size();\r\n            //@ts-ignore\r\n            for (let i = 0; i < size; i++) result[lines.get(i)] = element;\r\n        }\r\n        if(this.state.worker.active && worker) {\r\n            await worker.workerState.updateModelStateTypes(modelID, result);\r\n        } else {\r\n            this.state.models[modelID].types = result;\r\n        }\r\n    }\r\n}\r\n","import { IfcState, SelectedItems } from '../BaseDefinitions';\r\nimport { BufferGeometry, Mesh } from 'three';\r\n\r\nexport class BvhManager {\r\n    private computeBoundsTree?: any;\r\n    private disposeBoundsTree?: any;\r\n    private acceleratedRaycast?: any;\r\n\r\n    initializeMeshBVH(computeBoundsTree: any, disposeBoundsTree: any, acceleratedRaycast: any) {\r\n        this.computeBoundsTree = computeBoundsTree;\r\n        this.disposeBoundsTree = disposeBoundsTree;\r\n        this.acceleratedRaycast = acceleratedRaycast;\r\n        this.setupThreeMeshBVH();\r\n    }\r\n\r\n    applyThreeMeshBVH(geometry: BufferGeometry) {\r\n        if (this.computeBoundsTree)\r\n            //@ts-ignore\r\n            geometry.computeBoundsTree();\r\n    }\r\n\r\n    private setupThreeMeshBVH() {\r\n        if (!this.computeBoundsTree || !this.disposeBoundsTree || !this.acceleratedRaycast) return;\r\n        //@ts-ignore\r\n        BufferGeometry.prototype.computeBoundsTree = this.computeBoundsTree;\r\n        //@ts-ignore\r\n        BufferGeometry.prototype.disposeBoundsTree = this.disposeBoundsTree;\r\n        Mesh.prototype.raycast = this.acceleratedRaycast;\r\n    }\r\n}","import { IfcState } from '../BaseDefinitions';\r\n\r\nexport class ItemsHider {\r\n    private state: IfcState;\r\n    private modelCoordinates: { [modelID: number]: Float32Array } = {};\r\n    private expressIDCoordinatesMap: {\r\n        [modelID: number]: {\r\n            [id: number]: number[];\r\n        }\r\n    } = {};\r\n\r\n    constructor(state: IfcState) {\r\n        this.state = state;\r\n    };\r\n\r\n    dispose() {\r\n        this.modelCoordinates = {};\r\n        this.expressIDCoordinatesMap = {};\r\n    }\r\n\r\n    processCoordinates(modelID: number) {\r\n        const attributes = this.getAttributes(modelID);\r\n        const ids = Array.from(attributes.expressID.array);\r\n        this.expressIDCoordinatesMap[modelID] = {};\r\n        for (let i = 0; i < ids.length; i++) {\r\n            if (!this.expressIDCoordinatesMap[modelID][ids[i]]) {\r\n                this.expressIDCoordinatesMap[modelID][ids[i]] = [];\r\n            }\r\n            const current = this.expressIDCoordinatesMap[modelID];\r\n            current[ids[i]].push(3 * i);\r\n        }\r\n        this.initializeCoordinates(modelID);\r\n    }\r\n\r\n    hideItems(modelID: number, ids: number[]) {\r\n        this.editCoordinates(modelID, ids, true);\r\n    }\r\n\r\n    showItems(modelID: number, ids: number[]) {\r\n        this.editCoordinates(modelID, ids, false);\r\n    }\r\n\r\n    editCoordinates(modelID: number, ids: number[], hide: boolean) {\r\n        const current = this.expressIDCoordinatesMap[modelID];\r\n        const indices: number[] = [];\r\n        ids.forEach((id: number) => {\r\n            if (current[id]) {\r\n                for (let i = 0; i < current[id].length; i++) {\r\n                    indices.push(current[id][i]);\r\n                }\r\n            }\r\n        });\r\n        const coords = this.getCoordinates(modelID);\r\n        const initial = this.modelCoordinates[modelID];\r\n        if (hide) indices.forEach(i => coords.set([0, 0, 0], i));\r\n        else indices.forEach(i => coords.set([initial[i], initial[i + 1], initial[i+2]], i));\r\n\r\n        this.getAttributes(modelID).position.needsUpdate = true;\r\n    }\r\n\r\n    showAllItems(modelID: number) {\r\n        if (this.modelCoordinates[modelID]) {\r\n            this.resetCoordinates(modelID);\r\n            this.getAttributes(modelID).position.needsUpdate = true;\r\n        }\r\n    }\r\n\r\n    hideAllItems(modelID: number) {\r\n        this.getCoordinates(modelID).fill(0);\r\n        this.getAttributes(modelID).position.needsUpdate = true;\r\n    }\r\n\r\n    private initializeCoordinates(modelID: number) {\r\n        const coordinates = this.getCoordinates(modelID);\r\n        if (!this.modelCoordinates[modelID]) {\r\n            this.modelCoordinates[modelID] = new Float32Array(coordinates);\r\n        }\r\n    }\r\n\r\n    private resetCoordinates(modelID: number) {\r\n        const initial = this.modelCoordinates[modelID];\r\n        this.getCoordinates(modelID).set(initial);\r\n    }\r\n\r\n    private getCoordinates(modelID: number) {\r\n        return this.getAttributes(modelID).position.array as Float32Array;\r\n    }\r\n\r\n    private getAttributes(modelID: number) {\r\n        return this.state.models[modelID].mesh.geometry.attributes;\r\n    }\r\n}","import { IfcModel, IfcState } from '../BaseDefinitions';\r\nimport { Mesh } from 'three';\r\n\r\nexport class MemoryCleaner {\r\n    constructor(private state: IfcState) {};\r\n\r\n    releaseAllModels() {\r\n        const models = Object.values(this.state.models);\r\n        models.forEach(model => {\r\n            this.releaseMeshModelMemory(model);\r\n            this.releaseJSONMemory(model);\r\n            this.releaseGeometryByMaterials(model);\r\n            // @ts-ignore\r\n            model.types = null;\r\n        });\r\n    }\r\n\r\n    private releaseGeometryByMaterials(model: IfcModel) {\r\n        const keys = Object.keys(model.items);\r\n        keys.forEach(key => {\r\n            const geomsByMat = model.items[key];\r\n            geomsByMat.material.dispose();\r\n            // @ts-ignore\r\n            geomsByMat.material = null;\r\n\r\n            Object.values(geomsByMat.geometries).forEach(geom => geom.dispose());\r\n            // @ts-ignore\r\n            geomsByMat.geometries = null;\r\n        });\r\n        // @ts-ignore\r\n        model.items = null;\r\n    }\r\n\r\n    private releaseJSONMemory(model: IfcModel) {\r\n        const keys = Object.keys(model.jsonData);\r\n        keys.forEach((key) => delete model.jsonData[parseInt(key)]);\r\n        // @ts-ignore\r\n        model.jsonData = null;\r\n    }\r\n\r\n    private releaseMeshModelMemory(model: IfcModel) {\r\n        this.releaseMeshMemory(model.mesh);\r\n        // @ts-ignore\r\n        model.mesh = null;\r\n    }\r\n\r\n    private releaseMeshMemory(mesh: Mesh) {\r\n        if (mesh.geometry) {\r\n            mesh.geometry.dispose();\r\n        }\r\n        if (mesh.parent) {\r\n            mesh.parent.remove(mesh);\r\n        }\r\n        if (mesh.material) {\r\n            Array.isArray(mesh.material) ?\r\n                mesh.material.forEach(mat => mat.dispose()) :\r\n                mesh.material.dispose();\r\n        }\r\n        if(mesh.children.length > 0) {\r\n            mesh.children.forEach(child => {\r\n                if(child.type === \"Mesh\") this.releaseMeshMemory(child as Mesh);\r\n                mesh.remove(child);\r\n            })\r\n        }\r\n    }\r\n}","import { HighlightConfigOfModel, IfcState, WebIfcAPI } from '../BaseDefinitions';\r\nimport { BvhManager } from '../components/BvhManager';\r\nimport { Material, Object3D } from 'three';\r\n\r\nexport interface IfcWorkerAPI {\r\n    post: (data: any) => void;\r\n    initializeAPI: (api: WebIfcAPI) => void;\r\n    state?: IfcState;\r\n    postCallback: (data: any, result: any, serializer?: any) => void;\r\n}\r\n\r\nexport enum WorkerActions {\r\n    // Worker State Actions\r\n    updateStateUseJson = 'updateStateUseJson',\r\n    updateStateWebIfcSettings = 'updateStateWebIfcSettings',\r\n    updateModelStateTypes = 'updateModelStateTypes',\r\n    updateModelStateJsonData = 'updateModelStateJsonData',\r\n    loadJsonDataFromWorker = 'loadJsonDataFromWorker',\r\n\r\n    // WebIFC Actions\r\n    Close = 'Close',\r\n    Init = 'Init',\r\n    OpenModel = 'OpenModel',\r\n    CreateModel = 'CreateModel',\r\n    ExportFileAsIFC = 'ExportFileAsIFC',\r\n    GetGeometry = 'GetGeometry',\r\n    GetLine = 'GetLine',\r\n    GetAndClearErrors = 'GetAndClearErrors',\r\n    WriteLine = 'WriteLine',\r\n    FlattenLine = 'FlattenLine',\r\n    GetRawLineData = 'GetRawLineData',\r\n    WriteRawLineData = 'WriteRawLineData',\r\n    GetLineIDsWithType = 'GetLineIDsWithType',\r\n    GetAllLines = 'GetAllLines',\r\n    SetGeometryTransformation = 'SetGeometryTransformation',\r\n    GetCoordinationMatrix = 'GetCoordinationMatrix',\r\n    GetVertexArray = 'GetVertexArray',\r\n    GetIndexArray = 'GetIndexArray',\r\n    getSubArray = 'getSubArray',\r\n    CloseModel = 'CloseModel',\r\n    StreamAllMeshes = 'StreamAllMeshes',\r\n    StreamAllMeshesWithTypes = 'StreamAllMeshesWithTypes',\r\n    IsModelOpen = 'IsModelOpen',\r\n    LoadAllGeometry = 'LoadAllGeometry',\r\n    GetFlatMesh = 'GetFlatMesh',\r\n    SetWasmPath = 'SetWasmPath',\r\n\r\n    // Parser\r\n    parse = 'parse',\r\n    setupOptionalCategories = 'setupOptionalCategories',\r\n\r\n    // Properties\r\n    getExpressId = 'getExpressId',\r\n    initializeProperties = 'initializeProperties',\r\n    getAllItemsOfType = 'getAllItemsOfType',\r\n    getItemProperties = 'getItemProperties',\r\n    getMaterialsProperties = 'getMaterialsProperties',\r\n    getPropertySets = 'getPropertySets',\r\n    getSpatialStructure = 'getSpatialStructure',\r\n    getTypeProperties = 'getTypeProperties'\r\n}\r\n\r\nexport enum WorkerAPIs {\r\n    workerState = 'workerState',\r\n    webIfc = 'webIfc',\r\n    properties = 'properties',\r\n    parser = 'parser',\r\n}\r\n\r\nexport interface IfcEventData {\r\n    worker: WorkerAPIs;\r\n    action: WorkerActions;\r\n    args: any;\r\n    id: number;\r\n    result: any;\r\n    onProgress: boolean;\r\n}\r\n\r\nexport interface RootWorker {\r\n    [WorkerAPIs.workerState]: WorkerStateAPI;\r\n    [WorkerAPIs.webIfc]: WebIfcWorkerAPI;\r\n    [WorkerAPIs.properties]: PropertyWorkerAPI;\r\n}\r\n\r\nexport interface BaseWorkerAPI {\r\n    API: WorkerAPIs;\r\n}\r\n\r\nexport type IfcWorkerEventHandler = (data: IfcEventData) => void;\r\n\r\nexport interface WorkerStateAPI extends BaseWorkerAPI {\r\n    [WorkerActions.updateStateUseJson]: IfcWorkerEventHandler;\r\n    [WorkerActions.updateStateWebIfcSettings]: IfcWorkerEventHandler;\r\n    [WorkerActions.updateModelStateTypes]: IfcWorkerEventHandler;\r\n    [WorkerActions.updateModelStateJsonData]: IfcWorkerEventHandler;\r\n    [WorkerActions.loadJsonDataFromWorker]: IfcWorkerEventHandler;\r\n}\r\n\r\nexport interface PropertyWorkerAPI extends BaseWorkerAPI {\r\n    [WorkerActions.getAllItemsOfType]: IfcWorkerEventHandler;\r\n    [WorkerActions.getItemProperties]: IfcWorkerEventHandler;\r\n    [WorkerActions.getMaterialsProperties]: IfcWorkerEventHandler;\r\n    [WorkerActions.getPropertySets]: IfcWorkerEventHandler;\r\n    [WorkerActions.getSpatialStructure]: IfcWorkerEventHandler;\r\n    [WorkerActions.getTypeProperties]: IfcWorkerEventHandler;\r\n}\r\n\r\nexport interface ParserWorkerAPI extends BaseWorkerAPI {\r\n    [WorkerActions.parse]: IfcWorkerEventHandler;\r\n    [WorkerActions.setupOptionalCategories]: IfcWorkerEventHandler;\r\n}\r\n\r\nexport interface WebIfcWorkerAPI extends BaseWorkerAPI {\r\n    [WorkerActions.Init]: IfcWorkerEventHandler;\r\n    [WorkerActions.Close]: IfcWorkerEventHandler;\r\n    [WorkerActions.OpenModel]: IfcWorkerEventHandler;\r\n    [WorkerActions.CreateModel]: IfcWorkerEventHandler;\r\n    [WorkerActions.ExportFileAsIFC]: IfcWorkerEventHandler;\r\n    [WorkerActions.GetGeometry]: IfcWorkerEventHandler;\r\n    [WorkerActions.GetLine]: IfcWorkerEventHandler;\r\n    [WorkerActions.GetAndClearErrors]: IfcWorkerEventHandler;\r\n    [WorkerActions.WriteLine]: IfcWorkerEventHandler;\r\n    [WorkerActions.FlattenLine]: IfcWorkerEventHandler;\r\n    [WorkerActions.GetRawLineData]: IfcWorkerEventHandler;\r\n    [WorkerActions.WriteRawLineData]: IfcWorkerEventHandler;\r\n    [WorkerActions.GetLineIDsWithType]: IfcWorkerEventHandler;\r\n    [WorkerActions.GetAllLines]: IfcWorkerEventHandler;\r\n    [WorkerActions.SetGeometryTransformation]: IfcWorkerEventHandler;\r\n    [WorkerActions.GetCoordinationMatrix]: IfcWorkerEventHandler;\r\n    [WorkerActions.GetVertexArray]: IfcWorkerEventHandler;\r\n    [WorkerActions.GetIndexArray]: IfcWorkerEventHandler;\r\n    [WorkerActions.getSubArray]: IfcWorkerEventHandler;\r\n    [WorkerActions.CloseModel]: IfcWorkerEventHandler;\r\n    [WorkerActions.StreamAllMeshes]: IfcWorkerEventHandler;\r\n    [WorkerActions.StreamAllMeshesWithTypes]: IfcWorkerEventHandler;\r\n    [WorkerActions.IsModelOpen]: IfcWorkerEventHandler;\r\n    [WorkerActions.LoadAllGeometry]: IfcWorkerEventHandler;\r\n    [WorkerActions.GetFlatMesh]: IfcWorkerEventHandler;\r\n    [WorkerActions.SetWasmPath]: IfcWorkerEventHandler;\r\n}\r\n\r\nexport interface SerializedVector {\r\n    [key: number]: any;\r\n\r\n    size: number;\r\n}\r\n\r\nexport interface SerializedIfcGeometry {\r\n    GetVertexData: number;\r\n    GetVertexDataSize: number;\r\n    GetIndexData: number;\r\n    GetIndexDataSize: number;\r\n}\r\n\r\nexport interface SerializedFlatMesh {\r\n    geometries: SerializedVector;\r\n    expressID: number;\r\n}\r\n\r\nexport const ErrorStateNotAvailable = 'The state of the worker does not exist';\r\nexport const ErrorRootStateNotAvailable = 'The root worker does not have any state';\r\nexport const ErrorPropertiesNotAvailable = 'Error: Properties not available from web worker';\r\nexport const ErrorParserNotAvailable = 'Error: Parser not available from web worker';\r\nexport const ErrorBadJsonPath = 'Error: Model not available from web worker';\r\nexport const ErrorBadJson = 'Error: The given Json could not be read as a JS object';","import { SerializedVector } from '../BaseDefinitions';\r\nimport { Vector as WebIfcVector } from 'web-ifc';\r\n\r\nexport class Vector<T> implements WebIfcVector<T> {\r\n    private readonly _size: number;\r\n    private _data: { [key: number]: T } = {};\r\n\r\n    constructor(vector: SerializedVector) {\r\n        this._size = vector.size;\r\n        const keys = Object.keys(vector).filter((key) => key.indexOf('size') === -1).map(key => parseInt(key));\r\n        keys.forEach((key) => this._data[key] = vector[key]);\r\n    }\r\n\r\n    size() {\r\n        return this._size;\r\n    }\r\n\r\n    get(index: number) {\r\n        return this._data[index];\r\n    }\r\n}","import { SerializedIfcGeometry } from '../BaseDefinitions';\r\nimport { IfcGeometry as WebIfcIfcGeometry } from 'web-ifc';\r\n\r\nexport class IfcGeometry implements WebIfcIfcGeometry {\r\n    private readonly _GetVertexData: number;\r\n    private readonly _GetVertexDataSize: number;\r\n    private readonly _GetIndexData: number;\r\n    private readonly _GetIndexDataSize: number;\r\n\r\n    constructor(vector: SerializedIfcGeometry) {\r\n        this._GetVertexData = vector.GetVertexData;\r\n        this._GetVertexDataSize = vector.GetVertexDataSize;\r\n        this._GetIndexData = vector.GetIndexData;\r\n        this._GetIndexDataSize = vector.GetIndexDataSize;\r\n    }\r\n\r\n    GetVertexData() {\r\n        return this._GetVertexData;\r\n    }\r\n\r\n    GetVertexDataSize() {\r\n        return this._GetVertexDataSize;\r\n    }\r\n\r\n    GetIndexData() {\r\n        return this._GetIndexData;\r\n    }\r\n\r\n    GetIndexDataSize() {\r\n        return this._GetIndexDataSize;\r\n    }\r\n}","import { SerializedFlatMesh } from '../BaseDefinitions';\r\nimport { FlatMesh as WebIfcFlatMesh, PlacedGeometry } from 'web-ifc';\r\nimport { Vector } from './Vector';\r\nimport { Serializer } from './Serializer';\r\n\r\nexport class FlatMesh implements WebIfcFlatMesh {\r\n    geometries: Vector<PlacedGeometry>;\r\n    expressID: number;\r\n\r\n    constructor(serializer: Serializer, flatMesh: SerializedFlatMesh) {\r\n        this.expressID = flatMesh.expressID;\r\n        this.geometries = serializer.reconstructVector(flatMesh.geometries);\r\n    }\r\n}","import { SerializedVector } from '../BaseDefinitions';\r\nimport { FlatMesh as WebIfcFlatMesh, Vector as WebIfcVector } from 'web-ifc';\r\nimport { Serializer } from './Serializer';\r\n\r\nexport class FlatMeshVector implements WebIfcVector<WebIfcFlatMesh> {\r\n    private readonly _size: number;\r\n    private _data: { [key: number]: WebIfcFlatMesh } = {};\r\n\r\n    constructor(serializer: Serializer, vector: SerializedVector) {\r\n        this._size = vector.size;\r\n        const keys = Object.keys(vector).filter((key) => key.indexOf('size') === -1).map(key => parseInt(key));\r\n        keys.forEach(key => this._data[key] = serializer.reconstructFlatMesh(vector[key]));\r\n    }\r\n\r\n    size() {\r\n        return this._size;\r\n    }\r\n\r\n    get(index: number) {\r\n        return this._data[index];\r\n    }\r\n}","import { Color, MeshLambertMaterial } from 'three';\r\n\r\nexport class SerializedMaterial {\r\n    color: number[];\r\n    opacity: number;\r\n    transparent: boolean;\r\n\r\n    constructor(material: MeshLambertMaterial) {\r\n        this.color = [material.color.r, material.color.g, material.color.b];\r\n        this.opacity = material.opacity;\r\n        this.transparent = material.transparent;\r\n    }\r\n}\r\n\r\nexport class MaterialReconstructor {\r\n    static new(material: SerializedMaterial) {\r\n        return new MeshLambertMaterial({\r\n            color: new Color(material.color[0], material.color[1], material.color[2]),\r\n            opacity: material.opacity,\r\n            transparent: material.transparent\r\n        })\r\n    }\r\n}","import { BufferAttribute, BufferGeometry } from 'three';\r\nimport { IFCModel } from '../../components/IFCModel';\r\n\r\nexport class SerializedGeometry {\r\n    position: ArrayLike<number>;\r\n    normal: ArrayLike<number>;\r\n    expressID: ArrayLike<number>;\r\n    index: ArrayLike<number>;\r\n    groups: { start: number, count: number, materialIndex?: number }[];\r\n\r\n    constructor(geometry: BufferGeometry) {\r\n        this.position = geometry.attributes.position?.array || [];\r\n        this.normal = geometry.attributes.normal?.array || [];\r\n        this.expressID = geometry.attributes.expressID?.array || [];\r\n        this.index = geometry.index?.array || [];\r\n        this.groups = geometry.groups;\r\n    }\r\n}\r\n\r\nexport class GeometryReconstructor {\r\n    static new(serialized: SerializedGeometry) {\r\n        const geom = new BufferGeometry();\r\n        GeometryReconstructor.set(geom, 'expressID', new Uint32Array(serialized.expressID), 1);\r\n        GeometryReconstructor.set(geom, 'position', new Float32Array(serialized.position), 3);\r\n        GeometryReconstructor.set(geom, 'normal', new Float32Array(serialized.normal), 3);\r\n        geom.setIndex(Array.from(serialized.index));\r\n        geom.groups = serialized.groups;\r\n        return geom;\r\n    }\r\n\r\n    private static set(geom: BufferGeometry, name: string, data: ArrayLike<number>, size: number) {\r\n        if(data.length > 0) {\r\n            geom.setAttribute(name, new BufferAttribute(data, size));\r\n        }\r\n    }\r\n}","import { IFCModel } from '../../components/IFCModel';\r\nimport { Material, MeshLambertMaterial } from 'three';\r\nimport { MaterialReconstructor, SerializedMaterial } from './Material';\r\nimport { GeometryReconstructor, SerializedGeometry } from './Geometry';\r\n\r\nexport class SerializedMesh {\r\n\r\n    modelID: number;\r\n    geometry: SerializedGeometry;\r\n    materials: SerializedMaterial [] = [];\r\n\r\n    constructor(model: IFCModel) {\r\n        this.modelID = model.modelID;\r\n        this.geometry = new SerializedGeometry(model.geometry);\r\n        if (Array.isArray(model.material)) {\r\n            model.material.forEach(mat => {\r\n                this.materials.push(new SerializedMaterial(mat as MeshLambertMaterial));\r\n            });\r\n        } else {\r\n            this.materials.push(new SerializedMaterial(model.material as MeshLambertMaterial));\r\n        }\r\n    }\r\n}\r\n\r\nexport class MeshReconstructor {\r\n\r\n    static new(serialized: SerializedMesh) {\r\n        const model = new IFCModel();\r\n        model.modelID = serialized.modelID;\r\n        model.geometry = GeometryReconstructor.new(serialized.geometry);\r\n        MeshReconstructor.getMaterials(serialized, model);\r\n        return model;\r\n    }\r\n\r\n    private static getMaterials(serialized: SerializedMesh, model: IFCModel) {\r\n        model.material = [];\r\n        const mats = model.material as Material[];\r\n        serialized.materials.forEach(mat => {\r\n            mats.push(MaterialReconstructor.new(mat));\r\n        });\r\n    }\r\n}","import { GeometriesByMaterials } from '../../BaseDefinitions';\r\nimport { MaterialReconstructor, SerializedMaterial } from './Material';\r\nimport { GeometryReconstructor, SerializedGeometry } from './Geometry';\r\nimport { MeshLambertMaterial } from 'three';\r\n\r\nexport interface SerializedGeomsByMat {\r\n    [materialID: string]: {\r\n        material: SerializedMaterial,\r\n        geometries: {[expressID: number]: SerializedGeometry}\r\n    }\r\n}\r\n\r\nexport class SerializedGeomsByMaterials implements SerializedGeomsByMat {\r\n\r\n    constructor(geoms: GeometriesByMaterials) {\r\n        const matIDs = Object.keys(geoms);\r\n        matIDs.forEach(id => {\r\n            this[id] = {} as any;\r\n            this[id].material = new SerializedMaterial(geoms[id].material as MeshLambertMaterial);\r\n            this[id].geometries = {};\r\n            const expressIDs = Object.keys(geoms[id].geometries).map(key => parseInt(key));\r\n            expressIDs.forEach(expressID => {\r\n                this[id].geometries[expressID] = new SerializedGeometry(geoms[id].geometries[expressID]);\r\n            })\r\n        })\r\n    }\r\n\r\n    [materialID: string]: { material: SerializedMaterial; geometries: { [expressID: number]: SerializedGeometry; }; };\r\n}\r\n\r\nexport class GeomsByMaterialsReconstructor {\r\n    static new(serialized: SerializedGeomsByMaterials) {\r\n        const geomsByMat: GeometriesByMaterials = {}\r\n        const matIDs = Object.keys(serialized);\r\n        matIDs.forEach(id => {\r\n            geomsByMat[id] = {} as any;\r\n            geomsByMat[id].material = MaterialReconstructor.new(serialized[id].material);\r\n            geomsByMat[id].geometries = {};\r\n            const expressIDs = Object.keys(serialized[id].geometries).map(id => parseInt(id));\r\n            expressIDs.forEach(expressID => {\r\n                geomsByMat[id].geometries[expressID] = GeometryReconstructor.new(serialized[id].geometries[expressID]);\r\n            })\r\n        })\r\n        return geomsByMat;\r\n    }\r\n}","import { Vector as WebIfcVector, IfcGeometry as WebIfcIfcGeometry, FlatMesh as WebIfcFlatMesh } from 'web-ifc';\r\nimport { SerializedFlatMesh, SerializedIfcGeometry, SerializedVector } from '../BaseDefinitions';\r\nimport { Vector } from './Vector';\r\nimport { IfcGeometry } from './IfcGeometry';\r\nimport { FlatMesh } from './FlatMesh';\r\nimport { FlatMeshVector } from './FlatMeshVector';\r\nimport { IFCModel } from '../../components/IFCModel';\r\nimport { MeshReconstructor, SerializedMesh } from './Mesh';\r\nimport { GeometriesByMaterials } from '../../BaseDefinitions';\r\nimport { GeomsByMaterialsReconstructor, SerializedGeomsByMaterials } from './GeomsByMaterials';\r\n\r\nexport class Serializer {\r\n\r\n    serializeVector<T>(vector: WebIfcVector<T>) {\r\n        const size = vector.size();\r\n        const serialized: SerializedVector = { size };\r\n        for (let i = 0; i < size; i++) {\r\n            serialized[i] = vector.get(i);\r\n        }\r\n        return serialized;\r\n    }\r\n\r\n    reconstructVector(vector: SerializedVector): Vector<any> {\r\n        return new Vector(vector);\r\n    }\r\n\r\n    serializeIfcGeometry(geometry: WebIfcIfcGeometry) {\r\n        const GetVertexData = geometry.GetVertexData();\r\n        const GetVertexDataSize = geometry.GetVertexDataSize();\r\n        const GetIndexData = geometry.GetIndexData();\r\n        const GetIndexDataSize = geometry.GetIndexDataSize();\r\n        return {\r\n            GetVertexData,\r\n            GetVertexDataSize,\r\n            GetIndexData,\r\n            GetIndexDataSize\r\n        } as SerializedIfcGeometry;\r\n    }\r\n\r\n    reconstructIfcGeometry(geometry: SerializedIfcGeometry) {\r\n        return new IfcGeometry(geometry);\r\n    }\r\n\r\n    serializeFlatMesh(flatMesh: WebIfcFlatMesh) {\r\n        return {\r\n            expressID: flatMesh.expressID,\r\n            geometries: this.serializeVector(flatMesh.geometries)\r\n        } as SerializedFlatMesh;\r\n    }\r\n\r\n    reconstructFlatMesh(flatMesh: SerializedFlatMesh) {\r\n        return new FlatMesh(this, flatMesh);\r\n    }\r\n\r\n    serializeFlatMeshVector(vector: WebIfcVector<WebIfcFlatMesh>) {\r\n        const size = vector.size();\r\n        const serialized: SerializedVector = { size };\r\n        for (let i = 0; i < size; i++) {\r\n            const flatMesh = vector.get(i);\r\n            serialized[i] = this.serializeFlatMesh(flatMesh);\r\n        }\r\n        return serialized;\r\n    }\r\n\r\n    reconstructFlatMeshVector(vector: SerializedVector): WebIfcVector<WebIfcFlatMesh> {\r\n        return new FlatMeshVector(this, vector);\r\n    }\r\n\r\n    serializeIfcModel(model: IFCModel) {\r\n        return new SerializedMesh(model);\r\n    }\r\n\r\n    reconstructIfcModel(model: SerializedMesh) {\r\n        return MeshReconstructor.new(model);\r\n    }\r\n\r\n    serializeGeometriesByMaterials(geoms: GeometriesByMaterials) {\r\n        return new SerializedGeomsByMaterials(geoms);\r\n    }\r\n\r\n    reconstructGeometriesByMaterials(geoms: SerializedGeomsByMaterials) {\r\n        return GeomsByMaterialsReconstructor.new(geoms);\r\n    }\r\n}","import { PropertyAPI, PropertyManagerAPI } from '../../components/properties/BaseDefinitions';\r\nimport { IFCWorkerHandler } from '../IFCWorkerHandler';\r\nimport { WorkerActions, WorkerAPIs } from '../BaseDefinitions';\r\nimport { BufferGeometry } from 'three';\r\nimport { IdAttrName } from '../../BaseDefinitions';\r\n\r\nexport class PropertyHandler implements PropertyManagerAPI {\r\n\r\n    API = WorkerAPIs.properties;\r\n\r\n    constructor(private handler: IFCWorkerHandler) {\r\n    }\r\n\r\n    getExpressId(geometry: BufferGeometry, faceIndex: number) {\r\n        if (!geometry.index) throw new Error('Geometry does not have index information.');\r\n        const geoIndex = geometry.index.array;\r\n        return geometry.attributes[IdAttrName].getX(geoIndex[3 * faceIndex]);\r\n    }\r\n\r\n    getAllItemsOfType(modelID: number, type: number, verbose: boolean): Promise<any[]> {\r\n        return this.handler.request(this.API, WorkerActions.getAllItemsOfType, { modelID, type, verbose });\r\n    }\r\n\r\n    getItemProperties(modelID: number, elementID: number, recursive: boolean): Promise<any> {\r\n        return this.handler.request(this.API, WorkerActions.getItemProperties, { modelID, elementID, recursive });\r\n    }\r\n\r\n    getMaterialsProperties(modelID: number, elementID: number, recursive: boolean): Promise<any[]> {\r\n        return this.handler.request(this.API, WorkerActions.getMaterialsProperties, { modelID, elementID, recursive });\r\n    }\r\n\r\n    getPropertySets(modelID: number, elementID: number, recursive: boolean): Promise<any[]> {\r\n        return this.handler.request(this.API, WorkerActions.getPropertySets, { modelID, elementID, recursive });\r\n    }\r\n\r\n    getTypeProperties(modelID: number, elementID: number, recursive: boolean): Promise<any[]> {\r\n        return this.handler.request(this.API, WorkerActions.getTypeProperties, { modelID, elementID, recursive });\r\n    }\r\n\r\n    getSpatialStructure(modelID: number, includeProperties?: boolean): Promise<any> {\r\n        return this.handler.request(this.API, WorkerActions.getSpatialStructure, { modelID, includeProperties });\r\n    }\r\n}","import { WebIfcAPI } from '../../BaseDefinitions';\r\nimport {\r\n    SerializedFlatMesh,\r\n    SerializedIfcGeometry,\r\n    SerializedVector,\r\n    WorkerActions,\r\n    WorkerAPIs\r\n} from '../BaseDefinitions';\r\nimport { FlatMesh, IfcGeometry, LoaderError, LoaderSettings, RawLineData, Vector } from 'web-ifc';\r\nimport { IFCWorkerHandler } from '../IFCWorkerHandler';\r\nimport { Serializer } from '../serializer/Serializer';\r\n\r\nexport class WebIfcHandler implements WebIfcAPI {\r\n\r\n    wasmModule: any;\r\n    API = WorkerAPIs.webIfc;\r\n\r\n    constructor(private handler: IFCWorkerHandler, private serializer: Serializer) {\r\n    }\r\n\r\n    async Init(): Promise<void> {\r\n        this.wasmModule = true;\r\n        return this.handler.request(this.API, WorkerActions.Init);\r\n    }\r\n\r\n    async OpenModel(data: string | Uint8Array, settings?: LoaderSettings): Promise<number> {\r\n        return this.handler.request(this.API, WorkerActions.OpenModel, { data, settings });\r\n    }\r\n\r\n    async CreateModel(settings?: LoaderSettings): Promise<number> {\r\n        return this.handler.request(this.API, WorkerActions.CreateModel, { settings });\r\n    }\r\n\r\n    async ExportFileAsIFC(modelID: number): Promise<Uint8Array> {\r\n        return this.handler.request(this.API, WorkerActions.ExportFileAsIFC, { modelID });\r\n    }\r\n\r\n    async GetGeometry(modelID: number, geometryExpressID: number): Promise<IfcGeometry> {\r\n        this.handler.serializeHandlers[this.handler.requestID] = (geom: SerializedIfcGeometry) => {\r\n            return this.serializer.reconstructIfcGeometry(geom);\r\n        }\r\n        return this.handler.request(this.API, WorkerActions.GetGeometry, { modelID, geometryExpressID });\r\n    }\r\n\r\n    async GetLine(modelID: number, expressID: number, flatten?: boolean): Promise<any> {\r\n        return this.handler.request(this.API, WorkerActions.GetLine, { modelID, expressID, flatten });\r\n    }\r\n\r\n    async GetAndClearErrors(modelID: number): Promise<Vector<LoaderError>> {\r\n        this.handler.serializeHandlers[this.handler.requestID] = (vector: SerializedVector) => {\r\n            return this.serializer.reconstructVector(vector);\r\n        }\r\n        return this.handler.request(this.API, WorkerActions.GetAndClearErrors, { modelID });\r\n    }\r\n\r\n    async WriteLine(modelID: number, lineObject: any): Promise<void> {\r\n        return this.handler.request(this.API, WorkerActions.WriteLine, { modelID, lineObject });\r\n    }\r\n\r\n    async FlattenLine(modelID: number, line: any): Promise<void> {\r\n        return this.handler.request(this.API, WorkerActions.FlattenLine, { modelID, line });\r\n    }\r\n\r\n    async GetRawLineData(modelID: number, expressID: number): Promise<RawLineData> {\r\n        return this.handler.request(this.API, WorkerActions.GetRawLineData, { modelID, expressID });\r\n    }\r\n\r\n    async WriteRawLineData(modelID: number, data: RawLineData): Promise<any> {\r\n        return this.handler.request(this.API, WorkerActions.WriteRawLineData, { modelID, data });\r\n    }\r\n\r\n    async GetLineIDsWithType(modelID: number, type: number): Promise<Vector<number>> {\r\n        this.handler.serializeHandlers[this.handler.requestID] = (vector: SerializedVector) => {\r\n            return this.serializer.reconstructVector(vector);\r\n        }\r\n        return this.handler.request(this.API, WorkerActions.GetLineIDsWithType, { modelID, type });\r\n    }\r\n\r\n    async GetAllLines(modelID: number): Promise<Vector<number>> {\r\n        this.handler.serializeHandlers[this.handler.requestID] = (vector: SerializedVector) => {\r\n            return this.serializer.reconstructVector(vector);\r\n        }\r\n        return this.handler.request(this.API, WorkerActions.GetAllLines, { modelID });\r\n    }\r\n\r\n    async SetGeometryTransformation(modelID: number, transformationMatrix: number[]): Promise<void> {\r\n        return this.handler.request(this.API, WorkerActions.SetGeometryTransformation, {\r\n            modelID,\r\n            transformationMatrix\r\n        });\r\n    }\r\n\r\n    async GetCoordinationMatrix(modelID: number): Promise<number[]> {\r\n        return this.handler.request(this.API, WorkerActions.GetCoordinationMatrix, { modelID });\r\n    }\r\n\r\n    async GetVertexArray(ptr: number, size: number): Promise<Float32Array> {\r\n        return this.handler.request(this.API, WorkerActions.GetVertexArray, { ptr, size });\r\n    }\r\n\r\n    async GetIndexArray(ptr: number, size: number): Promise<Uint32Array> {\r\n        return this.handler.request(this.API, WorkerActions.GetIndexArray, { ptr, size });\r\n    }\r\n\r\n    async getSubArray(heap: any, startPtr: any, sizeBytes: any): Promise<any> {\r\n        return this.handler.request(this.API, WorkerActions.getSubArray, { heap, startPtr, sizeBytes });\r\n    }\r\n\r\n    async CloseModel(modelID: number): Promise<void> {\r\n        return this.handler.request(this.API, WorkerActions.CloseModel, { modelID });\r\n    }\r\n\r\n    async StreamAllMeshes(modelID: number, meshCallback: (mesh: FlatMesh) => void): Promise<void> {\r\n        this.handler.callbackHandlers[this.handler.requestID] = {\r\n            action: meshCallback,\r\n            serializer: this.serializer.reconstructFlatMesh\r\n        };\r\n        return this.handler.request(this.API, WorkerActions.StreamAllMeshes, { modelID });\r\n    }\r\n\r\n    async StreamAllMeshesWithTypes(modelID: number, types: number[], meshCallback: (mesh: FlatMesh) => void): Promise<void> {\r\n        this.handler.callbackHandlers[this.handler.requestID] = {\r\n            action: meshCallback,\r\n            serializer: this.serializer.reconstructFlatMesh\r\n        };\r\n        return this.handler.request(this.API, WorkerActions.StreamAllMeshesWithTypes, { modelID, types });\r\n    }\r\n\r\n    async IsModelOpen(modelID: number): Promise<boolean> {\r\n        return this.handler.request(this.API, WorkerActions.IsModelOpen, { modelID });\r\n    }\r\n\r\n    async LoadAllGeometry(modelID: number): Promise<Vector<FlatMesh>> {\r\n        this.handler.serializeHandlers[this.handler.requestID] = (vector: SerializedVector) => {\r\n            return this.serializer.reconstructFlatMeshVector(vector);\r\n        }\r\n        return this.handler.request(this.API, WorkerActions.LoadAllGeometry, { modelID });\r\n    }\r\n\r\n    async GetFlatMesh(modelID: number, expressID: number): Promise<FlatMesh> {\r\n        this.handler.serializeHandlers[this.handler.requestID] = (flatMesh: SerializedFlatMesh) => {\r\n            return this.serializer.reconstructFlatMesh(flatMesh);\r\n        }\r\n        return this.handler.request(this.API, WorkerActions.GetFlatMesh, { modelID, expressID });\r\n    }\r\n\r\n    async SetWasmPath(path: string): Promise<void> {\r\n        return this.handler.request(this.API, WorkerActions.SetWasmPath, { path });\r\n    }\r\n}","import { WorkerActions, WorkerAPIs } from '../BaseDefinitions';\r\nimport { IFCWorkerHandler } from '../IFCWorkerHandler';\r\nimport { IfcState } from '../../BaseDefinitions';\r\n\r\nexport class WorkerStateHandler {\r\n    API = WorkerAPIs.workerState;\r\n    state: IfcState;\r\n\r\n    constructor(private handler: IFCWorkerHandler) {\r\n        this.state = this.handler.state;\r\n    }\r\n\r\n    async updateStateUseJson() {\r\n        const useJson = this.state.useJSON;\r\n        return this.handler.request(this.API, WorkerActions.updateStateUseJson, { useJson });\r\n    }\r\n\r\n    async updateStateWebIfcSettings() {\r\n        const webIfcSettings = this.state.webIfcSettings;\r\n        return this.handler.request(this.API, WorkerActions.updateStateWebIfcSettings, { webIfcSettings });\r\n    }\r\n\r\n    async updateModelStateTypes (modelID: number, types: any) {\r\n        return this.handler.request(this.API, WorkerActions.updateModelStateTypes, { modelID, types });\r\n    }\r\n\r\n    async updateModelStateJsonData(modelID: number, jsonData: any) {\r\n        return this.handler.request(this.API, WorkerActions.updateModelStateJsonData, { modelID, jsonData });\r\n    }\r\n\r\n    async loadJsonDataFromWorker(modelID: number, path: string) {\r\n        return this.handler.request(this.API, WorkerActions.loadJsonDataFromWorker, { modelID, path });\r\n    }\r\n}","export enum DBOperation {\r\n    transferIfcModel,\r\n    transferIndividualItems\r\n}\r\n\r\nexport class IndexedDatabase {\r\n    async save(item: any, id: DBOperation) {\r\n        const open = IndexedDatabase.openOrCreateDB(id);\r\n        this.createSchema(open, id)\r\n        return new Promise<any>((resolve, reject) => {\r\n            open.onsuccess = () => this.saveItem(item, open, id, resolve);\r\n        });\r\n    }\r\n\r\n    async load(id: number) {\r\n        const open = IndexedDatabase.openOrCreateDB(id);\r\n        return new Promise<any>((resolve, reject) => {\r\n            open.onsuccess = () => this.loadItem(open, id, resolve);\r\n        })\r\n    }\r\n\r\n    private createSchema(open: IDBOpenDBRequest, id: DBOperation) {\r\n        open.onupgradeneeded = function () {\r\n            const db = open.result;\r\n            db.createObjectStore(id.toString(), {keyPath: \"id\"});\r\n        };\r\n    }\r\n\r\n    private saveItem(item: any, open: IDBOpenDBRequest, id: DBOperation, resolve: (value: any) => void ) {\r\n        const {db, tx, store} = IndexedDatabase.getDBItems(open, id);\r\n        item.id = id;\r\n        store.put(item);\r\n        tx.oncomplete = () => IndexedDatabase.closeDB(db, tx, resolve);\r\n    }\r\n\r\n    private loadItem(open: IDBOpenDBRequest, id: DBOperation, resolve: (value: any) => void ) {\r\n        const {db, tx, store} = IndexedDatabase.getDBItems(open, id);\r\n        const item = store.get(id);\r\n        const callback = () => {\r\n            delete item.result.id;\r\n            resolve(item.result)\r\n        };\r\n        tx.oncomplete = () => IndexedDatabase.closeDB(db, tx, callback);\r\n    }\r\n\r\n    private static getDBItems(open: IDBOpenDBRequest, id: DBOperation) {\r\n        const db = open.result;\r\n        const tx = db.transaction(id.toString(), \"readwrite\");\r\n        const store = tx.objectStore(id.toString());\r\n        return {db, tx, store};\r\n    }\r\n\r\n    private static openOrCreateDB(id: DBOperation) {\r\n        return indexedDB.open(id.toString(), 1);\r\n    }\r\n\r\n    private static closeDB(db: IDBDatabase, tx: IDBTransaction, resolve: (value: any) => void) {\r\n        db.close();\r\n        resolve(\"success\");\r\n    }\r\n}","import {OptionalCategories, ParserAPI, ParserProgress } from '../../components/IFCParser';\r\nimport { WorkerActions, WorkerAPIs } from '../BaseDefinitions';\r\nimport { IFCWorkerHandler } from '../IFCWorkerHandler';\r\nimport { IFCModel } from '../../components/IFCModel';\r\nimport { Serializer } from '../serializer/Serializer';\r\nimport { ParserResult } from '../workers/ParserWorker';\r\nimport { BvhManager } from '../../components/BvhManager';\r\nimport { DBOperation, IndexedDatabase } from '../../indexedDB/IndexedDatabase';\r\nimport { Matrix4 } from 'three';\r\n\r\nexport class ParserHandler implements ParserAPI {\r\n\r\n    API = WorkerAPIs.parser;\r\n\r\n    constructor(private handler: IFCWorkerHandler,\r\n                private serializer: Serializer,\r\n                private BVH: BvhManager,\r\n                private IDB: IndexedDatabase) {\r\n    }\r\n\r\n    async setupOptionalCategories(config: OptionalCategories) {\r\n        return this.handler.request(this.API, WorkerActions.setupOptionalCategories, {config});\r\n    }\r\n\r\n    async parse(buffer: any, coordinationMatrix?: number[]): Promise<IFCModel> {\r\n        this.handler.onprogressHandlers[this.handler.requestID] = (progress: ParserProgress) => {\r\n            if (this.handler.state.onProgress) this.handler.state.onProgress(progress);\r\n        };\r\n        this.handler.serializeHandlers[this.handler.requestID] = async (result: ParserResult) => {\r\n            this.updateState(result.modelID);\r\n            await this.getItems(result.modelID);\r\n            return this.getModel();\r\n        };\r\n        return this.handler.request(this.API, WorkerActions.parse, {buffer, coordinationMatrix});\r\n    }\r\n\r\n    getAndClearErrors(_modelId: number): void {\r\n    }\r\n\r\n    private updateState(modelID: number) {\r\n        this.handler.state.models[modelID] = {\r\n            modelID: modelID,\r\n            mesh: {} as any,\r\n            items: {},\r\n            types: {},\r\n            jsonData: {}\r\n        };\r\n    }\r\n\r\n    private async getItems(modelID: number) {\r\n        const items = await this.IDB.load(DBOperation.transferIndividualItems);\r\n        this.handler.state.models[modelID].items = this.serializer.reconstructGeometriesByMaterials(items);\r\n    }\r\n\r\n    private async getModel() {\r\n        const serializedModel = await this.IDB.load(DBOperation.transferIfcModel);\r\n        const model = this.serializer.reconstructIfcModel(serializedModel);\r\n        this.BVH.applyThreeMeshBVH(model.geometry);\r\n        this.handler.state.models[model.modelID].mesh = model;\r\n        return model;\r\n    }\r\n}","import {IfcEventData, WorkerActions, WorkerAPIs} from './BaseDefinitions';\r\nimport {Serializer} from './serializer/Serializer';\r\nimport {PropertyHandler} from './handlers/PropertyHandler';\r\nimport {WebIfcHandler} from './handlers/WebIfcHandler';\r\nimport {IfcState} from '../BaseDefinitions';\r\nimport {WorkerStateHandler} from './handlers/WorkerStateHandler';\r\nimport {ParserHandler} from './handlers/ParserHandler';\r\nimport {BVH} from 'three/examples/jsm/loaders/BVHLoader';\r\nimport {BvhManager} from '../components/BvhManager';\r\nimport {IndexedDatabase} from \"../indexedDB/IndexedDatabase\";\r\n\r\nexport class IFCWorkerHandler {\r\n\r\n    requestID = 0;\r\n    rejectHandlers: any = {};\r\n    resolveHandlers: any = {};\r\n    serializeHandlers: any = {};\r\n    callbackHandlers: { [id: number]: { action: any, serializer: any } } = {};\r\n    onprogressHandlers: any = {};\r\n\r\n    readonly IDB: IndexedDatabase;\r\n    readonly workerState: WorkerStateHandler;\r\n    readonly webIfc: WebIfcHandler;\r\n    readonly properties: PropertyHandler;\r\n    readonly parser: ParserHandler;\r\n\r\n    private ifcWorker: Worker;\r\n    private readonly serializer = new Serializer();\r\n    private readonly workerPath: string;\r\n\r\n    constructor(public state: IfcState, private BVH: BvhManager) {\r\n        this.IDB = new IndexedDatabase();\r\n        this.workerPath = this.state.worker.path;\r\n        this.ifcWorker = new Worker(this.workerPath);\r\n        this.ifcWorker.onmessage = (data: any) => this.handleResponse(data);\r\n        this.properties = new PropertyHandler(this);\r\n        this.parser = new ParserHandler(this, this.serializer, this.BVH, this.IDB);\r\n        this.webIfc = new WebIfcHandler(this, this.serializer);\r\n        this.workerState = new WorkerStateHandler(this);\r\n    }\r\n\r\n    request(worker: WorkerAPIs, action: WorkerActions, args?: any) {\r\n        const data: IfcEventData = {worker, action, args, id: this.requestID, result: undefined, onProgress: false};\r\n\r\n        return new Promise<any>((resolve, reject) => {\r\n            this.resolveHandlers[this.requestID] = resolve;\r\n            this.rejectHandlers[this.requestID] = reject;\r\n            this.requestID++;\r\n            this.ifcWorker.postMessage(data);\r\n        });\r\n    }\r\n\r\n    async Close(): Promise<void> {\r\n        await this.request(WorkerAPIs.webIfc, WorkerActions.Close);\r\n    }\r\n\r\n    private handleResponse(event: MessageEvent) {\r\n        const data = event.data as IfcEventData;\r\n        if (data.onProgress) {\r\n            this.resolveOnProgress(data);\r\n            return;\r\n        }\r\n        this.callHandlers(data);\r\n        delete this.resolveHandlers[data.id];\r\n        delete this.rejectHandlers[data.id];\r\n        delete this.onprogressHandlers[data.id];\r\n    }\r\n\r\n    private callHandlers(data: IfcEventData) {\r\n        try {\r\n            this.resolveSerializations(data);\r\n            this.resolveCallbacks(data);\r\n            this.resolveHandlers[data.id](data.result);\r\n        } catch (error) {\r\n            this.rejectHandlers[data.id](error);\r\n        }\r\n    }\r\n\r\n    private resolveOnProgress(data: IfcEventData) {\r\n        if (this.onprogressHandlers[data.id]) {\r\n            data.result = this.onprogressHandlers[data.id](data.result);\r\n        }\r\n    }\r\n\r\n    private resolveSerializations(data: IfcEventData) {\r\n        if (this.serializeHandlers[data.id]) {\r\n            data.result = this.serializeHandlers[data.id](data.result);\r\n            delete this.serializeHandlers[data.id];\r\n        }\r\n    }\r\n\r\n    private resolveCallbacks(data: IfcEventData) {\r\n        if (this.callbackHandlers[data.id]) {\r\n            let callbackParameter = data.result;\r\n            if (this.callbackHandlers[data.id].serializer) {\r\n                callbackParameter = this.callbackHandlers[data.id].serializer(data.result);\r\n            }\r\n            this.callbackHandlers[data.id].action(callbackParameter);\r\n        }\r\n    }\r\n}","import * as WebIFC from 'web-ifc';\r\nimport { IFCParser, ParserAPI, ParserProgress } from './IFCParser';\r\nimport { SubsetManager } from './SubsetManager';\r\nimport { PropertyManager } from './properties/PropertyManager';\r\nimport { IfcElements } from './IFCElementsMap';\r\nimport { TypeManager } from './TypeManager';\r\nimport { HighlightConfigOfModel, IfcState, JSONObject } from '../BaseDefinitions';\r\nimport {BufferGeometry, Material, Matrix4, Object3D, Scene} from 'three';\r\nimport { IFCModel } from './IFCModel';\r\nimport { BvhManager } from './BvhManager';\r\nimport { ItemsHider } from './ItemsHider';\r\nimport { LoaderSettings } from 'web-ifc';\r\nimport { MemoryCleaner } from './MemoryCleaner';\r\nimport { IFCWorkerHandler } from '../web-workers/IFCWorkerHandler';\r\nimport { PropertyManagerAPI } from './properties/BaseDefinitions';\r\n\r\n/**\r\n * Contains all the logic to work with the loaded IFC files (select, edit, etc).\r\n */\r\nexport class IFCManager {\r\n    private state: IfcState = {\r\n        models: [],\r\n        api: new WebIFC.IfcAPI(),\r\n        useJSON: false,\r\n        worker: { active: false, path: '' }\r\n    };\r\n\r\n    private BVH = new BvhManager();\r\n    parser: ParserAPI = new IFCParser(this.state, this.BVH);\r\n    private subsets = new SubsetManager(this.state, this.BVH);\r\n    private properties: PropertyManagerAPI = new PropertyManager(this.state);\r\n    private types = new TypeManager(this.state);\r\n    private hider = new ItemsHider(this.state);\r\n    private cleaner = new MemoryCleaner(this.state);\r\n    private worker?: IFCWorkerHandler;\r\n\r\n    /**\r\n     * Returns the underlying web-ifc API.\r\n     */\r\n    get ifcAPI() {\r\n        return this.state.api;\r\n    }\r\n\r\n    // SETUP - all the logic regarding the configuration of web-ifc-three\r\n\r\n    async parse(buffer: ArrayBuffer) {\r\n        const model = await this.parser.parse(buffer, this.state.coordinationMatrix?.toArray()) as IFCModel;\r\n        model.setIFCManager(this);\r\n        this.state.useJSON ? await this.disposeMemory() : await this.types.getAllTypes(this.worker);\r\n        this.hider.processCoordinates(model.modelID);\r\n        return model;\r\n    }\r\n\r\n    /**\r\n     * Sets the relative path of web-ifc.wasm file in the project.\r\n     * Beware: you **must** serve this file in your page; this means\r\n     * that you have to copy this files from *node_modules/web-ifc*\r\n     * to your deployment directory.\r\n     *\r\n     * If you don't use this methods,\r\n     * IFC.js assumes that you are serving it in the root directory.\r\n     *\r\n     * Example if web-ifc.wasm is in dist/wasmDir:\r\n     * `ifcLoader.setWasmPath(\"dist/wasmDir/\");`\r\n     *\r\n     * @path Relative path to web-ifc.wasm.\r\n     */\r\n    async setWasmPath(path: string) {\r\n        this.state.api.SetWasmPath(path);\r\n    }\r\n\r\n    /**\r\n     * Makes object picking a lot faster\r\n     * Courtesy of gkjohnson's [work](https://github.com/gkjohnson/three-mesh-bvh).\r\n     * Import these objects from his library and pass them as arguments. IFC.js takes care of the rest!\r\n     */\r\n    setupThreeMeshBVH(computeBoundsTree: any, disposeBoundsTree: any, acceleratedRaycast: any) {\r\n        this.BVH.initializeMeshBVH(computeBoundsTree, disposeBoundsTree, acceleratedRaycast);\r\n    }\r\n\r\n    /**\r\n     * Sets a callback function that is called every 10% of IFC loaded.\r\n     * @onProgress callback function\r\n     */\r\n    setOnProgress(onProgress: (event: ParserProgress) => void) {\r\n        this.state.onProgress = onProgress;\r\n    }\r\n\r\n\r\n    /**\r\n     * Sets a coordination matrix to be applied when loading geometry.\r\n     * @matrix THREE.Matrix4\r\n     */\r\n    setupCoordinationMatrix(matrix: Matrix4){\r\n        this.state.coordinationMatrix = matrix;\r\n    }\r\n\r\n    /**\r\n     * Clears the coordination matrix that is applied when loading geometry.\r\n     */\r\n    clearCoordinationMatrix(){\r\n        delete this.state.coordinationMatrix;\r\n    }\r\n\r\n    /**\r\n     * Applies a configuration for [web-ifc](https://ifcjs.github.io/info/docs/Guide/web-ifc/Introduction).\r\n     */\r\n    async applyWebIfcConfig(settings: LoaderSettings) {\r\n        this.state.webIfcSettings = settings;\r\n        if (this.state.worker.active && this.worker) {\r\n            await this.worker.workerState.updateStateWebIfcSettings();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Uses web workers, making the loader non-blocking.\r\n     * @active Wether to use web workers or not.\r\n     * @path Relative path to the web worker file. Necessary if active=true.\r\n     */\r\n    async useWebWorkers(active: boolean, path?: string) {\r\n        if (this.state.worker.active === active) return;\r\n        // @ts-ignore\r\n        this.state.api = null;\r\n        if (active) {\r\n            if (!path) throw new Error('You must provide a path to the web worker.');\r\n            this.state.worker.active = active;\r\n            this.state.worker.path = path;\r\n            await this.initializeWorkers();\r\n        } else {\r\n            this.state.api = new WebIFC.IfcAPI();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Enables the JSON mode (which consumes way less memory) and eliminates the WASM data.\r\n     * Only use this in the following scenarios:\r\n     * - If you don't need to access the properties of the IFC\r\n     * - If you will provide the properties as JSON.\r\n     * @useJSON: Wether to use the JSON mode or not.\r\n     */\r\n    async useJSONData(useJSON = true) {\r\n        this.state.useJSON = useJSON;\r\n        if (useJSON) {\r\n            await this.worker?.workerState.updateStateUseJson();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds the properties of a model as JSON data. If you are using web workers, use\r\n     * `loadJsonDataFromWorker()` instead to avoid overheads.\r\n     * @modelID ID of the IFC model.\r\n     * @data: data as an object where the keys are the expressIDs and the values the properties.\r\n     */\r\n    async addModelJSONData(modelID: number, data: { [id: number]: JSONObject }) {\r\n        const model = this.state.models[modelID];\r\n        if (!model) throw new Error('The specified model for the JSON data does not exist');\r\n        if (this.state.worker.active) {\r\n            await this.worker?.workerState.updateModelStateJsonData(modelID, data);\r\n        } else {\r\n            model.jsonData = data;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Loads the data of an IFC model from a JSON file directly from a web worker. If you are not using\r\n     * web workers, use `addModelJSONData()` instead.\r\n     * @modelID ID of the IFC model.\r\n     * @path: the path to the JSON file **relative to the web worker file**.\r\n     */\r\n    async loadJsonDataFromWorker(modelID: number, path: string) {\r\n        if (this.state.worker.active) {\r\n            await this.worker?.workerState.loadJsonDataFromWorker(modelID, path);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Closes the specified model and deletes it from the [scene](https://threejs.org/docs/#api/en/scenes/Scene).\r\n     * @modelID ID of the IFC model.\r\n     * @scene Scene where the model is (if it's located in a scene).\r\n     */\r\n    close(modelID: number, scene?: Scene) {\r\n        this.state.api.CloseModel(modelID);\r\n        if (scene) scene.remove(this.state.models[modelID].mesh);\r\n        delete this.state.models[modelID];\r\n    }\r\n\r\n    /**\r\n     * Gets the **Express ID** to which the given face belongs.\r\n     * This ID uniquely identifies this entity within this IFC file.\r\n     * @geometry The geometry of the IFC model.\r\n     * @faceIndex The index of the face of a geometry.You can easily get this index using the [Raycaster](https://threejs.org/docs/#api/en/core/Raycaster).\r\n     */\r\n    getExpressId(geometry: BufferGeometry, faceIndex: number) {\r\n        return this.properties.getExpressId(geometry, faceIndex);\r\n    }\r\n\r\n    /**\r\n     * Returns all items of the specified type. You can import\r\n     * the types from *web-ifc*.\r\n     *\r\n     * Example to get all the standard walls of a project:\r\n     * ```js\r\n     * import { IFCWALLSTANDARDCASE } from 'web-ifc';\r\n     * const walls = ifcLoader.getAllItemsOfType(IFCWALLSTANDARDCASE);\r\n     * ```\r\n     * @modelID ID of the IFC model.\r\n     * @type type of IFC items to get.\r\n     * @verbose If false (default), this only gets IDs. If true, this also gets the native properties of all the fetched items.\r\n     */\r\n    getAllItemsOfType(modelID: number, type: number, verbose: boolean) {\r\n        return this.properties.getAllItemsOfType(modelID, type, verbose);\r\n    }\r\n\r\n    /**\r\n     * Gets the native properties of the given element.\r\n     * @modelID ID of the IFC model.\r\n     * @id Express ID of the element.\r\n     * @recursive Wether you want to get the information of the referenced elements recursively.\r\n     */\r\n    getItemProperties(modelID: number, id: number, recursive = false) {\r\n        return this.properties.getItemProperties(modelID, id, recursive);\r\n    }\r\n\r\n    /**\r\n     * Gets the [property sets](https://standards.buildingsmart.org/IFC/DEV/IFC4_2/FINAL/HTML/schema/ifckernel/lexical/ifcpropertyset.htm)\r\n     * assigned to the given element.\r\n     * @modelID ID of the IFC model.\r\n     * @id Express ID of the element.\r\n     * @recursive If true, this gets the native properties of the referenced elements recursively.\r\n     */\r\n    getPropertySets(modelID: number, id: number, recursive = false) {\r\n        return this.properties.getPropertySets(modelID, id, recursive);\r\n    }\r\n\r\n    /**\r\n     * Gets the properties of the type assigned to the element.\r\n     * For example, if applied to a wall (IfcWall), this would get back the information\r\n     * contained in the IfcWallType assigned to it, if any.\r\n     * @modelID ID of the IFC model.\r\n     * @id Express ID of the element.\r\n     * @recursive If true, this gets the native properties of the referenced elements recursively.\r\n     */\r\n    getTypeProperties(modelID: number, id: number, recursive = false) {\r\n        return this.properties.getTypeProperties(modelID, id, recursive);\r\n    }\r\n\r\n    /**\r\n     * Gets the materials assigned to the given element.\r\n     * @modelID ID of the IFC model.\r\n     * @id Express ID of the element.\r\n     * @recursive If true, this gets the native properties of the referenced elements recursively.\r\n     */\r\n    getMaterialsProperties(modelID: number, id: number, recursive = false) {\r\n        return this.properties.getMaterialsProperties(modelID, id, recursive);\r\n    }\r\n\r\n    /**\r\n     * Gets the ifc type of the specified item.\r\n     * @modelID ID of the IFC model.\r\n     * @id Express ID of the element.\r\n     */\r\n    getIfcType(modelID: number, id: number) {\r\n        const typeID = this.state.models[modelID].types[id];\r\n        return IfcElements[typeID];\r\n    }\r\n\r\n    /**\r\n     * Gets the spatial structure of the project. The\r\n     * [spatial structure](https://standards.buildingsmart.org/IFC/DEV/IFC4_2/FINAL/HTML/schema/ifcproductextension/lexical/ifcspatialstructureelement.htm)\r\n     * is the hierarchical structure that organizes every IFC project (all physical items\r\n     * are referenced to an element of the spatial structure). It is formed by\r\n     * one IfcProject that contains one or more IfcSites, that contain one or more\r\n     * IfcBuildings, that contain one or more IfcBuildingStoreys, that contain\r\n     * one or more IfcSpaces.\r\n     * @modelID ID of the IFC model.\r\n     */\r\n    getSpatialStructure(modelID: number, includeProperties?: boolean) {\r\n        return this.properties.getSpatialStructure(modelID, includeProperties);\r\n    }\r\n\r\n    /**\r\n     * Gets the mesh of the subset with the specified [material](https://threejs.org/docs/#api/en/materials/Material).\r\n     * If no material is given, this returns the subset with the original materials.\r\n     * @modelID ID of the IFC model.\r\n     * @material Material assigned to the subset (if any).\r\n     * @customId Optional identifier of the subset.\r\n     */\r\n    getSubset(modelID: number, material?: Material, customId?: string) {\r\n        return this.subsets.getSubset(modelID, material, customId);\r\n    }\r\n\r\n    /**\r\n     * Removes the specified subset.\r\n     * @modelID ID of the IFC model.\r\n     * @parent The parent where the subset is (can be any `THREE.Object3D`).\r\n     * @material Material assigned to the subset, if any.\r\n     */\r\n    removeSubset(modelID: number, parent?: Object3D, material?: Material, customId?: string) {\r\n        this.subsets.removeSubset(modelID, parent, material, customId);\r\n    }\r\n\r\n    /**\r\n     * Creates a new geometric subset.\r\n     * @config A configuration object with the following options:\r\n     * - **scene**: `THREE.Object3D` where the model is located.\r\n     * - **modelID**: ID of the model.\r\n     * - **ids**: Express IDs of the items of the model that will conform the subset.\r\n     * - **removePrevious**: wether to remove the previous subset of this model with this material.\r\n     * - **material**: (optional) wether to apply a material to the subset\r\n     */\r\n    createSubset(config: HighlightConfigOfModel) {\r\n        return this.subsets.createSubset(config);\r\n    }\r\n\r\n    /**\r\n     * Hides the selected items in the specified model\r\n     * @modelID ID of the IFC model.\r\n     * @ids Express ID of the elements.\r\n     */\r\n    hideItems(modelID: number, ids: number[]) {\r\n        this.hider.hideItems(modelID, ids);\r\n    }\r\n\r\n    /**\r\n     * Hides all the items of the specified model\r\n     * @modelID ID of the IFC model.\r\n     */\r\n    hideAllItems(modelID: number) {\r\n        this.hider.hideAllItems(modelID);\r\n    }\r\n\r\n    /**\r\n     * Shows all the items of the specified model\r\n     * @modelID ID of the IFC model.\r\n     * @ids Express ID of the elements.\r\n     */\r\n    showItems(modelID: number, ids: number[]) {\r\n        this.hider.showItems(modelID, ids);\r\n    }\r\n\r\n    /**\r\n     * Shows all the items of the specified model\r\n     * @modelID ID of the IFC model.\r\n     */\r\n    showAllItems(modelID: number) {\r\n        this.hider.showAllItems(modelID);\r\n    }\r\n\r\n    // MISC - Miscelaneus logic for various purposes\r\n\r\n    /**\r\n     * Deletes all data, releasing all memory\r\n     * Work in progress: this doesn't remove all the memory\r\n     * Page reloading recommended to avoid heap overload\r\n     */\r\n    releaseAllMemory() {\r\n        this.subsets.dispose();\r\n        this.hider.dispose();\r\n        this.cleaner.releaseAllModels();\r\n        // @ts-ignore\r\n        this.state.api = null;\r\n        // @ts-ignore\r\n        this.state.models = null;\r\n        // @ts-ignore\r\n        this.state = null;\r\n    }\r\n\r\n    /**\r\n     * Completely releases the WASM memory, thus drastically decreasing the memory use of the app.\r\n     * Only use this in the following scenarios:\r\n     * - If you don't need to access the properties of the IFC\r\n     * - If you will provide the properties as JSON.\r\n     */\r\n    async disposeMemory() {\r\n        if (this.state.worker.active) {\r\n            await this.worker?.Close();\r\n        } else {\r\n            // @ts-ignore\r\n            this.state.api = null;\r\n            this.state.api = new WebIFC.IfcAPI();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * For internal use of IFC.js dev team and testers\r\n     */\r\n    getAndClearErrors(modelID: number) {\r\n        return this.parser.getAndClearErrors(modelID);\r\n    }\r\n\r\n    private async initializeWorkers() {\r\n        this.worker = new IFCWorkerHandler(this.state, this.BVH);\r\n        this.state.api = this.worker.webIfc;\r\n        this.properties = this.worker.properties;\r\n        this.parser = this.worker.parser;\r\n        await this.worker.workerState.updateStateUseJson();\r\n        await this.worker.workerState.updateStateWebIfcSettings();\r\n    }\r\n}\r\n","import { IFCManager } from './IFC/components/IFCManager';\r\nimport {FileLoader, Loader, LoadingManager, Matrix4} from 'three';\r\nimport { IFCModel } from './IFC/components/IFCModel';\r\n\r\nclass IFCLoader extends Loader {\r\n    ifcManager: IFCManager;\r\n    private onProgress?: (event: ProgressEvent) => void;\r\n\r\n    constructor(manager?: LoadingManager) {\r\n        super(manager);\r\n        this.ifcManager = new IFCManager();\r\n    }\r\n\r\n    load(\r\n        url: any,\r\n        onLoad: (ifc: IFCModel) => void,\r\n        onProgress?: (event: ProgressEvent) => void,\r\n        onError?: (event: ErrorEvent) => void\r\n    ) {\r\n        const scope = this;\r\n\r\n        const loader = new FileLoader(scope.manager);\r\n        this.onProgress = onProgress;\r\n        loader.setPath(scope.path);\r\n        loader.setResponseType('arraybuffer');\r\n        loader.setRequestHeader(scope.requestHeader);\r\n        loader.setWithCredentials(scope.withCredentials);\r\n        loader.load(\r\n            url,\r\n            async function (buffer) {\r\n                try {\r\n                    if (typeof buffer == 'string') {\r\n                        throw new Error('IFC files must be given as a buffer!');\r\n                    }\r\n                    onLoad(await scope.parse(buffer));\r\n                } catch (e: any) {\r\n                    if (onError) {\r\n                        onError(e);\r\n                    } else {\r\n                        console.error(e);\r\n                    }\r\n\r\n                    scope.manager.itemError(url);\r\n                }\r\n            },\r\n            onProgress,\r\n            onError\r\n        );\r\n    }\r\n\r\n    parse(buffer: ArrayBuffer) {\r\n        return this.ifcManager.parse(buffer);\r\n    }\r\n}\r\n\r\nexport { IFCLoader };\r\n"]},"metadata":{},"sourceType":"module"}