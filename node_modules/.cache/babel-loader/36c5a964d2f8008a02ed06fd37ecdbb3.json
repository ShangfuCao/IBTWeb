{"ast":null,"code":"import _objectSpread from\"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfu\\u2019s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";var _excluded=[\"onOpenViewpoint\"];import{useDropzone}from'react-dropzone';import{useCallback,useEffect,useState}from'react';import{BcfReader}from'@parametricos/bcf-js';import{makeStyles}from'@material-ui/core/styles';import Card from'@material-ui/core/Card';import CardActionArea from'@material-ui/core/CardActionArea';import CardContent from'@material-ui/core/CardContent';import CardMedia from'@material-ui/core/CardMedia';import Button from'@material-ui/core/Button';import{Box,Dialog,DialogActions,DialogContent,DialogTitle,Grid,Typography}from'@material-ui/core';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles({root:{maxWidth:345},media:{height:140}});export default function BcfDialog(props){var onOpenViewpoint=props.onOpenViewpoint,rest=_objectWithoutProperties(props,_excluded);var _useState=useState(),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),topics=_useState4[0],setTopics=_useState4[1];var handleOpenViewpoint=function handleOpenViewpoint(viewpoint){onOpenViewpoint(viewpoint);props.onClose();};var onDrop=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(acceptedFiles){var reader;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:reader=new BcfReader();_context.next=3;return reader.read(acceptedFiles[0]);case 3:setTopics(reader.topics);setFile(acceptedFiles[0]);case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),[]);var _useDropzone=useDropzone({onDrop:onDrop,accept:\".bcf\"}),getRootProps=_useDropzone.getRootProps,getInputProps=_useDropzone.getInputProps,isDragActive=_useDropzone.isDragActive;var fitleredTopics=topics.filter(function(t){return t.viewpoints.length>0;});return/*#__PURE__*/_jsxs(Dialog,_objectSpread(_objectSpread({maxWidth:\"xl\",fullWidth:true,disableBackdropClick:true},rest),{},{children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"BCF Viewer\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[!file&&/*#__PURE__*/_jsxs(Box,_objectSpread(_objectSpread({height:600,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",border:isDragActive?\"solid 4px\":\"none\",borderColor:isDragActive?\"#ffa50f\":\"\",borderRadius:20},getRootProps()),{},{children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({},getInputProps())),isDragActive?/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Drop the BCF here ...\"}):/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Drag 'n' drop a BCF here, or click to select\"})]})),file&&/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:fitleredTopics.map(function(topic,i){return/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(TopicCard,{topic:topic,onOpenViewpoint:handleOpenViewpoint})},i);})})]}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:props.onClose,children:\"Close\"})})]}));}function TopicCard(props){var _topic$markup,_topic$markup$viewpoi;var classes=useStyles();var topic=props.topic,onOpenViewpoint=props.onOpenViewpoint;var defaultViewpoint=(topic===null||topic===void 0?void 0:(_topic$markup=topic.markup)===null||_topic$markup===void 0?void 0:(_topic$markup$viewpoi=_topic$markup.viewpoints)===null||_topic$markup$viewpoi===void 0?void 0:_topic$markup$viewpoi.length)>0?topic.markup.viewpoints[0]:null;var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),defaultViewpointUrl=_useState6[0],setDefaultViewpointUrl=_useState6[1];var handleClick=function handleClick(){if(topic.viewpoints.length>0){onOpenViewpoint(topic.viewpoints[0]);}};useEffect(function(){var getViewpoint=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var data,url;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!defaultViewpoint){_context2.next=6;break;}_context2.next=3;return topic.getViewpointSnapshot(defaultViewpoint);case 3:data=_context2.sent;url=window.URL.createObjectURL(data);setDefaultViewpointUrl(url);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function getViewpoint(){return _ref2.apply(this,arguments);};}();getViewpoint();},[defaultViewpoint,topic]);return/*#__PURE__*/_jsx(Card,{className:classes.root,children:/*#__PURE__*/_jsxs(CardActionArea,{onClick:handleClick,children:[/*#__PURE__*/_jsx(CardMedia,{className:classes.media,image:defaultViewpointUrl,title:topic.markup.topic.title}),/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{gutterBottom:true,variant:\"h5\",component:\"h2\",children:topic.markup.topic.title}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",component:\"p\",children:topic.markup.topic.description})]})]})});}","map":{"version":3,"sources":["/Users/shangfualexcao/Dropbox (Personal)/My Mac (Shangfuâ€™s MacBook Pro)/Documents/GitHub/IBT-Web/frontend/src/components/BcfDialog.js"],"names":["useDropzone","useCallback","useEffect","useState","BcfReader","makeStyles","Card","CardActionArea","CardContent","CardMedia","Button","Box","Dialog","DialogActions","DialogContent","DialogTitle","Grid","Typography","useStyles","root","maxWidth","media","height","BcfDialog","props","onOpenViewpoint","rest","file","setFile","topics","setTopics","handleOpenViewpoint","viewpoint","onClose","onDrop","acceptedFiles","reader","read","accept","getRootProps","getInputProps","isDragActive","fitleredTopics","filter","t","viewpoints","length","map","topic","i","TopicCard","classes","defaultViewpoint","markup","defaultViewpointUrl","setDefaultViewpointUrl","handleClick","getViewpoint","getViewpointSnapshot","data","url","window","URL","createObjectURL","title","description"],"mappings":"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","sourcesContent":["import { useDropzone } from 'react-dropzone';\nimport { useCallback, useEffect, useState } from 'react';\nimport { BcfReader } from '@parametricos/bcf-js';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport Button from '@material-ui/core/Button';\nimport { Box, Dialog, DialogActions, DialogContent, DialogTitle, Grid, Typography } from '@material-ui/core';\n\n\nconst useStyles = makeStyles({\n    root: {\n        maxWidth: 345,\n    },\n    media: {\n        height: 140,\n    },\n});\n\n\n\n\nexport default function BcfDialog(props) {\n\n    const { onOpenViewpoint, ...rest } = props;\n\n    const [file, setFile] = useState();\n    const [topics, setTopics] = useState([]);\n\n    const handleOpenViewpoint = (viewpoint) => {\n        onOpenViewpoint(viewpoint);\n        props.onClose()\n    }\n\n    const onDrop = useCallback(async (acceptedFiles) => {\n        const reader = new BcfReader();\n        await reader.read(acceptedFiles[0]);\n        setTopics(reader.topics);\n        setFile(acceptedFiles[0])\n    }, []);\n\n    const { getRootProps, getInputProps, isDragActive } = useDropzone({ onDrop, accept: \".bcf\" });\n\n    const fitleredTopics = topics.filter((t) => t.viewpoints.length > 0);\n\n    return (\n      <Dialog maxWidth='xl' fullWidth disableBackdropClick {...rest}>\n          <DialogTitle>BCF Viewer</DialogTitle>\n          <DialogContent>\n              {!file && (\n                <Box\n                  height={600}\n                  display='flex'\n                  alignItems=\"center\"\n                  justifyContent=\"center\"\n                  border={isDragActive ? \"solid 4px\" : \"none\" }\n                  borderColor={isDragActive ? \"#ffa50f\" : \"\" }\n                  borderRadius={20}\n                  {...getRootProps()}\n                >\n                    <input {...getInputProps()} />\n                    {\n                        isDragActive ?\n                          <Typography variant=\"h6\">Drop the BCF here ...</Typography> :\n                          <Typography variant=\"h6\">Drag 'n' drop a BCF here, or click to select</Typography>\n                    }\n                </Box>\n              )}\n              {file && (\n                <Grid container spacing={2}>\n                    {fitleredTopics.map((topic, i) => (\n                      <Grid key={i} item>\n                            <TopicCard topic={topic} onOpenViewpoint={handleOpenViewpoint} />\n                      </Grid>\n                    ))}\n                </Grid>\n              )}\n          </DialogContent>\n          <DialogActions>\n              <Button onClick={props.onClose}>\n                  Close\n              </Button>\n          </DialogActions>\n      </Dialog>\n    );\n}\n\nfunction TopicCard(props){\n\n    const classes = useStyles();\n\n    const { topic, onOpenViewpoint } = props;\n\n    const defaultViewpoint = topic?.markup?.viewpoints?.length > 0 ? topic.markup.viewpoints[0] : null;\n\n    const [defaultViewpointUrl, setDefaultViewpointUrl] = useState(\"\");\n\n    const handleClick = () => {\n        if(topic.viewpoints.length > 0) {\n            onOpenViewpoint(topic.viewpoints[0]);\n        }\n    }\n\n    useEffect(() => {\n        const getViewpoint = async () => {\n            if(defaultViewpoint){\n                const data = await topic.getViewpointSnapshot(defaultViewpoint);\n                const url = window.URL.createObjectURL(data);\n                setDefaultViewpointUrl(url);\n            }\n        }\n        getViewpoint()\n    }, [defaultViewpoint, topic]);\n\n    return (\n      <Card className={classes.root}>\n          <CardActionArea onClick={handleClick}>\n              <CardMedia\n                className={classes.media}\n                image={defaultViewpointUrl}\n                title={topic.markup.topic.title}\n              />\n              <CardContent>\n                  <Typography gutterBottom variant=\"h5\" component=\"h2\">\n                      {topic.markup.topic.title}\n                  </Typography>\n                  <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\n                      {topic.markup.topic.description}\n                  </Typography>\n              </CardContent>\n          </CardActionArea>\n          {/*<CardActions>\n              <Button size=\"small\" color=\"primary\">\n                  Open\n              </Button>\n              <Button size=\"small\" color=\"primary\">\n                  Learn More\n              </Button>\n          </CardActions>*/}\n      </Card>\n    )\n}"]},"metadata":{},"sourceType":"module"}